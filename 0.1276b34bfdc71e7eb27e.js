/*! For license information please see 0.1276b34bfdc71e7eb27e.js.LICENSE.txt */
/*
╔═╗─────────────────╔╗     ╔╗─╔╦╗
║╬║╔═╗╔╦╦╗╔═╗╔╦╗╔═╗╔╝║     ║╚╗║║║
║╔╝║╬║║║║║║╩╣║╔╝║╩╣║╬║     ║╬║╠╗║
╚╝─╚═╝╚══╝╚═╝╚╝─╚═╝╚═╝     ╚═╝╚═╝

─────╔╗────────────────────╔╗     ╔╗────────────
╔═╗─╔╝║╔═╦═╗╔═╗─╔═╦╗╔═╗╔═╗╔╝║     ║╚╗╔═╗╔═╗─╔══╗
║╬╚╗║╬║╚╗║╔╝║╬╚╗║║║║║═╣║╩╣║╬║     ║╔╣║╩╣║╬╚╗║║║║
╚══╝╚═╝─╚═╝─╚══╝╚╩═╝╚═╝╚═╝╚═╝     ╚═╝╚═╝╚══╝╚╩╩╝

─────────╔╗     ────────────────╔╗─
╔═╗─╔═╦╗╔╝║     ╔═╦═╗╔═╗╔═╦═╗╔═╗║╚╗
║╬╚╗║║║║║╬║     ╚╗║╔╝║╩╣╚╗║╔╝║╩╣║╔╣
╚══╝╚╩═╝╚═╝     ─╚═╝─╚═╝─╚═╝─╚═╝╚═╝

Do not change this code!
*/
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(t,e,n){"use strict";n.r(e),n.d(e,"ProjectPreview",(function(){return tt}));var r=n(18),i=n(5),o=n.n(i),a=n(2),s=n(1),c=n(113);function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y(t);if(e){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}function v(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var m=n(27),g=n(149).default,_=n(150).default,b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(o,t);var e,n,r,i=d(o);function o(){return u(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"setParallax",value:function(t,e){this._parallax.target.x=t,this._parallax.target.y=e}},{key:"_extra",value:function(){p(y(o.prototype),"_extra",this).call(this),this._prop.extendFragmentShader="empty",this._prop.materialProp.transparent=!0,this._prop.materialProp.opacity=0,this._hoverPogress=0,this._isHovered=!1,this._parallax={target:{x:0,y:0},current:{x:0,y:0}},this._prop.uniformsData.push({key:"u_dpr",value:s.a.viewport.dpr,type:"float"}),this._prop.uniformsData.push({key:"u_hoverProgress",value:this._hoverPogress,type:"float"}),this._prop.uniformsData.push({key:"u_parallaxX",value:this._parallax.current.x,type:"float"}),this._prop.uniformsData.push({key:"u_parallaxY",value:this._parallax.current.x,type:"float"})}},{key:"_setMaterialOnBeforeCompile",value:function(){var t=this;this._material.onBeforeCompile=function(e){t._onMaterialBeforeCompileFragment(e)}}},{key:"_onMaterialBeforeCompileFragment",value:function(t){this.prop.extendFragmentShader&&(this._setShaderUniforms(t),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",g),t.fragmentShader=t.fragmentShader.replace("#include <map_fragment>",_))}},{key:"hide",value:function(t){this.loaded&&p(y(o.prototype),"hide",this).call(this,t)}},{key:"show",value:function(t){this.loaded&&p(y(o.prototype),"show",this).call(this,t)}},{key:"resize",value:function(){p(y(o.prototype),"resize",this).call(this),this._material.userData.u_dpr.value=s.a.viewport.dpr}},{key:"render",value:function(){p(y(o.prototype),"render",this).call(this);var t=0;this._isHovered&&(t=1),this._hoverPogress=m(this._hoverPogress,t,.05),this._material.userData.u_hoverProgress.value=this._hoverPogress;var e=this._parallax.target,n=this._parallax.current;n.x=m(n.x,e.x,.05),n.y=m(n.y,e.y,.05),this._material.userData.u_parallaxX.value=n.x,this._material.userData.u_parallaxY.value=n.y}},{key:"isHovered",get:function(){return this._isHovered},set:function(t){this._isHovered=t}}])&&h(e.prototype,n),r&&h(e,r),o}(c.a),w=n(151),x=n.n(w),S=n(106);function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t,e,n){return(P="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function T(t,e){return(T=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function E(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=A(t);if(e){var i=A(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C(this,n)}}function C(t,e){return!e||"object"!==k(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var M=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":k(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&T(t,e)}(o,t);var e,n,r,i=E(o);function o(){return R(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"_connectedCallback",value:function(){if(P(A(o.prototype),"_connectedCallback",this).call(this),0!==this.children.length){var t=this.children[0],e=this.getAttribute("rotate"),n=90;e&&(n=parseInt(e,10)),this._rotate=x()({selector:t,rotate:n})}}},{key:"_disconnectedCallback",value:function(){this._rotate&&(this._rotate.destroy(),this._rotate=!1),P(A(o.prototype),"_disconnectedCallback",this).call(this)}}])&&O(e.prototype,n),r&&O(e,r),o}(S.a);j=M([Object(r.b)("rotate-html")],j);var L=n(3),B=n(109),z=["v-view","v-viewed","v-view_b","v-view_a"];var F=n(4),I=n(21),D=n(24),q=n(110),N=n(8),V=n(20);function W(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function H(t,e,n){return(H="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=K(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function G(t,e){return(G=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=K(t);if(e){var i=K(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Y(this,n)}}function Y(t,e){return!e||"object"!==Q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function K(t){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Z=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Q(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},J=n(27),$="project-preview",tt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&G(t,e)}(c,t);var e,n,r,i=X(c);function c(){var t;return W(this,c),(t=i.apply(this,arguments))._destroyed=!1,t._scrollEvents=!1,t._listeners=[],t._classNameObservers=[],t}return e=c,(n=[{key:"_connectedCallback",value:function(){H(K(c.prototype),"_connectedCallback",this).call(this),this._destroyed=!1,this.classList.add($),this._hoverElements=Object(a.f)("*[data-hover]",this),this._imageOuter=Object(a.g)("*[data-image]",this),this._imageOuter&&!s.a.viewport.mobiledevice&&I.a&&(this.classList.add("has-gl"),this._initGl()),Object(B.a)(this)}},{key:"_disconnectedCallback",value:function(){H(K(c.prototype),"_disconnectedCallback",this).call(this),this._destroyed=!0,this._plane&&(this._plane.destroy(),this._plane=!1),this._listeners.forEach((function(t){t.remove()})),this._listeners=[],this._scrollEvents&&this._scrollEvents.destroy(),this._classNameObservers.forEach((function(t){t.disconnect()})),this._classNameObservers=[]}},{key:"_initGl",value:function(){var t=this;if(this.useLazyLoad){var e=Object(a.g)("img",this);e&&(e.classList.contains("loaded")?this._handleLoaded(e):e.addEventListener("load",(function(){t._handleLoaded(e)})))}else this._loadImage()}},{key:"_loadImage",value:function(){var t=this;Object(D.a)(this.imageSrc,(function(e){t._handleLoaded(e)}))}},{key:"_handleLoaded",value:function(t){var e=this;if(!this._destroyed){var n=function(t){for(var e=0,n=z.length;e<n;e++)if(t.classList.contains(z[e]))return!0;return!1}(this);this._plane=new b({el:this._imageOuter,resource:t,scene:F.a.scene2d,uniformsData:[{key:"u_strength",value:0,type:"float"}],materialProp:{transparent:!!n,opacity:n?0:1},posRule:"cover"}),n&&(this.classList.contains("v-viewed")?this._plane.show(L.g):this["v-view-callback"]=function(){e._plane&&e._plane.show(L.g)}),this._imageOuter.addEventListener("mousemove",this._handleMousemove.bind(this)),this._hoverElements.forEach((function(t){t.addEventListener("mouseenter",e._enableHover.bind(e)),t.addEventListener("mouseleave",e._disableHover.bind(e))})),this._setScrollEvents(),this._setObserverEvents()}}},{key:"_enableHover",value:function(){this._plane&&(this._plane.isHovered=!0)}},{key:"_disableHover",value:function(){this._plane&&(this._plane.isHovered=!1)}},{key:"_handleMousemove",value:function(t){if(this._plane){var e=this._imageOuter.getBoundingClientRect(),n=t.clientX-e.left,r=t.clientY-e.top,i=o()(o()(n,[0,e.width]),[.5,1]),a=o()(o()(r,[0,e.height]),[.5,1]);this._plane.setParallax(i,a)}}},{key:"_setScrollEvents",value:function(){var t=this;I.a&&(this._scrollEvents=Object(q.a)((function(){if(t._plane){var e=Object(N.d)();if(Object(V.a)(e)){var n=(e.targetTop-e.scrollTop)/250;n>1?n=1:n<-1&&(n=-1);var r=t._plane.material.userData;r.u_strength.value=J(r.u_strength.value,n,e.prop.ease)}}})))}},{key:"_setObserverEvents",value:function(){var t=this,e=new MutationObserver((function(e){e.forEach((function(e){var n=e.target;n instanceof HTMLElement&&n.classList.contains("hide")&&t._plane&&t._plane.hide(L.g)}))}));this._classNameObservers.push(e);for(var n=this.parentElement,r=0;r<10;r++)n&&(e.observe(n,{attributes:!0}),n=n.parentElement)}}])&&U(e.prototype,n),r&&U(e,r),c}(S.a);Z([Object(r.d)({attribute:"image-src"})],tt.prototype,"imageSrc",void 0),Z([Object(r.d)({attribute:"use-lazy-load"})],tt.prototype,"useLazyLoad",void 0),tt=Z([Object(r.b)($)],tt)},106:function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var r=n(18),i=n(1);function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._callback=e,this._proceeded=!1,this._timeout=!1,this._trace()}var e,n,r;return e=t,(n=[{key:"_trace",value:function(){var t=this;if(!this._proceeded){var e=i.a.vevetPage;e&&e.pageCreated?(this._proceeded=!0,this._callback()):this._timeout=setTimeout((function(){t._trace()}),50)}}},{key:"destroy",value:function(){this._timeout&&clearTimeout(this._timeout)}}])&&o(e.prototype,n),r&&o(e,r),t}();function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d(t);if(e){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(o,t);var e,n,r,i=p(o);function o(){var t;return c(this,o),(t=i.apply(this,arguments))._onPageCreated=!1,t}return e=o,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"connectedCallback",value:function(){var t=this;u(d(o.prototype),"connectedCallback",this).call(this),this._onPageCreated=new a((function(){t._connectedCallback()}))}},{key:"disconnectedCallback",value:function(){u(d(o.prototype),"disconnectedCallback",this).call(this),this._onPageCreated&&(this._onPageCreated.destroy(),this._onPageCreated=!1),this._disconnectedCallback()}},{key:"_connectedCallback",value:function(){}},{key:"_disconnectedCallback",value:function(){}}])&&l(e.prototype,n),r&&l(e,r),o}(r.a)},108:function(t,e,n){"use strict";function r(t){t.setAttribute("translate","no")}n.d(e,"a",(function(){return r}))},109:function(t,e,n){"use strict";function r(t){t.classList.add("composed")}n.d(e,"a",(function(){return r}))},110:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(2),i=n(1),o=n(26),a=n(20),s=n(8),c=n(21);function l(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=i.a.vevetPage,l=[],u=Object(r.g)("#custom-scroll");Object(r.c)(u)&&l.push(Object(r.a)(u,"scroll",(function(){Object(s.a)()||c.b||t(u.scrollTop)})));var h=o.a.get(),p=!1;if(Object(a.a)(h)){var f=h;p=f.on("update",(function(){Object(s.a)()&&t(f.scrollTop)}))}function d(){l.forEach((function(t){t.remove()})),p&&h&&h.remove(p)}return l.push(Object(r.a)(window,"scroll",(function(){!Object(s.a)()&&c.b&&t(window.pageYOffset)}),{passive:!1})),n&&!e&&n.on("destroy",(function(){d()}),{once:!0}),{destroy:d.bind(this)}}},111:function(t){t.exports=function t(e,n,r){function i(a){if(!n[a]){if(!e[a]){if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var s=n[a]={exports:{}};e[a][0].call(s.exports,(function(t){var n=e[a][1][t];return i(n||t)}),s,s.exports,t,e,n,r)}return n[a].exports}for(var o=!1,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e){e.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(t,e){e.exports={version:t("../package.json").version,AABB:t("./collision/AABB"),ArrayCollisionMatrix:t("./collision/ArrayCollisionMatrix"),Body:t("./objects/Body"),Box:t("./shapes/Box"),Broadphase:t("./collision/Broadphase"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),Narrowphase:t("./world/Narrowphase"),ConeTwistConstraint:t("./constraints/ConeTwistConstraint"),ContactMaterial:t("./material/ContactMaterial"),ConvexPolyhedron:t("./shapes/ConvexPolyhedron"),Cylinder:t("./shapes/Cylinder"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventTarget:t("./utils/EventTarget"),FrictionEquation:t("./equations/FrictionEquation"),GSSolver:t("./solver/GSSolver"),GridBroadphase:t("./collision/GridBroadphase"),Heightfield:t("./shapes/Heightfield"),HingeConstraint:t("./constraints/HingeConstraint"),LockConstraint:t("./constraints/LockConstraint"),Mat3:t("./math/Mat3"),Material:t("./material/Material"),NaiveBroadphase:t("./collision/NaiveBroadphase"),ObjectCollisionMatrix:t("./collision/ObjectCollisionMatrix"),Pool:t("./utils/Pool"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),PointToPointConstraint:t("./constraints/PointToPointConstraint"),Quaternion:t("./math/Quaternion"),Ray:t("./collision/Ray"),RaycastVehicle:t("./objects/RaycastVehicle"),RaycastResult:t("./collision/RaycastResult"),RigidVehicle:t("./objects/RigidVehicle"),RotationalEquation:t("./equations/RotationalEquation"),RotationalMotorEquation:t("./equations/RotationalMotorEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),SPHSystem:t("./objects/SPHSystem"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Sphere:t("./shapes/Sphere"),SplitSolver:t("./solver/SplitSolver"),Spring:t("./objects/Spring"),Trimesh:t("./shapes/Trimesh"),Vec3:t("./math/Vec3"),Vec3Pool:t("./utils/Vec3Pool"),World:t("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(t,e){var n=t("../math/Vec3");function r(t){t=t||{},this.lowerBound=new n,t.lowerBound&&this.lowerBound.copy(t.lowerBound),this.upperBound=new n,t.upperBound&&this.upperBound.copy(t.upperBound)}t("../utils/Utils"),e.exports=r;var i=new n;r.prototype.setFromPoints=function(t,e,n,r){var o=this.lowerBound,a=this.upperBound,s=n;o.copy(t[0]),s&&s.vmult(o,o),a.copy(o);for(var c=1;c<t.length;c++){var l=t[c];s&&(s.vmult(l,i),l=i),l.x>a.x&&(a.x=l.x),l.x<o.x&&(o.x=l.x),l.y>a.y&&(a.y=l.y),l.y<o.y&&(o.y=l.y),l.z>a.z&&(a.z=l.z),l.z<o.z&&(o.z=l.z)}return e&&(e.vadd(o,o),e.vadd(a,a)),r&&(o.x-=r,o.y-=r,o.z-=r,a.x+=r,a.y+=r,a.z+=r),this},r.prototype.copy=function(t){return this.lowerBound.copy(t.lowerBound),this.upperBound.copy(t.upperBound),this},r.prototype.clone=function(){return(new r).copy(this)},r.prototype.extend=function(t){var e=t.lowerBound.x;this.lowerBound.x>e&&(this.lowerBound.x=e);var n=t.upperBound.x;this.upperBound.x<n&&(this.upperBound.x=n),e=t.lowerBound.y,this.lowerBound.y>e&&(this.lowerBound.y=e),n=t.upperBound.y,this.upperBound.y<n&&(this.upperBound.y=n),e=t.lowerBound.z,this.lowerBound.z>e&&(this.lowerBound.z=e),n=t.upperBound.z,this.upperBound.z<n&&(this.upperBound.z=n)},r.prototype.overlaps=function(t){var e=this.lowerBound,n=this.upperBound,r=t.lowerBound,i=t.upperBound;return(r.x<=n.x&&n.x<=i.x||e.x<=i.x&&i.x<=n.x)&&(r.y<=n.y&&n.y<=i.y||e.y<=i.y&&i.y<=n.y)&&(r.z<=n.z&&n.z<=i.z||e.z<=i.z&&i.z<=n.z)},r.prototype.contains=function(t){var e=this.lowerBound,n=this.upperBound,r=t.lowerBound,i=t.upperBound;return e.x<=r.x&&n.x>=i.x&&e.y<=r.y&&n.y>=i.y&&e.z<=r.z&&n.z>=i.z},r.prototype.getCorners=function(t,e,n,r,i,o,a,s){var c=this.lowerBound,l=this.upperBound;t.copy(c),e.set(l.x,c.y,c.z),n.set(l.x,l.y,c.z),r.set(c.x,l.y,l.z),i.set(l.x,c.y,c.z),o.set(c.x,l.y,c.z),a.set(c.x,c.y,l.z),s.copy(l)};var o=[new n,new n,new n,new n,new n,new n,new n,new n];r.prototype.toLocalFrame=function(t,e){var n=o,r=n[0],i=n[1],a=n[2],s=n[3],c=n[4],l=n[5],u=n[6],h=n[7];this.getCorners(r,i,a,s,c,l,u,h);for(var p=0;8!==p;p++){var f=n[p];t.pointToLocal(f,f)}return e.setFromPoints(n)},r.prototype.toWorldFrame=function(t,e){var n=o,r=n[0],i=n[1],a=n[2],s=n[3],c=n[4],l=n[5],u=n[6],h=n[7];this.getCorners(r,i,a,s,c,l,u,h);for(var p=0;8!==p;p++){var f=n[p];t.pointToWorld(f,f)}return e.setFromPoints(n)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(t,e){function n(){this.matrix=[]}e.exports=n,n.prototype.get=function(t,e){if(t=t.index,(e=e.index)>t){var n=e;e=t,t=n}return this.matrix[(t*(t+1)>>1)+e-1]},n.prototype.set=function(t,e,n){if(t=t.index,(e=e.index)>t){var r=e;e=t,t=r}this.matrix[(t*(t+1)>>1)+e-1]=n?1:0},n.prototype.reset=function(){for(var t=0,e=this.matrix.length;t!==e;t++)this.matrix[t]=0},n.prototype.setNumObjects=function(t){this.matrix.length=t*(t-1)>>1}},{}],5:[function(t,e){var n=t("../objects/Body"),r=t("../math/Vec3"),i=t("../math/Quaternion");function o(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}t("../shapes/Shape"),t("../shapes/Plane"),e.exports=o,o.prototype.collisionPairs=function(){throw new Error("collisionPairs not implemented for this BroadPhase class!")};var a=n.STATIC|n.KINEMATIC;o.prototype.needBroadphaseCollision=function(t,e){return 0!=(t.collisionFilterGroup&e.collisionFilterMask)&&0!=(e.collisionFilterGroup&t.collisionFilterMask)&&(0==(t.type&a)&&t.sleepState!==n.SLEEPING||0==(e.type&a)&&e.sleepState!==n.SLEEPING)},o.prototype.intersectionTest=function(t,e,n,r){this.useBoundingBoxes?this.doBoundingBoxBroadphase(t,e,n,r):this.doBoundingSphereBroadphase(t,e,n,r)};var s=new r;new r,new i,new r,o.prototype.doBoundingSphereBroadphase=function(t,e,n,r){var i=s;e.position.vsub(t.position,i);var o=Math.pow(t.boundingRadius+e.boundingRadius,2);i.norm2()<o&&(n.push(t),r.push(e))},o.prototype.doBoundingBoxBroadphase=function(t,e,n,r){t.aabbNeedsUpdate&&t.computeAABB(),e.aabbNeedsUpdate&&e.computeAABB(),t.aabb.overlaps(e.aabb)&&(n.push(t),r.push(e))};var c={keys:[]},l=[],u=[];o.prototype.makePairsUnique=function(t,e){for(var n=c,r=l,i=u,o=t.length,a=0;a!==o;a++)r[a]=t[a],i[a]=e[a];for(t.length=0,e.length=0,a=0;a!==o;a++){var s=r[a].id,h=i[a].id;n[p=s<h?s+","+h:h+","+s]=a,n.keys.push(p)}for(a=0;a!==n.keys.length;a++){var p=n.keys.pop(),f=n[p];t.push(r[f]),e.push(i[f]),delete n[p]}},o.prototype.setWorld=function(){};var h=new r;o.boundingSphereCheck=function(t,e){var n=h;return t.position.vsub(e.position,n),Math.pow(t.shape.boundingSphereRadius+e.shape.boundingSphereRadius,2)>n.norm2()},o.prototype.aabbQuery=function(){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(t,e){e.exports=o;var n=t("./Broadphase"),r=t("../math/Vec3"),i=t("../shapes/Shape");function o(t,e,i,o,a){n.apply(this),this.nx=i||10,this.ny=o||10,this.nz=a||10,this.aabbMin=t||new r(100,100,100),this.aabbMax=e||new r(-100,-100,-100);var s=this.nx*this.ny*this.nz;if(s<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=s,this.binLengths.length=s;for(var c=0;c<s;c++)this.bins[c]=[],this.binLengths[c]=0}o.prototype=new n,o.prototype.constructor=o;var a=new r;new r,o.prototype.collisionPairs=function(t,e,n){for(var r=t.numObjects(),o=t.bodies,s=this.aabbMax,c=this.aabbMin,l=this.nx,u=this.ny,h=this.nz,p=u*h,f=h,d=1,v=s.x,y=s.y,m=s.z,g=c.x,_=c.y,b=c.z,w=l/(v-g),x=u/(y-_),S=h/(m-b),R=(v-g)/l,O=(y-_)/u,P=(m-b)/h,T=.5*Math.sqrt(R*R+O*O+P*P),E=i.types,C=E.SPHERE,A=E.PLANE,k=(E.BOX,E.COMPOUND,E.CONVEXPOLYHEDRON,this.bins),M=this.binLengths,j=this.bins.length,L=0;L!==j;L++)M[L]=0;var B=Math.ceil;function z(t,e,n,r,i,o,a){var s=(t-g)*w|0,c=(e-_)*x|0,v=(n-b)*S|0,y=B((r-g)*w),m=B((i-_)*x),R=B((o-b)*S);s<0?s=0:s>=l&&(s=l-1),c<0?c=0:c>=u&&(c=u-1),v<0?v=0:v>=h&&(v=h-1),y<0?y=0:y>=l&&(y=l-1),m<0?m=0:m>=u&&(m=u-1),R<0?R=0:R>=h&&(R=h-1),c*=f,v*=d,y*=p,m*=f,R*=d;for(var O=s*=p;O<=y;O+=p)for(var P=c;P<=m;P+=f)for(var T=v;T<=R;T+=d){var E=O+P+T;k[E][M[E]++]=a}}for(c=Math.min,s=Math.max,L=0;L!==r;L++){var F=(nt=o[L]).shape;switch(F.type){case C:var I=nt.position.x,D=nt.position.y,q=nt.position.z,N=F.radius;z(I-N,D-N,q-N,I+N,D+N,q+N,nt);break;case A:F.worldNormalNeedsUpdate&&F.computeWorldNormal(nt.quaternion);var V=F.worldNormal,W=g+.5*R-nt.position.x,U=_+.5*O-nt.position.y,H=b+.5*P-nt.position.z,G=a;G.set(W,U,H);for(var X=0,Y=0;X!==l;X++,Y+=p,G.y=U,G.x+=R)for(var K=0,Q=0;K!==u;K++,Q+=f,G.z=H,G.y+=O)for(var Z=0,J=0;Z!==h;Z++,J+=d,G.z+=P)if(G.dot(V)<T){var $=Y+Q+J;k[$][M[$]++]=nt}break;default:nt.aabbNeedsUpdate&&nt.computeAABB(),z(nt.aabb.lowerBound.x,nt.aabb.lowerBound.y,nt.aabb.lowerBound.z,nt.aabb.upperBound.x,nt.aabb.upperBound.y,nt.aabb.upperBound.z,nt)}}for(L=0;L!==j;L++){var tt=M[L];if(tt>1){var et=k[L];for(X=0;X!==tt;X++){var nt=et[X];for(K=0;K!==X;K++){var rt=et[K];this.needBroadphaseCollision(nt,rt)&&this.intersectionTest(nt,rt,e,n)}}}}this.makePairsUnique(e,n)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(t,e){e.exports=i;var n=t("./Broadphase"),r=t("./AABB");function i(){n.apply(this)}i.prototype=new n,i.prototype.constructor=i,i.prototype.collisionPairs=function(t,e,n){var r,i,o,a,s=t.bodies,c=s.length;for(r=0;r!==c;r++)for(i=0;i!==r;i++)o=s[r],a=s[i],this.needBroadphaseCollision(o,a)&&this.intersectionTest(o,a,e,n)},new r,i.prototype.aabbQuery=function(t,e,n){n=n||[];for(var r=0;r<t.bodies.length;r++){var i=t.bodies[r];i.aabbNeedsUpdate&&i.computeAABB(),i.aabb.overlaps(e)&&n.push(i)}return n}},{"./AABB":3,"./Broadphase":5}],8:[function(t,e){function n(){this.matrix={}}e.exports=n,n.prototype.get=function(t,e){if(t=t.id,(e=e.id)>t){var n=e;e=t,t=n}return t+"-"+e in this.matrix},n.prototype.set=function(t,e,n){if(t=t.id,(e=e.id)>t){var r=e;e=t,t=r}n?this.matrix[t+"-"+e]=!0:delete this.matrix[t+"-"+e]},n.prototype.reset=function(){this.matrix={}},n.prototype.setNumObjects=function(){}},{}],9:[function(t,e){e.exports=c;var n=t("../math/Vec3"),r=t("../math/Quaternion"),i=t("../math/Transform"),o=(t("../shapes/ConvexPolyhedron"),t("../shapes/Box"),t("../collision/RaycastResult")),a=t("../shapes/Shape"),s=t("../collision/AABB");function c(t,e){this.from=t?t.clone():new n,this.to=e?e.clone():new n,this._direction=new n,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=c.ANY,this.result=new o,this.hasHit=!1,this.callback=function(){}}c.prototype.constructor=c,c.CLOSEST=1,c.ANY=2,c.ALL=4;var l=new s,u=[];c.prototype.intersectWorld=function(t,e){return this.mode=e.mode||c.ANY,this.result=e.result||new o,this.skipBackfaces=!!e.skipBackfaces,this.collisionFilterMask=void 0!==e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==e.collisionFilterGroup?e.collisionFilterGroup:-1,e.from&&this.from.copy(e.from),e.to&&this.to.copy(e.to),this.callback=e.callback||function(){},this.hasHit=!1,this.result.reset(),this._updateDirection(),this.getAABB(l),u.length=0,t.broadphase.aabbQuery(t,l,u),this.intersectBodies(u),this.hasHit};var h=new n,p=new n;function f(t,e,n,r){r.vsub(e,j),n.vsub(e,h),t.vsub(e,p);var i,o,a=j.dot(j),s=j.dot(h),c=j.dot(p),l=h.dot(h),u=h.dot(p);return(i=l*c-s*u)>=0&&(o=a*u-s*c)>=0&&i+o<a*l-s*s}c.pointInTriangle=f;var d=new n,v=new r;c.prototype.intersectBody=function(t,e){e&&(this.result=e,this._updateDirection());var n=this.checkCollisionResponse;if((!n||t.collisionResponse)&&0!=(this.collisionFilterGroup&t.collisionFilterMask)&&0!=(t.collisionFilterGroup&this.collisionFilterMask))for(var r=d,i=v,o=0,a=t.shapes.length;o<a;o++){var s=t.shapes[o];if((!n||s.collisionResponse)&&(t.quaternion.mult(t.shapeOrientations[o],i),t.quaternion.vmult(t.shapeOffsets[o],r),r.vadd(t.position,r),this.intersectShape(s,i,r,t),this.result._shouldStop))break}},c.prototype.intersectBodies=function(t,e){e&&(this.result=e,this._updateDirection());for(var n=0,r=t.length;!this.result._shouldStop&&n<r;n++)this.intersectBody(t[n])},c.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction),this._direction.normalize()},c.prototype.intersectShape=function(t,e,n,r){if(!(B(this.from,this._direction,n)>t.boundingSphereRadius)){var i=this[t.type];i&&i.call(this,t,e,n,r)}},new n,new n;var y=new n,m=new n,g=new n,_=new n;new n,new o,c.prototype.intersectBox=function(t,e,n,r){return this.intersectConvex(t.convexPolyhedronRepresentation,e,n,r)},c.prototype[a.types.BOX]=c.prototype.intersectBox,c.prototype.intersectPlane=function(t,e,r,i){var o=this.from,a=this.to,s=this._direction,c=new n(0,0,1);e.vmult(c,c);var l=new n;o.vsub(r,l);var u=l.dot(c);if(a.vsub(r,l),!(u*l.dot(c)>0||o.distanceTo(a)<u)){var h=c.dot(s);if(!(Math.abs(h)<this.precision)){var p=new n,f=new n,d=new n;o.vsub(r,p);var v=-c.dot(p)/h;s.scale(v,f),o.vadd(f,d),this.reportIntersection(c,d,t,i,-1)}}},c.prototype[a.types.PLANE]=c.prototype.intersectPlane,c.prototype.getAABB=function(t){var e=this.to,n=this.from;t.lowerBound.x=Math.min(e.x,n.x),t.lowerBound.y=Math.min(e.y,n.y),t.lowerBound.z=Math.min(e.z,n.z),t.upperBound.x=Math.max(e.x,n.x),t.upperBound.y=Math.max(e.y,n.y),t.upperBound.z=Math.max(e.z,n.z)};var b={faceList:[0]};c.prototype.intersectHeightfield=function(t,e,r,o){t.data,t.elementSize;var a=new n,s=new c(this.from,this.to);i.pointToLocalFrame(r,e,s.from,s.from),i.pointToLocalFrame(r,e,s.to,s.to);var l=[],u=null,h=null,p=null,f=null,d=t.getIndexOfPosition(s.from.x,s.from.y,l,!1);if(d&&(u=l[0],h=l[1],p=l[0],f=l[1]),(d=t.getIndexOfPosition(s.to.x,s.to.y,l,!1))&&((null===u||l[0]<u)&&(u=l[0]),(null===p||l[0]>p)&&(p=l[0]),(null===h||l[1]<h)&&(h=l[1]),(null===f||l[1]>f)&&(f=l[1])),null!==u){var v=[];t.getRectMinMax(u,h,p,f,v),v[0],v[1];for(var y=u;y<=p;y++)for(var m=h;m<=f;m++){if(this.result._shouldStop)return;if(t.getConvexTrianglePillar(y,m,!1),i.pointToWorldFrame(r,e,t.pillarOffset,a),this.intersectConvex(t.pillarConvex,e,a,o,b),this.result._shouldStop)return;t.getConvexTrianglePillar(y,m,!0),i.pointToWorldFrame(r,e,t.pillarOffset,a),this.intersectConvex(t.pillarConvex,e,a,o,b)}}},c.prototype[a.types.HEIGHTFIELD]=c.prototype.intersectHeightfield;var w=new n,x=new n;c.prototype.intersectSphere=function(t,e,n,r){var i=this.from,o=this.to,a=t.radius,s=Math.pow(o.x-i.x,2)+Math.pow(o.y-i.y,2)+Math.pow(o.z-i.z,2),c=2*((o.x-i.x)*(i.x-n.x)+(o.y-i.y)*(i.y-n.y)+(o.z-i.z)*(i.z-n.z)),l=Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2)+Math.pow(i.z-n.z,2)-Math.pow(a,2),u=Math.pow(c,2)-4*s*l,h=w,p=x;if(!(u<0))if(0===u)i.lerp(o,u,h),h.vsub(n,p),p.normalize(),this.reportIntersection(p,h,t,r,-1);else{var f=(-c-Math.sqrt(u))/(2*s),d=(-c+Math.sqrt(u))/(2*s);if(f>=0&&f<=1&&(i.lerp(o,f,h),h.vsub(n,p),p.normalize(),this.reportIntersection(p,h,t,r,-1)),this.result._shouldStop)return;d>=0&&d<=1&&(i.lerp(o,d,h),h.vsub(n,p),p.normalize(),this.reportIntersection(p,h,t,r,-1))}},c.prototype[a.types.SPHERE]=c.prototype.intersectSphere;var S=new n,R=(new n,new n,new n);c.prototype.intersectConvex=function(t,e,n,r,i){for(var o=S,a=R,s=i&&i.faceList||null,c=t.faces,l=t.vertices,u=t.faceNormals,h=this._direction,p=this.from,d=this.to,v=p.distanceTo(d),b=s?s.length:c.length,w=this.result,x=0;!w._shouldStop&&x<b;x++){var O=s?s[x]:x,P=c[O],T=u[O],E=e,C=n;a.copy(l[P[0]]),E.vmult(a,a),a.vadd(C,a),a.vsub(p,a),E.vmult(T,o);var A=h.dot(o);if(!(Math.abs(A)<this.precision)){var k=o.dot(a)/A;if(!(k<0)){h.mult(k,y),y.vadd(p,y),m.copy(l[P[0]]),E.vmult(m,m),C.vadd(m,m);for(var M=1;!w._shouldStop&&M<P.length-1;M++){g.copy(l[P[M]]),_.copy(l[P[M+1]]),E.vmult(g,g),E.vmult(_,_),C.vadd(g,g),C.vadd(_,_);var j=y.distanceTo(p);!f(y,m,g,_)&&!f(y,g,m,_)||j>v||this.reportIntersection(o,y,t,r,O)}}}}},c.prototype[a.types.CONVEXPOLYHEDRON]=c.prototype.intersectConvex;var O=new n,P=new n,T=new n,E=new n,C=new n,A=new n,k=(new s,[]),M=new i;c.prototype.intersectTrimesh=function(t,e,n,r,o){var a=O,s=k,c=M,l=R,u=P,h=T,p=E,d=A,v=C,b=(o&&o.faceList,t.indices),w=(t.vertices,t.faceNormals,this.from),x=this.to,S=this._direction;c.position.copy(n),c.quaternion.copy(e),i.vectorToLocalFrame(n,e,S,u),i.pointToLocalFrame(n,e,w,h),i.pointToLocalFrame(n,e,x,p);var j=h.distanceSquared(p);t.tree.rayQuery(this,c,s);for(var L=0,B=s.length;!this.result._shouldStop&&L!==B;L++){var z=s[L];t.getNormal(z,a),t.getVertex(b[3*z],m),m.vsub(h,l);var F=u.dot(a),I=a.dot(l)/F;if(!(I<0)){u.scale(I,y),y.vadd(h,y),t.getVertex(b[3*z+1],g),t.getVertex(b[3*z+2],_);var D=y.distanceSquared(h);!f(y,g,m,_)&&!f(y,m,g,_)||D>j||(i.vectorToWorldFrame(e,a,v),i.pointToWorldFrame(n,e,y,d),this.reportIntersection(v,d,t,r,z))}}s.length=0},c.prototype[a.types.TRIMESH]=c.prototype.intersectTrimesh,c.prototype.reportIntersection=function(t,e,n,r,i){var o=this.from,a=this.to,s=o.distanceTo(e),l=this.result;if(!(this.skipBackfaces&&t.dot(this._direction)>0))switch(l.hitFaceIndex=void 0!==i?i:-1,this.mode){case c.ALL:this.hasHit=!0,l.set(o,a,t,e,n,r,s),l.hasHit=!0,this.callback(l);break;case c.CLOSEST:(s<l.distance||!l.hasHit)&&(this.hasHit=!0,l.hasHit=!0,l.set(o,a,t,e,n,r,s));break;case c.ANY:this.hasHit=!0,l.hasHit=!0,l.set(o,a,t,e,n,r,s),l._shouldStop=!0}};var j=new n,L=new n;function B(t,e,n){n.vsub(t,j);var r=j.dot(e);return e.mult(r,L),L.vadd(t,L),n.distanceTo(L)}},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(t,e){var n=t("../math/Vec3");function r(){this.rayFromWorld=new n,this.rayToWorld=new n,this.hitNormalWorld=new n,this.hitPointWorld=new n,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1}e.exports=r,r.prototype.reset=function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1},r.prototype.abort=function(){this._shouldStop=!0},r.prototype.set=function(t,e,n,r,i,o,a){this.rayFromWorld.copy(t),this.rayToWorld.copy(e),this.hitNormalWorld.copy(n),this.hitPointWorld.copy(r),this.shape=i,this.body=o,this.distance=a}},{"../math/Vec3":30}],11:[function(t,e){t("../shapes/Shape");var n=t("../collision/Broadphase");function r(t){n.apply(this),this.axisList=[],this.world=null,this.axisIndex=0;var e=this.axisList;this._addBodyHandler=function(t){e.push(t.body)},this._removeBodyHandler=function(t){var n=e.indexOf(t.body);-1!==n&&e.splice(n,1)},t&&this.setWorld(t)}e.exports=r,r.prototype=new n,r.prototype.setWorld=function(t){this.axisList.length=0;for(var e=0;e<t.bodies.length;e++)this.axisList.push(t.bodies[e]);t.removeEventListener("addBody",this._addBodyHandler),t.removeEventListener("removeBody",this._removeBodyHandler),t.addEventListener("addBody",this._addBodyHandler),t.addEventListener("removeBody",this._removeBodyHandler),this.world=t,this.dirty=!0},r.insertionSortX=function(t){for(var e=1,n=t.length;e<n;e++){for(var r=t[e],i=e-1;i>=0&&!(t[i].aabb.lowerBound.x<=r.aabb.lowerBound.x);i--)t[i+1]=t[i];t[i+1]=r}return t},r.insertionSortY=function(t){for(var e=1,n=t.length;e<n;e++){for(var r=t[e],i=e-1;i>=0&&!(t[i].aabb.lowerBound.y<=r.aabb.lowerBound.y);i--)t[i+1]=t[i];t[i+1]=r}return t},r.insertionSortZ=function(t){for(var e=1,n=t.length;e<n;e++){for(var r=t[e],i=e-1;i>=0&&!(t[i].aabb.lowerBound.z<=r.aabb.lowerBound.z);i--)t[i+1]=t[i];t[i+1]=r}return t},r.prototype.collisionPairs=function(t,e,n){var i,o,a=this.axisList,s=a.length,c=this.axisIndex;for(this.dirty&&(this.sortList(),this.dirty=!1),i=0;i!==s;i++){var l=a[i];for(o=i+1;o<s;o++){var u=a[o];if(this.needBroadphaseCollision(l,u)){if(!r.checkBounds(l,u,c))break;this.intersectionTest(l,u,e,n)}}}},r.prototype.sortList=function(){for(var t=this.axisList,e=this.axisIndex,n=t.length,i=0;i!==n;i++){var o=t[i];o.aabbNeedsUpdate&&o.computeAABB()}0===e?r.insertionSortX(t):1===e?r.insertionSortY(t):2===e&&r.insertionSortZ(t)},r.checkBounds=function(t,e,n){var r,i;0===n?(r=t.position.x,i=e.position.x):1===n?(r=t.position.y,i=e.position.y):2===n&&(r=t.position.z,i=e.position.z);var o=t.boundingRadius,a=e.boundingRadius;return i-a<r+o},r.prototype.autoDetectAxis=function(){for(var t=0,e=0,n=0,r=0,i=0,o=0,a=this.axisList,s=a.length,c=1/s,l=0;l!==s;l++){var u=a[l],h=u.position.x;t+=h,e+=h*h;var p=u.position.y;n+=p,r+=p*p;var f=u.position.z;i+=f,o+=f*f}var d=e-t*t*c,v=r-n*n*c,y=o-i*i*c;this.axisIndex=d>v?d>y?0:2:v>y?1:2},r.prototype.aabbQuery=function(t,e,n){n=n||[],this.dirty&&(this.sortList(),this.dirty=!1);var r=this.axisIndex,i="x";1===r&&(i="y"),2===r&&(i="z");for(var o=this.axisList,a=(e.lowerBound[i],e.upperBound[i],0);a<o.length;a++){var s=o[a];s.aabbNeedsUpdate&&s.computeAABB(),s.aabb.overlaps(e)&&n.push(s)}return n}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(t,e){e.exports=a,t("./Constraint");var n=t("./PointToPointConstraint"),r=t("../equations/ConeEquation"),i=t("../equations/RotationalEquation"),o=(t("../equations/ContactEquation"),t("../math/Vec3"));function a(t,e,a){var s=void 0!==(a=a||{}).maxForce?a.maxForce:1e6,c=a.pivotA?a.pivotA.clone():new o,l=a.pivotB?a.pivotB.clone():new o;this.axisA=a.axisA?a.axisA.clone():new o,this.axisB=a.axisB?a.axisB.clone():new o,n.call(this,t,c,e,l,s),this.collideConnected=!!a.collideConnected,this.angle=void 0!==a.angle?a.angle:0;var u=this.coneEquation=new r(t,e,a),h=this.twistEquation=new i(t,e,a);this.twistAngle=void 0!==a.twistAngle?a.twistAngle:0,u.maxForce=0,u.minForce=-s,h.maxForce=0,h.minForce=-s,this.equations.push(u,h)}a.prototype=new n,a.constructor=a,new o,new o,a.prototype.update=function(){var t=this.bodyA,e=this.bodyB,r=this.coneEquation,i=this.twistEquation;n.prototype.update.call(this),t.vectorToWorldFrame(this.axisA,r.axisA),e.vectorToWorldFrame(this.axisB,r.axisB),this.axisA.tangents(i.axisA,i.axisA),t.vectorToWorldFrame(i.axisA,i.axisA),this.axisB.tangents(i.axisB,i.axisB),e.vectorToWorldFrame(i.axisB,i.axisB),r.angle=this.angle,i.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(t,e){e.exports=r;var n=t("../utils/Utils");function r(t,e,i){i=n.defaults(i,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=e,this.id=r.idCounter++,this.collideConnected=i.collideConnected,i.wakeUpBodies&&(t&&t.wakeUp(),e&&e.wakeUp())}r.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},r.prototype.enable=function(){for(var t=this.equations,e=0;e<t.length;e++)t[e].enabled=!0},r.prototype.disable=function(){for(var t=this.equations,e=0;e<t.length;e++)t[e].enabled=!1},r.idCounter=0},{"../utils/Utils":53}],14:[function(t,e){e.exports=i;var n=t("./Constraint"),r=t("../equations/ContactEquation");function i(t,e,i,o){n.call(this,t,e),void 0===i&&(i=t.position.distanceTo(e.position)),void 0===o&&(o=1e6),this.distance=i;var a=this.distanceEquation=new r(t,e);this.equations.push(a),a.minForce=-o,a.maxForce=o}i.prototype=new n,i.prototype.update=function(){var t=this.bodyA,e=this.bodyB,n=this.distanceEquation,r=.5*this.distance,i=n.ni;e.position.vsub(t.position,i),i.normalize(),i.mult(r,n.ri),i.mult(-r,n.rj)}},{"../equations/ContactEquation":19,"./Constraint":13}],15:[function(t,e){e.exports=a,t("./Constraint");var n=t("./PointToPointConstraint"),r=t("../equations/RotationalEquation"),i=t("../equations/RotationalMotorEquation"),o=(t("../equations/ContactEquation"),t("../math/Vec3"));function a(t,e,a){var s=void 0!==(a=a||{}).maxForce?a.maxForce:1e6,c=a.pivotA?a.pivotA.clone():new o,l=a.pivotB?a.pivotB.clone():new o;n.call(this,t,c,e,l,s),(this.axisA=a.axisA?a.axisA.clone():new o(1,0,0)).normalize(),(this.axisB=a.axisB?a.axisB.clone():new o(1,0,0)).normalize();var u=this.rotationalEquation1=new r(t,e,a),h=this.rotationalEquation2=new r(t,e,a),p=this.motorEquation=new i(t,e,s);p.enabled=!1,this.equations.push(u,h,p)}a.prototype=new n,a.constructor=a,a.prototype.enableMotor=function(){this.motorEquation.enabled=!0},a.prototype.disableMotor=function(){this.motorEquation.enabled=!1},a.prototype.setMotorSpeed=function(t){this.motorEquation.targetVelocity=t},a.prototype.setMotorMaxForce=function(t){this.motorEquation.maxForce=t,this.motorEquation.minForce=-t};var s=new o,c=new o;a.prototype.update=function(){var t=this.bodyA,e=this.bodyB,r=this.motorEquation,i=this.rotationalEquation1,o=this.rotationalEquation2,a=s,l=c,u=this.axisA,h=this.axisB;n.prototype.update.call(this),t.quaternion.vmult(u,a),e.quaternion.vmult(h,l),a.tangents(i.axisA,o.axisA),i.axisB.copy(l),o.axisB.copy(l),this.motorEquation.enabled&&(t.quaternion.vmult(this.axisA,r.axisA),e.quaternion.vmult(this.axisB,r.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(t,e){e.exports=o,t("./Constraint");var n=t("./PointToPointConstraint"),r=t("../equations/RotationalEquation"),i=(t("../equations/RotationalMotorEquation"),t("../equations/ContactEquation"),t("../math/Vec3"));function o(t,e,o){var a=void 0!==(o=o||{}).maxForce?o.maxForce:1e6,s=new i,c=new i,l=new i;t.position.vadd(e.position,l),l.scale(.5,l),e.pointToLocalFrame(l,c),t.pointToLocalFrame(l,s),n.call(this,t,s,e,c,a);var u=this.rotationalEquation1=new r(t,e,o),h=this.rotationalEquation2=new r(t,e,o),p=this.rotationalEquation3=new r(t,e,o);this.equations.push(u,h,p)}o.prototype=new n,o.constructor=o,new i,new i,o.prototype.update=function(){var t=this.bodyA,e=this.bodyB,r=(this.motorEquation,this.rotationalEquation1),o=this.rotationalEquation2,a=this.rotationalEquation3;n.prototype.update.call(this),t.vectorToWorldFrame(i.UNIT_X,r.axisA),e.vectorToWorldFrame(i.UNIT_Y,r.axisB),t.vectorToWorldFrame(i.UNIT_Y,o.axisA),e.vectorToWorldFrame(i.UNIT_Z,o.axisB),t.vectorToWorldFrame(i.UNIT_Z,a.axisA),e.vectorToWorldFrame(i.UNIT_X,a.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(t,e){e.exports=o;var n=t("./Constraint"),r=t("../equations/ContactEquation"),i=t("../math/Vec3");function o(t,e,o,a,s){n.call(this,t,o),s=void 0!==s?s:1e6,this.pivotA=e?e.clone():new i,this.pivotB=a?a.clone():new i;var c=this.equationX=new r(t,o),l=this.equationY=new r(t,o),u=this.equationZ=new r(t,o);this.equations.push(c,l,u),c.minForce=l.minForce=u.minForce=-s,c.maxForce=l.maxForce=u.maxForce=s,c.ni.set(1,0,0),l.ni.set(0,1,0),u.ni.set(0,0,1)}o.prototype=new n,o.prototype.update=function(){var t=this.bodyA,e=this.bodyB,n=this.equationX,r=this.equationY,i=this.equationZ;t.quaternion.vmult(this.pivotA,n.ri),e.quaternion.vmult(this.pivotB,n.rj),r.ri.copy(n.ri),r.rj.copy(n.rj),i.ri.copy(n.ri),i.rj.copy(n.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(t,e){e.exports=i;var n=t("../math/Vec3"),r=(t("../math/Mat3"),t("./Equation"));function i(t,e,i){var o=void 0!==(i=i||{}).maxForce?i.maxForce:1e6;r.call(this,t,e,-o,o),this.axisA=i.axisA?i.axisA.clone():new n(1,0,0),this.axisB=i.axisB?i.axisB.clone():new n(0,1,0),this.angle=void 0!==i.angle?i.angle:0}i.prototype=new r,i.prototype.constructor=i;var o=new n,a=new n;i.prototype.computeB=function(t){var e=this.a,n=this.b,r=this.axisA,i=this.axisB,s=o,c=a,l=this.jacobianElementA,u=this.jacobianElementB;return r.cross(i,s),i.cross(r,c),l.rotational.copy(c),u.rotational.copy(s),-(Math.cos(this.angle)-r.dot(i))*e-this.computeGW()*n-t*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(t,e){e.exports=i;var n=t("./Equation"),r=t("../math/Vec3");function i(t,e,i){i=void 0!==i?i:1e6,n.call(this,t,e,0,i),this.restitution=0,this.ri=new r,this.rj=new r,this.ni=new r}t("../math/Mat3"),i.prototype=new n,i.prototype.constructor=i;var o=new r,a=new r,s=new r;i.prototype.computeB=function(t){var e=this.a,n=this.b,r=this.bi,i=this.bj,c=this.ri,l=this.rj,u=o,h=a,p=r.velocity,f=r.angularVelocity,d=(r.force,r.torque,i.velocity),v=i.angularVelocity,y=(i.force,i.torque,s),m=this.jacobianElementA,g=this.jacobianElementB,_=this.ni;c.cross(_,u),l.cross(_,h),_.negate(m.spatial),u.negate(m.rotational),g.spatial.copy(_),g.rotational.copy(h),y.copy(i.position),y.vadd(l,y),y.vsub(r.position,y),y.vsub(c,y);var b=_.dot(y),w=this.restitution+1;return-b*e-(w*d.dot(_)-w*p.dot(_)+v.dot(h)-f.dot(u))*n-t*this.computeGiMf()};var c=new r,l=new r,u=new r,h=new r,p=new r;i.prototype.getImpactVelocityAlongNormal=function(){var t=c,e=l,n=u,r=h,i=p;return this.bi.position.vadd(this.ri,n),this.bj.position.vadd(this.rj,r),this.bi.getVelocityAtWorldPoint(n,t),this.bj.getVelocityAtWorldPoint(r,e),t.vsub(e,i),this.ni.dot(i)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(t,e){e.exports=i;var n=t("../math/JacobianElement"),r=t("../math/Vec3");function i(t,e,r,o){this.id=i.id++,this.minForce=void 0===r?-1e6:r,this.maxForce=void 0===o?1e6:o,this.bi=t,this.bj=e,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new n,this.jacobianElementB=new n,this.enabled=!0,this.setSpookParams(1e7,4,1/60)}i.prototype.constructor=i,i.id=0,i.prototype.setSpookParams=function(t,e,n){var r=e,i=t,o=n;this.a=4/(o*(1+4*r)),this.b=4*r/(1+4*r),this.eps=4/(o*o*i*(1+4*r))},i.prototype.computeB=function(t,e,n){var r=this.computeGW();return-this.computeGq()*t-r*e-this.computeGiMf()*n},i.prototype.computeGq=function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,r=this.bj,i=n.position,o=r.position;return t.spatial.dot(i)+e.spatial.dot(o)};var o=new r;i.prototype.computeGW=function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,r=this.bj,i=n.velocity,a=r.velocity,s=n.angularVelocity||o,c=r.angularVelocity||o;return t.multiplyVectors(i,s)+e.multiplyVectors(a,c)},i.prototype.computeGWlambda=function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,r=this.bj,i=n.vlambda,a=r.vlambda,s=n.wlambda||o,c=r.wlambda||o;return t.multiplyVectors(i,s)+e.multiplyVectors(a,c)};var a=new r,s=new r,c=new r,l=new r;i.prototype.computeGiMf=function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,r=this.bj,i=n.force,o=n.torque,u=r.force,h=r.torque,p=n.invMassSolve,f=r.invMassSolve;return n.invInertiaWorldSolve?n.invInertiaWorldSolve.vmult(o,c):c.set(0,0,0),r.invInertiaWorldSolve?r.invInertiaWorldSolve.vmult(h,l):l.set(0,0,0),i.mult(p,a),u.mult(f,s),t.multiplyVectors(a,c)+e.multiplyVectors(s,l)};var u=new r;i.prototype.computeGiMGt=function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,r=this.bj,i=n.invMassSolve,o=r.invMassSolve,a=n.invInertiaWorldSolve,s=r.invInertiaWorldSolve,c=i+o;return a&&(a.vmult(t.rotational,u),c+=u.dot(t.rotational)),s&&(s.vmult(e.rotational,u),c+=u.dot(e.rotational)),c};var h=new r;new r,new r,new r,new r,new r,i.prototype.addToWlambda=function(t){var e=this.jacobianElementA,n=this.jacobianElementB,r=this.bi,i=this.bj,o=h;e.spatial.mult(r.invMassSolve*t,o),r.vlambda.vadd(o,r.vlambda),n.spatial.mult(i.invMassSolve*t,o),i.vlambda.vadd(o,i.vlambda),r.invInertiaWorldSolve&&(r.invInertiaWorldSolve.vmult(e.rotational,o),o.mult(t,o),r.wlambda.vadd(o,r.wlambda)),i.invInertiaWorldSolve&&(i.invInertiaWorldSolve.vmult(n.rotational,o),o.mult(t,o),i.wlambda.vadd(o,i.wlambda))},i.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(t,e){e.exports=i;var n=t("./Equation"),r=t("../math/Vec3");function i(t,e,i){n.call(this,t,e,-i,i),this.ri=new r,this.rj=new r,this.t=new r}t("../math/Mat3"),i.prototype=new n,i.prototype.constructor=i;var o=new r,a=new r;i.prototype.computeB=function(t){this.a;var e=this.b,n=(this.bi,this.bj,this.ri),r=this.rj,i=o,s=a,c=this.t;n.cross(c,i),r.cross(c,s);var l=this.jacobianElementA,u=this.jacobianElementB;return c.negate(l.spatial),i.negate(l.rotational),u.spatial.copy(c),u.rotational.copy(s),-this.computeGW()*e-t*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(t,e){e.exports=i;var n=t("../math/Vec3"),r=(t("../math/Mat3"),t("./Equation"));function i(t,e,i){var o=void 0!==(i=i||{}).maxForce?i.maxForce:1e6;r.call(this,t,e,-o,o),this.axisA=i.axisA?i.axisA.clone():new n(1,0,0),this.axisB=i.axisB?i.axisB.clone():new n(0,1,0),this.maxAngle=Math.PI/2}i.prototype=new r,i.prototype.constructor=i;var o=new n,a=new n;i.prototype.computeB=function(t){var e=this.a,n=this.b,r=this.axisA,i=this.axisB,s=o,c=a,l=this.jacobianElementA,u=this.jacobianElementB;return r.cross(i,s),i.cross(r,c),l.rotational.copy(c),u.rotational.copy(s),-(Math.cos(this.maxAngle)-r.dot(i))*e-this.computeGW()*n-t*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(t,e){e.exports=i;var n=t("../math/Vec3"),r=(t("../math/Mat3"),t("./Equation"));function i(t,e,i){i=void 0!==i?i:1e6,r.call(this,t,e,-i,i),this.axisA=new n,this.axisB=new n,this.targetVelocity=0}i.prototype=new r,i.prototype.constructor=i,i.prototype.computeB=function(t){this.a;var e=this.b,n=(this.bi,this.bj,this.axisA),r=this.axisB,i=this.jacobianElementA,o=this.jacobianElementB;return i.rotational.copy(n),r.negate(o.rotational),-(this.computeGW()-this.targetVelocity)*e-t*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(t,e){var n=t("../utils/Utils");function r(t,e,i){i=n.defaults(i,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=r.idCounter++,this.materials=[t,e],this.friction=i.friction,this.restitution=i.restitution,this.contactEquationStiffness=i.contactEquationStiffness,this.contactEquationRelaxation=i.contactEquationRelaxation,this.frictionEquationStiffness=i.frictionEquationStiffness,this.frictionEquationRelaxation=i.frictionEquationRelaxation}e.exports=r,r.idCounter=0},{"../utils/Utils":53}],25:[function(t,e){function n(t){var e="";"string"==typeof(t=t||{})?(e=t,t={}):"object"==typeof t&&(e=""),this.name=e,this.id=n.idCounter++,this.friction=void 0!==t.friction?t.friction:-1,this.restitution=void 0!==t.restitution?t.restitution:-1}e.exports=n,n.idCounter=0},{}],26:[function(t,e){e.exports=r;var n=t("./Vec3");function r(){this.spatial=new n,this.rotational=new n}r.prototype.multiplyElement=function(t){return t.spatial.dot(this.spatial)+t.rotational.dot(this.rotational)},r.prototype.multiplyVectors=function(t,e){return t.dot(this.spatial)+e.dot(this.rotational)}},{"./Vec3":30}],27:[function(t,e){e.exports=r;var n=t("./Vec3");function r(t){this.elements=t||[0,0,0,0,0,0,0,0,0]}r.prototype.identity=function(){var t=this.elements;t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1},r.prototype.setZero=function(){var t=this.elements;t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0},r.prototype.setTrace=function(t){var e=this.elements;e[0]=t.x,e[4]=t.y,e[8]=t.z},r.prototype.getTrace=function(t){t=t||new n;var e=this.elements;t.x=e[0],t.y=e[4],t.z=e[8]},r.prototype.vmult=function(t,e){e=e||new n;var r=this.elements,i=t.x,o=t.y,a=t.z;return e.x=r[0]*i+r[1]*o+r[2]*a,e.y=r[3]*i+r[4]*o+r[5]*a,e.z=r[6]*i+r[7]*o+r[8]*a,e},r.prototype.smult=function(t){for(var e=0;e<this.elements.length;e++)this.elements[e]*=t},r.prototype.mmult=function(t,e){for(var n=e||new r,i=0;i<3;i++)for(var o=0;o<3;o++){for(var a=0,s=0;s<3;s++)a+=t.elements[i+3*s]*this.elements[s+3*o];n.elements[i+3*o]=a}return n},r.prototype.scale=function(t,e){e=e||new r;for(var n=this.elements,i=e.elements,o=0;3!==o;o++)i[3*o+0]=t.x*n[3*o+0],i[3*o+1]=t.y*n[3*o+1],i[3*o+2]=t.z*n[3*o+2];return e},r.prototype.solve=function(t,e){e=e||new n;for(var r,i=3,o=4,a=[],s=0;s<i*o;s++)a.push(0);for(s=0;s<3;s++)for(r=0;r<3;r++)a[s+o*r]=this.elements[s+3*r];a[3]=t.x,a[7]=t.y,a[11]=t.z;var c,l,u=3,h=u,p=4;do{if(0===a[(s=h-u)+o*s])for(r=s+1;r<h;r++)if(0!==a[s+o*r]){c=p;do{a[(l=p-c)+o*s]+=a[l+o*r]}while(--c);break}if(0!==a[s+o*s])for(r=s+1;r<h;r++){var f=a[s+o*r]/a[s+o*s];c=p;do{a[(l=p-c)+o*r]=l<=s?0:a[l+o*r]-a[l+o*s]*f}while(--c)}}while(--u);if(e.z=a[2*o+3]/a[2*o+2],e.y=(a[1*o+3]-a[1*o+2]*e.z)/a[1*o+1],e.x=(a[0*o+3]-a[0*o+2]*e.z-a[0*o+1]*e.y)/a[0*o+0],isNaN(e.x)||isNaN(e.y)||isNaN(e.z)||e.x===1/0||e.y===1/0||e.z===1/0)throw"Could not solve equation! Got x=["+e.toString()+"], b=["+t.toString()+"], A=["+this.toString()+"]";return e},r.prototype.e=function(t,e,n){if(void 0===n)return this.elements[e+3*t];this.elements[e+3*t]=n},r.prototype.copy=function(t){for(var e=0;e<t.elements.length;e++)this.elements[e]=t.elements[e];return this},r.prototype.toString=function(){for(var t="",e=",",n=0;n<9;n++)t+=this.elements[n]+e;return t},r.prototype.reverse=function(t){t=t||new r;for(var e,n=3,i=6,o=[],a=0;a<n*i;a++)o.push(0);for(a=0;a<3;a++)for(e=0;e<3;e++)o[a+i*e]=this.elements[a+3*e];o[3]=1,o[9]=0,o[15]=0,o[4]=0,o[10]=1,o[16]=0,o[5]=0,o[11]=0,o[17]=1;var s,c,l=3,u=l,h=i;do{if(0===o[(a=u-l)+i*a])for(e=a+1;e<u;e++)if(0!==o[a+i*e]){s=h;do{o[(c=h-s)+i*a]+=o[c+i*e]}while(--s);break}if(0!==o[a+i*a])for(e=a+1;e<u;e++){var p=o[a+i*e]/o[a+i*a];s=h;do{o[(c=h-s)+i*e]=c<=a?0:o[c+i*e]-o[c+i*a]*p}while(--s)}}while(--l);a=2;do{e=a-1;do{p=o[a+i*e]/o[a+i*a],s=i;do{o[(c=i-s)+i*e]=o[c+i*e]-o[c+i*a]*p}while(--s)}while(e--)}while(--a);a=2;do{p=1/o[a+i*a],s=i;do{o[(c=i-s)+i*a]=o[c+i*a]*p}while(--s)}while(a--);a=2;do{e=2;do{if(c=o[n+e+i*a],isNaN(c)||c===1/0)throw"Could not reverse! A=["+this.toString()+"]";t.e(a,e,c)}while(e--)}while(a--);return t},r.prototype.setRotationFromQuaternion=function(t){var e=t.x,n=t.y,r=t.z,i=t.w,o=e+e,a=n+n,s=r+r,c=e*o,l=e*a,u=e*s,h=n*a,p=n*s,f=r*s,d=i*o,v=i*a,y=i*s,m=this.elements;return m[0]=1-(h+f),m[1]=l-y,m[2]=u+v,m[3]=l+y,m[4]=1-(c+f),m[5]=p-d,m[6]=u-v,m[7]=p+d,m[8]=1-(c+h),this},r.prototype.transpose=function(t){for(var e=(t=t||new r).elements,n=this.elements,i=0;3!==i;i++)for(var o=0;3!==o;o++)e[3*i+o]=n[3*o+i];return t}},{"./Vec3":30}],28:[function(t,e){e.exports=r;var n=t("./Vec3");function r(t,e,n,r){this.x=void 0!==t?t:0,this.y=void 0!==e?e:0,this.z=void 0!==n?n:0,this.w=void 0!==r?r:1}r.prototype.set=function(t,e,n,r){this.x=t,this.y=e,this.z=n,this.w=r},r.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w},r.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},r.prototype.setFromAxisAngle=function(t,e){var n=Math.sin(.5*e);this.x=t.x*n,this.y=t.y*n,this.z=t.z*n,this.w=Math.cos(.5*e)},r.prototype.toAxisAngle=function(t){t=t||new n,this.normalize();var e=2*Math.acos(this.w),r=Math.sqrt(1-this.w*this.w);return r<.001?(t.x=this.x,t.y=this.y,t.z=this.z):(t.x=this.x/r,t.y=this.y/r,t.z=this.z/r),[t,e]};var i=new n,o=new n;r.prototype.setFromVectors=function(t,e){if(t.isAntiparallelTo(e)){var n=i,r=o;t.tangents(n,r),this.setFromAxisAngle(n,Math.PI)}else{var a=t.cross(e);this.x=a.x,this.y=a.y,this.z=a.z,this.w=Math.sqrt(Math.pow(t.norm(),2)*Math.pow(e.norm(),2))+t.dot(e),this.normalize()}};var a=new n,s=new n,c=new n;r.prototype.mult=function(t,e){e=e||new r;var n=this.w,i=a,o=s,l=c;return i.set(this.x,this.y,this.z),o.set(t.x,t.y,t.z),e.w=n*t.w-i.dot(o),i.cross(o,l),e.x=n*o.x+t.w*i.x+l.x,e.y=n*o.y+t.w*i.y+l.y,e.z=n*o.z+t.w*i.z+l.z,e},r.prototype.inverse=function(t){var e=this.x,n=this.y,i=this.z,o=this.w;t=t||new r,this.conjugate(t);var a=1/(e*e+n*n+i*i+o*o);return t.x*=a,t.y*=a,t.z*=a,t.w*=a,t},r.prototype.conjugate=function(t){return(t=t||new r).x=-this.x,t.y=-this.y,t.z=-this.z,t.w=this.w,t},r.prototype.normalize=function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===t?(this.x=0,this.y=0,this.z=0,this.w=0):(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t)},r.prototype.normalizeFast=function(){var t=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;0===t?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=t,this.y*=t,this.z*=t,this.w*=t)},r.prototype.vmult=function(t,e){e=e||new n;var r=t.x,i=t.y,o=t.z,a=this.x,s=this.y,c=this.z,l=this.w,u=l*r+s*o-c*i,h=l*i+c*r-a*o,p=l*o+a*i-s*r,f=-a*r-s*i-c*o;return e.x=u*l+f*-a+h*-c-p*-s,e.y=h*l+f*-s+p*-a-u*-c,e.z=p*l+f*-c+u*-s-h*-a,e},r.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},r.prototype.toEuler=function(t,e){var n,r,i;e=e||"YZX";var o=this.x,a=this.y,s=this.z,c=this.w;switch(e){case"YZX":var l=o*a+s*c;if(l>.499&&(n=2*Math.atan2(o,c),r=Math.PI/2,i=0),l<-.499&&(n=-2*Math.atan2(o,c),r=-Math.PI/2,i=0),isNaN(n)){var u=o*o,h=a*a,p=s*s;n=Math.atan2(2*a*c-2*o*s,1-2*h-2*p),r=Math.asin(2*l),i=Math.atan2(2*o*c-2*a*s,1-2*u-2*p)}break;default:throw new Error("Euler order "+e+" not supported yet.")}t.y=n,t.z=r,t.x=i},r.prototype.setFromEuler=function(t,e,n,r){r=r||"XYZ";var i=Math.cos(t/2),o=Math.cos(e/2),a=Math.cos(n/2),s=Math.sin(t/2),c=Math.sin(e/2),l=Math.sin(n/2);return"XYZ"===r?(this.x=s*o*a+i*c*l,this.y=i*c*a-s*o*l,this.z=i*o*l+s*c*a,this.w=i*o*a-s*c*l):"YXZ"===r?(this.x=s*o*a+i*c*l,this.y=i*c*a-s*o*l,this.z=i*o*l-s*c*a,this.w=i*o*a+s*c*l):"ZXY"===r?(this.x=s*o*a-i*c*l,this.y=i*c*a+s*o*l,this.z=i*o*l+s*c*a,this.w=i*o*a-s*c*l):"ZYX"===r?(this.x=s*o*a-i*c*l,this.y=i*c*a+s*o*l,this.z=i*o*l-s*c*a,this.w=i*o*a+s*c*l):"YZX"===r?(this.x=s*o*a+i*c*l,this.y=i*c*a+s*o*l,this.z=i*o*l-s*c*a,this.w=i*o*a-s*c*l):"XZY"===r&&(this.x=s*o*a-i*c*l,this.y=i*c*a-s*o*l,this.z=i*o*l+s*c*a,this.w=i*o*a+s*c*l),this},r.prototype.clone=function(){return new r(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(t,e){var n=t("./Vec3"),r=t("./Quaternion");function i(t){t=t||{},this.position=new n,t.position&&this.position.copy(t.position),this.quaternion=new r,t.quaternion&&this.quaternion.copy(t.quaternion)}e.exports=i;var o=new r;i.pointToLocalFrame=function(t,e,r,i){return i=i||new n,r.vsub(t,i),e.conjugate(o),o.vmult(i,i),i},i.prototype.pointToLocal=function(t,e){return i.pointToLocalFrame(this.position,this.quaternion,t,e)},i.pointToWorldFrame=function(t,e,r,i){return i=i||new n,e.vmult(r,i),i.vadd(t,i),i},i.prototype.pointToWorld=function(t,e){return i.pointToWorldFrame(this.position,this.quaternion,t,e)},i.prototype.vectorToWorldFrame=function(t,e){return e=e||new n,this.quaternion.vmult(t,e),e},i.vectorToWorldFrame=function(t,e,n){return t.vmult(e,n),n},i.vectorToLocalFrame=function(t,e,r,i){return i=i||new n,e.w*=-1,e.vmult(r,i),e.w*=-1,i}},{"./Quaternion":28,"./Vec3":30}],30:[function(t,e){e.exports=r;var n=t("./Mat3");function r(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}r.ZERO=new r(0,0,0),r.UNIT_X=new r(1,0,0),r.UNIT_Y=new r(0,1,0),r.UNIT_Z=new r(0,0,1),r.prototype.cross=function(t,e){var n=t.x,i=t.y,o=t.z,a=this.x,s=this.y,c=this.z;return(e=e||new r).x=s*o-c*i,e.y=c*n-a*o,e.z=a*i-s*n,e},r.prototype.set=function(t,e,n){return this.x=t,this.y=e,this.z=n,this},r.prototype.setZero=function(){this.x=this.y=this.z=0},r.prototype.vadd=function(t,e){if(!e)return new r(this.x+t.x,this.y+t.y,this.z+t.z);e.x=t.x+this.x,e.y=t.y+this.y,e.z=t.z+this.z},r.prototype.vsub=function(t,e){if(!e)return new r(this.x-t.x,this.y-t.y,this.z-t.z);e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z},r.prototype.crossmat=function(){return new n([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])},r.prototype.normalize=function(){var t=this.x,e=this.y,n=this.z,r=Math.sqrt(t*t+e*e+n*n);if(r>0){var i=1/r;this.x*=i,this.y*=i,this.z*=i}else this.x=0,this.y=0,this.z=0;return r},r.prototype.unit=function(t){t=t||new r;var e=this.x,n=this.y,i=this.z,o=Math.sqrt(e*e+n*n+i*i);return o>0?(o=1/o,t.x=e*o,t.y=n*o,t.z=i*o):(t.x=1,t.y=0,t.z=0),t},r.prototype.norm=function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)},r.prototype.length=r.prototype.norm,r.prototype.norm2=function(){return this.dot(this)},r.prototype.lengthSquared=r.prototype.norm2,r.prototype.distanceTo=function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z;return Math.sqrt((i-e)*(i-e)+(o-n)*(o-n)+(a-r)*(a-r))},r.prototype.distanceSquared=function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z;return(i-e)*(i-e)+(o-n)*(o-n)+(a-r)*(a-r)},r.prototype.mult=function(t,e){e=e||new r;var n=this.x,i=this.y,o=this.z;return e.x=t*n,e.y=t*i,e.z=t*o,e},r.prototype.scale=r.prototype.mult,r.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},r.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z},r.prototype.negate=function(t){return(t=t||new r).x=-this.x,t.y=-this.y,t.z=-this.z,t};var i=new r,o=new r;r.prototype.tangents=function(t,e){var n=this.norm();if(n>0){var r=i,a=1/n;r.set(this.x*a,this.y*a,this.z*a);var s=o;Math.abs(r.x)<.9?(s.set(1,0,0),r.cross(s,t)):(s.set(0,1,0),r.cross(s,t)),r.cross(t,e)}else t.set(1,0,0),e.set(0,1,0)},r.prototype.toString=function(){return this.x+","+this.y+","+this.z},r.prototype.toArray=function(){return[this.x,this.y,this.z]},r.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},r.prototype.lerp=function(t,e,n){var r=this.x,i=this.y,o=this.z;n.x=r+(t.x-r)*e,n.y=i+(t.y-i)*e,n.z=o+(t.z-o)*e},r.prototype.almostEquals=function(t,e){return void 0===e&&(e=1e-6),!(Math.abs(this.x-t.x)>e||Math.abs(this.y-t.y)>e||Math.abs(this.z-t.z)>e)},r.prototype.almostZero=function(t){return void 0===t&&(t=1e-6),!(Math.abs(this.x)>t||Math.abs(this.y)>t||Math.abs(this.z)>t)};var a=new r;r.prototype.isAntiparallelTo=function(t,e){return this.negate(a),a.almostEquals(t,e)},r.prototype.clone=function(){return new r(this.x,this.y,this.z)}},{"./Mat3":27}],31:[function(t,e){e.exports=c;var n=t("../utils/EventTarget"),r=(t("../shapes/Shape"),t("../math/Vec3")),i=t("../math/Mat3"),o=t("../math/Quaternion"),a=(t("../material/Material"),t("../collision/AABB")),s=t("../shapes/Box");function c(t){t=t||{},n.apply(this),this.id=c.idCounter++,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new r,this.collisionFilterGroup="number"==typeof t.collisionFilterGroup?t.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof t.collisionFilterMask?t.collisionFilterMask:1,this.collisionResponse=!0,this.position=new r,t.position&&this.position.copy(t.position),this.previousPosition=new r,this.initPosition=new r,this.velocity=new r,t.velocity&&this.velocity.copy(t.velocity),this.initVelocity=new r,this.force=new r;var e="number"==typeof t.mass?t.mass:0;this.mass=e,this.invMass=e>0?1/e:0,this.material=t.material||null,this.linearDamping="number"==typeof t.linearDamping?t.linearDamping:.01,this.type=e<=0?c.STATIC:c.DYNAMIC,typeof t.type==typeof c.STATIC&&(this.type=t.type),this.allowSleep=void 0===t.allowSleep||t.allowSleep,this.sleepState=0,this.sleepSpeedLimit=void 0!==t.sleepSpeedLimit?t.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==t.sleepTimeLimit?t.sleepTimeLimit:1,this.timeLastSleepy=0,this._wakeUpAfterNarrowphase=!1,this.torque=new r,this.quaternion=new o,t.quaternion&&this.quaternion.copy(t.quaternion),this.initQuaternion=new o,this.angularVelocity=new r,t.angularVelocity&&this.angularVelocity.copy(t.angularVelocity),this.initAngularVelocity=new r,this.interpolatedPosition=new r,this.interpolatedQuaternion=new o,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new r,this.invInertia=new r,this.invInertiaWorld=new i,this.invMassSolve=0,this.invInertiaSolve=new r,this.invInertiaWorldSolve=new i,this.fixedRotation=void 0!==t.fixedRotation&&t.fixedRotation,this.angularDamping=void 0!==t.angularDamping?t.angularDamping:.01,this.aabb=new a,this.aabbNeedsUpdate=!0,this.wlambda=new r,t.shape&&this.addShape(t.shape),this.updateMassProperties()}c.prototype=new n,c.prototype.constructor=c,c.DYNAMIC=1,c.STATIC=2,c.KINEMATIC=4,c.AWAKE=0,c.SLEEPY=1,c.SLEEPING=2,c.idCounter=0,c.prototype.wakeUp=function(){var t=this.sleepState;this.sleepState=0,t===c.SLEEPING&&this.dispatchEvent({type:"wakeup"})},c.prototype.sleep=function(){this.sleepState=c.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0)},c.sleepyEvent={type:"sleepy"},c.sleepEvent={type:"sleep"},c.prototype.sleepTick=function(t){if(this.allowSleep){var e=this.sleepState,n=this.velocity.norm2()+this.angularVelocity.norm2(),r=Math.pow(this.sleepSpeedLimit,2);e===c.AWAKE&&n<r?(this.sleepState=c.SLEEPY,this.timeLastSleepy=t,this.dispatchEvent(c.sleepyEvent)):e===c.SLEEPY&&n>r?this.wakeUp():e===c.SLEEPY&&t-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(c.sleepEvent))}},c.prototype.updateSolveMassProperties=function(){this.sleepState===c.SLEEPING||this.type===c.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))},c.prototype.pointToLocalFrame=function(t,e){return e=e||new r,t.vsub(this.position,e),this.quaternion.conjugate().vmult(e,e),e},c.prototype.vectorToLocalFrame=function(t,e){return e=e||new r,this.quaternion.conjugate().vmult(t,e),e},c.prototype.pointToWorldFrame=function(t,e){return e=e||new r,this.quaternion.vmult(t,e),e.vadd(this.position,e),e},c.prototype.vectorToWorldFrame=function(t,e){return e=e||new r,this.quaternion.vmult(t,e),e};var l=new r,u=new o;c.prototype.addShape=function(t,e,n){var i=new r,a=new o;return e&&i.copy(e),n&&a.copy(n),this.shapes.push(t),this.shapeOffsets.push(i),this.shapeOrientations.push(a),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,this},c.prototype.updateBoundingRadius=function(){for(var t=this.shapes,e=this.shapeOffsets,n=t.length,r=0,i=0;i!==n;i++){var o=t[i];o.updateBoundingSphereRadius();var a=e[i].norm(),s=o.boundingSphereRadius;a+s>r&&(r=a+s)}this.boundingRadius=r};var h=new a;c.prototype.computeAABB=function(){for(var t=this.shapes,e=this.shapeOffsets,n=this.shapeOrientations,r=t.length,i=l,o=u,a=this.quaternion,s=this.aabb,c=h,p=0;p!==r;p++){var f=t[p];n[p].mult(a,o),o.vmult(e[p],i),i.vadd(this.position,i),f.calculateWorldAABB(i,o,c.lowerBound,c.upperBound),0===p?s.copy(c):s.extend(c)}this.aabbNeedsUpdate=!1};var p=new i,f=new i;new i,c.prototype.updateInertiaWorld=function(t){var e=this.invInertia;if(e.x!==e.y||e.y!==e.z||t){var n=p,r=f;n.setRotationFromQuaternion(this.quaternion),n.transpose(r),n.scale(e,n),n.mmult(r,this.invInertiaWorld)}};var d=new r,v=new r;c.prototype.applyForce=function(t,e){if(this.type===c.DYNAMIC){var n=d;e.vsub(this.position,n);var r=v;n.cross(t,r),this.force.vadd(t,this.force),this.torque.vadd(r,this.torque)}};var y=new r,m=new r;c.prototype.applyLocalForce=function(t,e){if(this.type===c.DYNAMIC){var n=y,r=m;this.vectorToWorldFrame(t,n),this.pointToWorldFrame(e,r),this.applyForce(n,r)}};var g=new r,_=new r,b=new r;c.prototype.applyImpulse=function(t,e){if(this.type===c.DYNAMIC){var n=g;e.vsub(this.position,n);var r=_;r.copy(t),r.mult(this.invMass,r),this.velocity.vadd(r,this.velocity);var i=b;n.cross(t,i),this.invInertiaWorld.vmult(i,i),this.angularVelocity.vadd(i,this.angularVelocity)}};var w=new r,x=new r;c.prototype.applyLocalImpulse=function(t,e){if(this.type===c.DYNAMIC){var n=w,r=x;this.vectorToWorldFrame(t,n),this.pointToWorldFrame(e,r),this.applyImpulse(n,r)}};var S=new r;c.prototype.updateMassProperties=function(){var t=S;this.invMass=this.mass>0?1/this.mass:0;var e=this.inertia,n=this.fixedRotation;this.computeAABB(),t.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),s.calculateInertia(t,this.mass,e),this.invInertia.set(e.x>0&&!n?1/e.x:0,e.y>0&&!n?1/e.y:0,e.z>0&&!n?1/e.z:0),this.updateInertiaWorld(!0)},c.prototype.getVelocityAtWorldPoint=function(t,e){var n=new r;return t.vsub(this.position,n),this.angularVelocity.cross(n,e),this.velocity.vadd(e,e),e}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(t,e){t("./Body");var n=t("../math/Vec3"),r=t("../math/Quaternion"),i=(t("../collision/RaycastResult"),t("../collision/Ray")),o=t("../objects/WheelInfo");function a(t){this.chassisBody=t.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=void 0!==t.indexRightAxis?t.indexRightAxis:1,this.indexForwardAxis=void 0!==t.indexForwardAxis?t.indexForwardAxis:0,this.indexUpAxis=void 0!==t.indexUpAxis?t.indexUpAxis:2}e.exports=a,new n,new n,new n;var s=new n,c=new n,l=new n;new i,a.prototype.addWheel=function(t){var e=new o(t=t||{}),n=this.wheelInfos.length;return this.wheelInfos.push(e),n},a.prototype.setSteeringValue=function(t,e){this.wheelInfos[e].steering=t},new n,a.prototype.applyEngineForce=function(t,e){this.wheelInfos[e].engineForce=t},a.prototype.setBrake=function(t,e){this.wheelInfos[e].brake=t},a.prototype.addToWorld=function(t){this.constraints,t.add(this.chassisBody);var e=this;this.preStepCallback=function(){e.updateVehicle(t.dt)},t.addEventListener("preStep",this.preStepCallback),this.world=t},a.prototype.getVehicleAxisWorld=function(t,e){e.set(0===t?1:0,1===t?1:0,2===t?1:0),this.chassisBody.vectorToWorldFrame(e,e)},a.prototype.updateVehicle=function(t){for(var e=this.wheelInfos,r=e.length,i=this.chassisBody,o=0;o<r;o++)this.updateWheelTransform(o);this.currentVehicleSpeedKmHour=3.6*i.velocity.norm();var a=new n;for(this.getVehicleAxisWorld(this.indexForwardAxis,a),a.dot(i.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1),o=0;o<r;o++)this.castRay(e[o]);this.updateSuspension(t);var s=new n,c=new n;for(o=0;o<r;o++){var l=(f=e[o]).suspensionForce;l>f.maxSuspensionForce&&(l=f.maxSuspensionForce),f.raycastResult.hitNormalWorld.scale(l*t,s),f.raycastResult.hitPointWorld.vsub(i.position,c),i.applyImpulse(s,f.raycastResult.hitPointWorld)}this.updateFriction(t);var u=new n,h=new n,p=new n;for(o=0;o<r;o++){var f=e[o];i.getVelocityAtWorldPoint(f.chassisConnectionPointWorld,p);var d=1;switch(this.indexUpAxis){case 1:d=-1}if(f.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,h);var v=h.dot(f.raycastResult.hitNormalWorld);f.raycastResult.hitNormalWorld.scale(v,u),h.vsub(u,h);var y=h.dot(p);f.deltaRotation=d*y*t/f.radius}!f.sliding&&f.isInContact||0===f.engineForce||!f.useCustomSlidingRotationalSpeed||(f.deltaRotation=(f.engineForce>0?1:-1)*f.customSlidingRotationalSpeed*t),Math.abs(f.brake)>Math.abs(f.engineForce)&&(f.deltaRotation=0),f.rotation+=f.deltaRotation,f.deltaRotation*=.99}},a.prototype.updateSuspension=function(){for(var t=this.chassisBody.mass,e=this.wheelInfos,n=e.length,r=0;r<n;r++){var i=e[r];if(i.isInContact){var o,a=i.suspensionRestLength-i.suspensionLength;o=i.suspensionStiffness*a*i.clippedInvContactDotSuspension;var s=i.suspensionRelativeVelocity;o-=(s<0?i.dampingCompression:i.dampingRelaxation)*s,i.suspensionForce=o*t,i.suspensionForce<0&&(i.suspensionForce=0)}else i.suspensionForce=0}},a.prototype.removeFromWorld=function(t){this.constraints,t.remove(this.chassisBody),t.removeEventListener("preStep",this.preStepCallback),this.world=null};var u=new n,h=new n;a.prototype.castRay=function(t){var e=u,r=h;this.updateWheelTransformWorld(t);var i=this.chassisBody,o=-1,a=t.suspensionRestLength+t.radius;t.directionWorld.scale(a,e);var s=t.chassisConnectionPointWorld;s.vadd(e,r);var c=t.raycastResult;c.reset();var l=i.collisionResponse;i.collisionResponse=!1,this.world.rayTest(s,r,c),i.collisionResponse=l;var p=c.body;if(t.raycastResult.groundObject=0,p){o=c.distance,t.raycastResult.hitNormalWorld=c.hitNormalWorld,t.isInContact=!0;var f=c.distance;t.suspensionLength=f-t.radius;var d=t.suspensionRestLength-t.maxSuspensionTravel,v=t.suspensionRestLength+t.maxSuspensionTravel;t.suspensionLength<d&&(t.suspensionLength=d),t.suspensionLength>v&&(t.suspensionLength=v,t.raycastResult.reset());var y=t.raycastResult.hitNormalWorld.dot(t.directionWorld),m=new n;i.getVelocityAtWorldPoint(t.raycastResult.hitPointWorld,m);var g=t.raycastResult.hitNormalWorld.dot(m);if(y>=-.1)t.suspensionRelativeVelocity=0,t.clippedInvContactDotSuspension=10;else{var _=-1/y;t.suspensionRelativeVelocity=g*_,t.clippedInvContactDotSuspension=_}}else t.suspensionLength=t.suspensionRestLength+0*t.maxSuspensionTravel,t.suspensionRelativeVelocity=0,t.directionWorld.scale(-1,t.raycastResult.hitNormalWorld),t.clippedInvContactDotSuspension=1;return o},a.prototype.updateWheelTransformWorld=function(t){t.isInContact=!1;var e=this.chassisBody;e.pointToWorldFrame(t.chassisConnectionPointLocal,t.chassisConnectionPointWorld),e.vectorToWorldFrame(t.directionLocal,t.directionWorld),e.vectorToWorldFrame(t.axleLocal,t.axleWorld)},a.prototype.updateWheelTransform=function(t){var e=s,n=c,i=l,o=this.wheelInfos[t];this.updateWheelTransformWorld(o),o.directionLocal.scale(-1,e),n.copy(o.axleLocal),e.cross(n,i),i.normalize(),n.normalize();var a=o.steering,u=new r;u.setFromAxisAngle(e,a);var h=new r;h.setFromAxisAngle(n,o.rotation);var p=o.worldTransform.quaternion;this.chassisBody.quaternion.mult(u,p),p.mult(h,p),p.normalize();var f=o.worldTransform.position;f.copy(o.directionWorld),f.scale(o.suspensionLength,f),f.vadd(o.chassisConnectionPointWorld,f)};var p=[new n(1,0,0),new n(0,1,0),new n(0,0,1)];a.prototype.getWheelTransformWorld=function(t){return this.wheelInfos[t].worldTransform};var f=new n,d=[],v=[],y=1;a.prototype.updateFriction=function(t){for(var e=f,r=this.wheelInfos,i=r.length,o=this.chassisBody,a=v,s=d,c=0;c<i;c++)_=(k=r[c]).raycastResult.body,k.sideImpulse=0,k.forwardImpulse=0,a[c]||(a[c]=new n),s[c]||(s[c]=new n);for(c=0;c<i;c++)if(_=(k=r[c]).raycastResult.body){var l=s[c];this.getWheelTransformWorld(c).vectorToWorldFrame(p[this.indexRightAxis],l);var u=k.raycastResult.hitNormalWorld,h=l.dot(u);u.scale(h,e),l.vsub(e,l),l.normalize(),u.cross(l,a[c]),a[c].normalize(),k.sideImpulse=C(o,k.raycastResult.hitPointWorld,_,k.raycastResult.hitPointWorld,l),k.sideImpulse*=y}var m=1,g=.5;for(this.sliding=!1,c=0;c<i;c++){var _=(k=r[c]).raycastResult.body,w=0;if(k.slipInfo=1,_){var x=0,S=k.brake?k.brake:x;w=b(o,_,k.raycastResult.hitPointWorld,a[c],S);var R=S/(w+=k.engineForce*t);k.slipInfo*=R}if(k.forwardImpulse=0,k.skidInfo=1,_){k.skidInfo=1;var O=k.suspensionForce*t*k.frictionSlip,P=O*O;k.forwardImpulse=w;var T=k.forwardImpulse*g,E=k.sideImpulse*m,A=T*T+E*E;k.sliding=!1,A>P&&(this.sliding=!0,k.sliding=!0,R=O/Math.sqrt(A),k.skidInfo*=R)}}if(this.sliding)for(c=0;c<i;c++)0!==(k=r[c]).sideImpulse&&k.skidInfo<1&&(k.forwardImpulse*=k.skidInfo,k.sideImpulse*=k.skidInfo);for(c=0;c<i;c++){var k=r[c],M=new n;if(M.copy(k.raycastResult.hitPointWorld),0!==k.forwardImpulse){var j=new n;a[c].scale(k.forwardImpulse,j),o.applyImpulse(j,M)}if(0!==k.sideImpulse){_=k.raycastResult.body;var L=new n;L.copy(k.raycastResult.hitPointWorld);var B=new n;s[c].scale(k.sideImpulse,B),o.pointToLocalFrame(M,M),M["xyz"[this.indexUpAxis]]*=k.rollInfluence,o.pointToWorldFrame(M,M),o.applyImpulse(B,M),B.scale(-1,B),_.applyImpulse(B,L)}}};var m=new n,g=new n,_=new n;function b(t,e,n,r,i){var o=0,a=n,s=m,c=g,l=_;return t.getVelocityAtWorldPoint(a,s),e.getVelocityAtWorldPoint(a,c),s.vsub(c,l),i<(o=-r.dot(l)*(1/(O(t,n,r)+O(e,n,r))))&&(o=i),o<-i&&(o=-i),o}var w=new n,x=new n,S=new n,R=new n;function O(t,e,n){var r=w,i=x,o=S,a=R;return e.vsub(t.position,r),r.cross(n,i),t.invInertiaWorld.vmult(i,a),a.cross(r,o),t.invMass+n.dot(o)}var P=new n,T=new n,E=new n;function C(t,e,n,r,i){if(i.norm2()>1.1)return 0;var o=P,a=T,s=E;return t.getVelocityAtWorldPoint(e,o),n.getVelocityAtWorldPoint(r,a),o.vsub(a,s),-.2*i.dot(s)*(1/(t.invMass+n.invMass))}},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(t,e){var n=t("./Body"),r=t("../shapes/Sphere"),i=t("../shapes/Box"),o=t("../math/Vec3"),a=t("../constraints/HingeConstraint");function s(t){if(this.wheelBodies=[],this.coordinateSystem=void 0===t.coordinateSystem?new o(1,2,3):t.coordinateSystem.clone(),this.chassisBody=t.chassisBody,!this.chassisBody){var e=new i(new o(5,2,.5));this.chassisBody=new n(1,e)}this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}e.exports=s,s.prototype.addWheel=function(t){var e=(t=t||{}).body;e||(e=new n(1,new r(1.2))),this.wheelBodies.push(e),this.wheelForces.push(0),new o;var i=void 0!==t.position?t.position.clone():new o,s=new o;this.chassisBody.pointToWorldFrame(i,s),e.position.set(s.x,s.y,s.z);var c=void 0!==t.axis?t.axis.clone():new o(0,1,0);this.wheelAxes.push(c);var l=new a(this.chassisBody,e,{pivotA:i,axisA:c,pivotB:o.ZERO,axisB:c,collideConnected:!1});return this.constraints.push(l),this.wheelBodies.length-1},s.prototype.setSteeringValue=function(t,e){var n=this.wheelAxes[e],r=Math.cos(t),i=Math.sin(t),o=n.x,a=n.y;this.constraints[e].axisA.set(r*o-i*a,i*o+r*a,0)},s.prototype.setMotorSpeed=function(t,e){var n=this.constraints[e];n.enableMotor(),n.motorTargetVelocity=t},s.prototype.disableMotor=function(t){this.constraints[t].disableMotor()};var c=new o;s.prototype.setWheelForce=function(t,e){this.wheelForces[e]=t},s.prototype.applyWheelForce=function(t,e){var n=this.wheelAxes[e],r=this.wheelBodies[e],i=r.torque;n.scale(t,c),r.vectorToWorldFrame(c,c),i.vadd(c,i)},s.prototype.addToWorld=function(t){for(var e=this.constraints,n=this.wheelBodies.concat([this.chassisBody]),r=0;r<n.length;r++)t.add(n[r]);for(r=0;r<e.length;r++)t.addConstraint(e[r]);t.addEventListener("preStep",this._update.bind(this))},s.prototype._update=function(){for(var t=this.wheelForces,e=0;e<t.length;e++)this.applyWheelForce(t[e],e)},s.prototype.removeFromWorld=function(t){for(var e=this.constraints,n=this.wheelBodies.concat([this.chassisBody]),r=0;r<n.length;r++)t.remove(n[r]);for(r=0;r<e.length;r++)t.removeConstraint(e[r])};var l=new o;s.prototype.getWheelSpeed=function(t){var e=this.wheelAxes[t],n=this.wheelBodies[t].angularVelocity;return this.chassisBody.vectorToWorldFrame(e,l),n.dot(l)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(t,e){e.exports=r,t("../shapes/Shape");var n=t("../math/Vec3");function r(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}t("../math/Quaternion"),t("../shapes/Particle"),t("../objects/Body"),t("../material/Material"),r.prototype.add=function(t){this.particles.push(t),this.neighbors.length<this.particles.length&&this.neighbors.push([])},r.prototype.remove=function(t){var e=this.particles.indexOf(t);-1!==e&&(this.particles.splice(e,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())};var i=new n;r.prototype.getNeighbors=function(t,e){for(var n=this.particles.length,r=t.id,o=this.smoothingRadius*this.smoothingRadius,a=i,s=0;s!==n;s++){var c=this.particles[s];c.position.vsub(t.position,a),r!==c.id&&a.norm2()<o&&e.push(c)}};var o=new n,a=new n,s=new n,c=new n,l=new n,u=new n;r.prototype.update=function(){for(var t=this.particles.length,e=o,n=this.speedOfSound,r=this.eps,i=0;i!==t;i++){var h=this.particles[i];(R=this.neighbors[i]).length=0,this.getNeighbors(h,R),R.push(this.particles[i]);for(var p=R.length,f=0,d=0;d!==p;d++){h.position.vsub(R[d].position,e);var v=e.norm(),y=this.w(v);f+=R[d].mass*y}this.densities[i]=f,this.pressures[i]=n*n*(this.densities[i]-this.density)}var m=a,g=s,_=c,b=l,w=u;for(i=0;i!==t;i++){var x,S,R,O=this.particles[i];for(m.set(0,0,0),g.set(0,0,0),p=(R=this.neighbors[i]).length,d=0;d!==p;d++){var P=R[d];O.position.vsub(P.position,b);var T=b.norm();x=-P.mass*(this.pressures[i]/(this.densities[i]*this.densities[i]+r)+this.pressures[d]/(this.densities[d]*this.densities[d]+r)),this.gradw(b,_),_.mult(x,_),m.vadd(_,m),P.velocity.vsub(O.velocity,w),w.mult(1/(1e-4+this.densities[i]*this.densities[d])*this.viscosity*P.mass,w),S=this.nablaw(T),w.mult(S,w),g.vadd(w,g)}g.mult(O.mass,g),m.mult(O.mass,m),O.force.vadd(g,O.force),O.force.vadd(m,O.force)}},r.prototype.w=function(t){var e=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(e,9))*Math.pow(e*e-t*t,3)},r.prototype.gradw=function(t,e){var n=t.norm(),r=this.smoothingRadius;t.mult(945/(32*Math.PI*Math.pow(r,9))*Math.pow(r*r-n*n,2),e)},r.prototype.nablaw=function(t){var e=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(e,9))*(e*e-t*t)*(7*t*t-3*e*e)}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(t,e){var n=t("../math/Vec3");function r(t,e,r){r=r||{},this.restLength="number"==typeof r.restLength?r.restLength:1,this.stiffness=r.stiffness||100,this.damping=r.damping||1,this.bodyA=t,this.bodyB=e,this.localAnchorA=new n,this.localAnchorB=new n,r.localAnchorA&&this.localAnchorA.copy(r.localAnchorA),r.localAnchorB&&this.localAnchorB.copy(r.localAnchorB),r.worldAnchorA&&this.setWorldAnchorA(r.worldAnchorA),r.worldAnchorB&&this.setWorldAnchorB(r.worldAnchorB)}e.exports=r,r.prototype.setWorldAnchorA=function(t){this.bodyA.pointToLocalFrame(t,this.localAnchorA)},r.prototype.setWorldAnchorB=function(t){this.bodyB.pointToLocalFrame(t,this.localAnchorB)},r.prototype.getWorldAnchorA=function(t){this.bodyA.pointToWorldFrame(this.localAnchorA,t)},r.prototype.getWorldAnchorB=function(t){this.bodyB.pointToWorldFrame(this.localAnchorB,t)};var i=new n,o=new n,a=new n,s=new n,c=new n,l=new n,u=new n,h=new n,p=new n,f=new n,d=new n;r.prototype.applyForce=function(){var t=this.stiffness,e=this.damping,n=this.restLength,r=this.bodyA,v=this.bodyB,y=i,m=o,g=a,_=s,b=d,w=c,x=l,S=u,R=h,O=p,P=f;this.getWorldAnchorA(w),this.getWorldAnchorB(x),w.vsub(r.position,S),x.vsub(v.position,R),x.vsub(w,y);var T=y.norm();m.copy(y),m.normalize(),v.velocity.vsub(r.velocity,g),v.angularVelocity.cross(R,b),g.vadd(b,g),r.angularVelocity.cross(S,b),g.vsub(b,g),m.mult(-t*(T-n)-e*g.dot(m),_),r.force.vsub(_,r.force),v.force.vadd(_,v.force),S.cross(_,O),R.cross(_,P),r.torque.vsub(O,r.torque),v.torque.vadd(P,v.torque)}},{"../math/Vec3":30}],36:[function(t,e){var n=t("../math/Vec3"),r=t("../math/Transform"),i=t("../collision/RaycastResult"),o=t("../utils/Utils");function a(t){t=o.defaults(t,{chassisConnectionPointLocal:new n,chassisConnectionPointWorld:new n,directionLocal:new n,directionWorld:new n,axleLocal:new n,axleWorld:new n,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=t.maxSuspensionTravel,this.customSlidingRotationalSpeed=t.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=t.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=t.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=t.chassisConnectionPointWorld.clone(),this.directionLocal=t.directionLocal.clone(),this.directionWorld=t.directionWorld.clone(),this.axleLocal=t.axleLocal.clone(),this.axleWorld=t.axleWorld.clone(),this.suspensionRestLength=t.suspensionRestLength,this.suspensionMaxLength=t.suspensionMaxLength,this.radius=t.radius,this.suspensionStiffness=t.suspensionStiffness,this.dampingCompression=t.dampingCompression,this.dampingRelaxation=t.dampingRelaxation,this.frictionSlip=t.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=t.rollInfluence,this.maxSuspensionForce=t.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=t.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new i,this.worldTransform=new r,this.isInContact=!1}e.exports=a;var s=new n,c=new n;s=new n,a.prototype.updateWheel=function(t){var e=this.raycastResult;if(this.isInContact){var n=e.hitNormalWorld.dot(e.directionWorld);e.hitPointWorld.vsub(t.position,c),t.getVelocityAtWorldPoint(c,s);var r=e.hitNormalWorld.dot(s);if(n>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10;else{var i=-1/n;this.suspensionRelativeVelocity=r*i,this.clippedInvContactDotSuspension=i}}else e.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,e.directionWorld.scale(-1,e.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(t,e){e.exports=o;var n=t("./Shape"),r=t("../math/Vec3"),i=t("./ConvexPolyhedron");function o(t){n.call(this),this.type=n.types.BOX,this.halfExtents=t,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}o.prototype=new n,o.prototype.constructor=o,o.prototype.updateConvexPolyhedronRepresentation=function(){var t=this.halfExtents.x,e=this.halfExtents.y,n=this.halfExtents.z,o=r,a=[new o(-t,-e,-n),new o(t,-e,-n),new o(t,e,-n),new o(-t,e,-n),new o(-t,-e,n),new o(t,-e,n),new o(t,e,n),new o(-t,e,n)],s=[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],c=(new o(0,0,1),new o(0,1,0),new o(1,0,0),new i(a,s));this.convexPolyhedronRepresentation=c,c.material=this.material},o.prototype.calculateLocalInertia=function(t,e){return e=e||new r,o.calculateInertia(this.halfExtents,t,e),e},o.calculateInertia=function(t,e,n){var r=t;n.x=1/12*e*(2*r.y*2*r.y+2*r.z*2*r.z),n.y=1/12*e*(2*r.x*2*r.x+2*r.z*2*r.z),n.z=1/12*e*(2*r.y*2*r.y+2*r.x*2*r.x)},o.prototype.getSideNormals=function(t,e){var n=t,r=this.halfExtents;if(n[0].set(r.x,0,0),n[1].set(0,r.y,0),n[2].set(0,0,r.z),n[3].set(-r.x,0,0),n[4].set(0,-r.y,0),n[5].set(0,0,-r.z),void 0!==e)for(var i=0;i!==n.length;i++)e.vmult(n[i],n[i]);return n},o.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var a=new r;new r,o.prototype.forEachWorldCorner=function(t,e,n){for(var r=this.halfExtents,i=[[r.x,r.y,r.z],[-r.x,r.y,r.z],[-r.x,-r.y,r.z],[-r.x,-r.y,-r.z],[r.x,-r.y,-r.z],[r.x,r.y,-r.z],[-r.x,r.y,-r.z],[r.x,-r.y,r.z]],o=0;o<i.length;o++)a.set(i[o][0],i[o][1],i[o][2]),e.vmult(a,a),t.vadd(a,a),n(a.x,a.y,a.z)};var s=[new r,new r,new r,new r,new r,new r,new r,new r];o.prototype.calculateWorldAABB=function(t,e,n,r){var i=this.halfExtents;s[0].set(i.x,i.y,i.z),s[1].set(-i.x,i.y,i.z),s[2].set(-i.x,-i.y,i.z),s[3].set(-i.x,-i.y,-i.z),s[4].set(i.x,-i.y,-i.z),s[5].set(i.x,i.y,-i.z),s[6].set(-i.x,i.y,-i.z),s[7].set(i.x,-i.y,i.z);var o=s[0];e.vmult(o,o),t.vadd(o,o),r.copy(o),n.copy(o);for(var a=1;a<8;a++){o=s[a],e.vmult(o,o),t.vadd(o,o);var c=o.x,l=o.y,u=o.z;c>r.x&&(r.x=c),l>r.y&&(r.y=l),u>r.z&&(r.z=u),c<n.x&&(n.x=c),l<n.y&&(n.y=l),u<n.z&&(n.z=u)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(t,e){e.exports=o;var n=t("./Shape"),r=t("../math/Vec3"),i=(t("../math/Quaternion"),t("../math/Transform"));function o(t,e,r){n.call(this),this.type=n.types.CONVEXPOLYHEDRON,this.vertices=t||[],this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.faces=e||[],this.faceNormals=[],this.computeNormals(),this.worldFaceNormalsNeedsUpdate=!0,this.worldFaceNormals=[],this.uniqueEdges=[],this.uniqueAxes=r?r.slice():null,this.computeEdges(),this.updateBoundingSphereRadius()}o.prototype=new n,o.prototype.constructor=o;var a=new r;o.prototype.computeEdges=function(){var t=this.faces,e=this.vertices,n=(e.length,this.uniqueEdges);n.length=0;for(var r=a,i=0;i!==t.length;i++)for(var o=t[i],s=o.length,c=0;c!==s;c++){var l=(c+1)%s;e[o[c]].vsub(e[o[l]],r),r.normalize();for(var u=!1,h=0;h!==n.length;h++)if(n[h].almostEquals(r)||n[h].almostEquals(r)){u=!0;break}u||n.push(r.clone())}},o.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var t=0;t<this.faces.length;t++){for(var e=0;e<this.faces[t].length;e++)if(!this.vertices[this.faces[t][e]])throw new Error("Vertex "+this.faces[t][e]+" not found!");var n=this.faceNormals[t]||new r;this.getFaceNormal(t,n),n.negate(n),this.faceNormals[t]=n;var i=this.vertices[this.faces[t][0]];if(n.dot(i)<0)for(console.error(".faceNormals["+t+"] = Vec3("+n.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule."),e=0;e<this.faces[t].length;e++)console.warn(".vertices["+this.faces[t][e]+"] = Vec3("+this.vertices[this.faces[t][e]].toString()+")")}};var s=new r,c=new r;o.computeNormal=function(t,e,n,r){e.vsub(t,c),n.vsub(e,s),s.cross(c,r),r.isZero()||r.normalize()},o.prototype.getFaceNormal=function(t,e){var n=this.faces[t],r=this.vertices[n[0]],i=this.vertices[n[1]],a=this.vertices[n[2]];return o.computeNormal(r,i,a,e)};var l=new r;o.prototype.clipAgainstHull=function(t,e,n,i,o,a,s,c,u){for(var h=l,p=-1,f=-Number.MAX_VALUE,d=0;d<n.faces.length;d++){h.copy(n.faceNormals[d]),o.vmult(h,h);var v=h.dot(a);v>f&&(f=v,p=d)}for(var y=[],m=n.faces[p],g=m.length,_=0;_<g;_++){var b=n.vertices[m[_]],w=new r;w.copy(b),o.vmult(w,w),i.vadd(w,w),y.push(w)}p>=0&&this.clipFaceAgainstHull(a,t,e,y,s,c,u)};var u=new r,h=new r,p=new r,f=new r,d=new r,v=new r;o.prototype.findSeparatingAxis=function(t,e,n,r,i,o,a,s){var c=u,l=h,y=p,m=f,g=d,_=v,b=Number.MAX_VALUE,w=this;if(w.uniqueAxes)for(S=0;S!==w.uniqueAxes.length;S++){if(n.vmult(w.uniqueAxes[S],c),!1===(P=w.testSepAxis(c,t,e,n,r,i)))return!1;P<b&&(b=P,o.copy(c))}else for(var x=a?a.length:w.faces.length,S=0;S<x;S++){var R=a?a[S]:S;if(c.copy(w.faceNormals[R]),n.vmult(c,c),!1===(P=w.testSepAxis(c,t,e,n,r,i)))return!1;P<b&&(b=P,o.copy(c))}if(t.uniqueAxes)for(S=0;S!==t.uniqueAxes.length;S++){if(i.vmult(t.uniqueAxes[S],l),!1===(P=w.testSepAxis(l,t,e,n,r,i)))return!1;P<b&&(b=P,o.copy(l))}else for(var O=s?s.length:t.faces.length,S=0;S<O;S++){var P;if(R=s?s[S]:S,l.copy(t.faceNormals[R]),i.vmult(l,l),!1===(P=w.testSepAxis(l,t,e,n,r,i)))return!1;P<b&&(b=P,o.copy(l))}for(var T=0;T!==w.uniqueEdges.length;T++){n.vmult(w.uniqueEdges[T],m);for(var E=0;E!==t.uniqueEdges.length;E++)if(i.vmult(t.uniqueEdges[E],g),m.cross(g,_),!_.almostZero()){_.normalize();var C=w.testSepAxis(_,t,e,n,r,i);if(!1===C)return!1;C<b&&(b=C,o.copy(_))}}return r.vsub(e,y),y.dot(o)>0&&o.negate(o),!0};var y=[],m=[];o.prototype.testSepAxis=function(t,e,n,r,i,a){var s=this;o.project(s,t,n,r,y),o.project(e,t,i,a,m);var c=y[0],l=y[1],u=m[0],h=m[1];if(c<h||u<l)return!1;var p=c-h,f=u-l;return p<f?p:f};var g=new r,_=new r;o.prototype.calculateLocalInertia=function(t,e){this.computeLocalAABB(g,_);var n=_.x-g.x,r=_.y-g.y,i=_.z-g.z;e.x=1/12*t*(2*r*2*r+2*i*2*i),e.y=1/12*t*(2*n*2*n+2*i*2*i),e.z=1/12*t*(2*r*2*r+2*n*2*n)},o.prototype.getPlaneConstantOfFace=function(t){var e=this.faces[t],n=this.faceNormals[t],r=this.vertices[e[0]];return-n.dot(r)};var b=new r,w=new r,x=new r,S=new r,R=new r,O=new r,P=new r,T=new r;o.prototype.clipFaceAgainstHull=function(t,e,n,r,i,o,a){for(var s=b,c=w,l=x,u=S,h=R,p=O,f=P,d=T,v=this,y=r,m=[],g=-1,_=Number.MAX_VALUE,E=0;E<v.faces.length;E++){s.copy(v.faceNormals[E]),n.vmult(s,s);var C=s.dot(t);C<_&&(_=C,g=E)}if(!(g<0)){var A=v.faces[g];A.connectedFaces=[];for(var k=0;k<v.faces.length;k++)for(var M=0;M<v.faces[k].length;M++)-1!==A.indexOf(v.faces[k][M])&&k!==g&&-1===A.connectedFaces.indexOf(k)&&A.connectedFaces.push(k);y.length;for(var j=A.length,L=0;L<j;L++){var B=v.vertices[A[L]],z=v.vertices[A[(L+1)%j]];B.vsub(z,c),l.copy(c),n.vmult(l,l),e.vadd(l,l),u.copy(this.faceNormals[g]),n.vmult(u,u),e.vadd(u,u),l.cross(u,h),h.negate(h),p.copy(B),n.vmult(p,p),e.vadd(p,p),p.dot(h);var F=A.connectedFaces[L];f.copy(this.faceNormals[F]);var I=this.getPlaneConstantOfFace(F);d.copy(f),n.vmult(d,d);var D=I-d.dot(e);for(this.clipFaceAgainstPlane(y,m,d,D);y.length;)y.shift();for(;m.length;)y.push(m.shift())}for(f.copy(this.faceNormals[g]),I=this.getPlaneConstantOfFace(g),d.copy(f),n.vmult(d,d),D=I-d.dot(e),k=0;k<y.length;k++){var q=d.dot(y[k])+D;if(q<=i&&(console.log("clamped: depth="+q+" to minDist="+i),q=i),q<=o){var N=y[k];if(q<=0){var V={point:N,normal:d,depth:q};a.push(V)}}}}},o.prototype.clipFaceAgainstPlane=function(t,e,n,i){var o,a,s=t.length;if(s<2)return e;var c=t[t.length-1],l=t[0];o=n.dot(c)+i;for(var u=0;u<s;u++){if(l=t[u],a=n.dot(l)+i,o<0)if(a<0)(h=new r).copy(l),e.push(h);else{var h=new r;c.lerp(l,o/(o-a),h),e.push(h)}else a<0&&(h=new r,c.lerp(l,o/(o-a),h),e.push(h),e.push(l));c=l,o=a}return e},o.prototype.computeWorldVertices=function(t,e){for(var n=this.vertices.length;this.worldVertices.length<n;)this.worldVertices.push(new r);for(var i=this.vertices,o=this.worldVertices,a=0;a!==n;a++)e.vmult(i[a],o[a]),t.vadd(o[a],o[a]);this.worldVerticesNeedsUpdate=!1},new r,o.prototype.computeLocalAABB=function(t,e){var n=this.vertices.length,r=this.vertices;t.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var i=0;i<n;i++){var o=r[i];o.x<t.x?t.x=o.x:o.x>e.x&&(e.x=o.x),o.y<t.y?t.y=o.y:o.y>e.y&&(e.y=o.y),o.z<t.z?t.z=o.z:o.z>e.z&&(e.z=o.z)}},o.prototype.computeWorldFaceNormals=function(t){for(var e=this.faceNormals.length;this.worldFaceNormals.length<e;)this.worldFaceNormals.push(new r);for(var n=this.faceNormals,i=this.worldFaceNormals,o=0;o!==e;o++)t.vmult(n[o],i[o]);this.worldFaceNormalsNeedsUpdate=!1},o.prototype.updateBoundingSphereRadius=function(){for(var t=0,e=this.vertices,n=0,r=e.length;n!==r;n++){var i=e[n].norm2();i>t&&(t=i)}this.boundingSphereRadius=Math.sqrt(t)};var E=new r;o.prototype.calculateWorldAABB=function(t,e,n,r){for(var i,o,a,s,c,l,u=this.vertices.length,h=this.vertices,p=0;p<u;p++){E.copy(h[p]),e.vmult(E,E),t.vadd(E,E);var f=E;f.x<i||void 0===i?i=f.x:(f.x>s||void 0===s)&&(s=f.x),f.y<o||void 0===o?o=f.y:(f.y>c||void 0===c)&&(c=f.y),f.z<a||void 0===a?a=f.z:(f.z>l||void 0===l)&&(l=f.z)}n.set(i,o,a),r.set(s,c,l)},o.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},o.prototype.getAveragePointLocal=function(t){t=t||new r;for(var e=this.vertices.length,n=this.vertices,i=0;i<e;i++)t.vadd(n[i],t);return t.mult(1/e,t),t},o.prototype.transformAllPoints=function(t,e){var n=this.vertices.length,r=this.vertices;if(e){for(var i=0;i<n;i++){var o=r[i];e.vmult(o,o)}for(i=0;i<this.faceNormals.length;i++)o=this.faceNormals[i],e.vmult(o,o)}if(t)for(i=0;i<n;i++)(o=r[i]).vadd(t,o)};var C=new r,A=new r,k=new r;o.prototype.pointIsInside=function(t){var e=this.vertices.length,n=this.vertices,r=this.faces,i=this.faceNormals,o=null,a=this.faces.length,s=C;this.getAveragePointLocal(s);for(var c=0;c<a;c++){this.faces[c].length,e=i[c];var l=n[r[c][0]],u=A;t.vsub(l,u);var h=e.dot(u),p=k;s.vsub(l,p);var f=e.dot(p);if(h<0&&f>0||h>0&&f<0)return!1}return o?1:-1},new r;var M=new r,j=new r;o.project=function(t,e,n,r,o){var a=t.vertices.length,s=M,c=0,l=0,u=j,h=t.vertices;u.setZero(),i.vectorToLocalFrame(n,r,e,s),i.pointToLocalFrame(n,r,u,u);var p=u.dot(s);l=c=h[0].dot(s);for(var f=1;f<a;f++){var d=h[f].dot(s);d>c&&(c=d),d<l&&(l=d)}if((l-=p)>(c-=p)){var v=l;l=c,c=v}o[0]=c,o[1]=l}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(t,e){e.exports=o;var n=t("./Shape"),r=t("../math/Vec3"),i=(t("../math/Quaternion"),t("./ConvexPolyhedron"));function o(t,e,o,a){var s=a,c=[],l=[],u=[],h=[],p=[],f=Math.cos,d=Math.sin;c.push(new r(e*f(0),e*d(0),.5*-o)),h.push(0),c.push(new r(t*f(0),t*d(0),.5*o)),p.push(1);for(var v=0;v<s;v++){var y=2*Math.PI/s*(v+1),m=2*Math.PI/s*(v+.5);v<s-1?(c.push(new r(e*f(y),e*d(y),.5*-o)),h.push(2*v+2),c.push(new r(t*f(y),t*d(y),.5*o)),p.push(2*v+3),u.push([2*v+2,2*v+3,2*v+1,2*v])):u.push([0,1,2*v+1,2*v]),(s%2==1||v<s/2)&&l.push(new r(f(m),d(m),0))}u.push(p),l.push(new r(0,0,1));var g=[];for(v=0;v<h.length;v++)g.push(h[h.length-v-1]);u.push(g),this.type=n.types.CONVEXPOLYHEDRON,i.call(this,c,u,l)}o.prototype=new i},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(t,e){var n=t("./Shape"),r=t("./ConvexPolyhedron"),i=t("../math/Vec3"),o=t("../utils/Utils");function a(t,e){e=o.defaults(e,{maxValue:null,minValue:null,elementSize:1}),this.data=t,this.maxValue=e.maxValue,this.minValue=e.minValue,this.elementSize=e.elementSize,null===e.minValue&&this.updateMinValue(),null===e.maxValue&&this.updateMaxValue(),this.cacheEnabled=!0,n.call(this),this.pillarConvex=new r,this.pillarOffset=new i,this.type=n.types.HEIGHTFIELD,this.updateBoundingSphereRadius(),this._cachedPillars={}}e.exports=a,a.prototype=new n,a.prototype.update=function(){this._cachedPillars={}},a.prototype.updateMinValue=function(){for(var t=this.data,e=t[0][0],n=0;n!==t.length;n++)for(var r=0;r!==t[n].length;r++){var i=t[n][r];i<e&&(e=i)}this.minValue=e},a.prototype.updateMaxValue=function(){for(var t=this.data,e=t[0][0],n=0;n!==t.length;n++)for(var r=0;r!==t[n].length;r++){var i=t[n][r];i>e&&(e=i)}this.maxValue=e},a.prototype.setHeightValueAtIndex=function(t,e,n){this.data[t][e]=n,this.clearCachedConvexTrianglePillar(t,e,!1),t>0&&(this.clearCachedConvexTrianglePillar(t-1,e,!0),this.clearCachedConvexTrianglePillar(t-1,e,!1)),e>0&&(this.clearCachedConvexTrianglePillar(t,e-1,!0),this.clearCachedConvexTrianglePillar(t,e-1,!1)),e>0&&t>0&&this.clearCachedConvexTrianglePillar(t-1,e-1,!0)},a.prototype.getRectMinMax=function(t,e,n,r,i){i=i||[];for(var o=this.data,a=this.minValue,s=t;s<=n;s++)for(var c=e;c<=r;c++){var l=o[s][c];l>a&&(a=l)}i[0]=this.minValue,i[1]=a},a.prototype.getIndexOfPosition=function(t,e,n,r){var i=this.elementSize,o=this.data,a=Math.floor(t/i),s=Math.floor(e/i);return n[0]=a,n[1]=s,r&&(a<0&&(a=0),s<0&&(s=0),a>=o.length-1&&(a=o.length-1),s>=o[0].length-1&&(s=o[0].length-1)),!(a<0||s<0||a>=o.length-1||s>=o[0].length-1)},a.prototype.getHeightAt=function(t,e,n){var r=[];this.getIndexOfPosition(t,e,r,n);var i=[];return this.getRectMinMax(r[0],r[1]+1,r[0],r[1]+1,i),(i[0]+i[1])/2},a.prototype.getCacheConvexTrianglePillarKey=function(t,e,n){return t+"_"+e+"_"+(n?1:0)},a.prototype.getCachedConvexTrianglePillar=function(t,e,n){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,n)]},a.prototype.setCachedConvexTrianglePillar=function(t,e,n,r,i){this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,n)]={convex:r,offset:i}},a.prototype.clearCachedConvexTrianglePillar=function(t,e,n){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(t,e,n)]},a.prototype.getConvexTrianglePillar=function(t,e,n){var o=this.pillarConvex,a=this.pillarOffset;if(this.cacheEnabled){if(s=this.getCachedConvexTrianglePillar(t,e,n))return this.pillarConvex=s.convex,void(this.pillarOffset=s.offset);o=new r,a=new i,this.pillarConvex=o,this.pillarOffset=a}var s=this.data,c=this.elementSize,l=o.faces;o.vertices.length=6;for(var u=0;u<6;u++)o.vertices[u]||(o.vertices[u]=new i);for(l.length=5,u=0;u<5;u++)l[u]||(l[u]=[]);var h=o.vertices,p=(Math.min(s[t][e],s[t+1][e],s[t][e+1],s[t+1][e+1])-this.minValue)/2+this.minValue;n?(a.set((t+.75)*c,(e+.75)*c,p),h[0].set(.25*c,.25*c,s[t+1][e+1]-p),h[1].set(-.75*c,.25*c,s[t][e+1]-p),h[2].set(.25*c,-.75*c,s[t+1][e]-p),h[3].set(.25*c,.25*c,-p-1),h[4].set(-.75*c,.25*c,-p-1),h[5].set(.25*c,-.75*c,-p-1),l[0][0]=0,l[0][1]=1,l[0][2]=2,l[1][0]=5,l[1][1]=4,l[1][2]=3,l[2][0]=2,l[2][1]=5,l[2][2]=3,l[2][3]=0,l[3][0]=3,l[3][1]=4,l[3][2]=1,l[3][3]=0,l[4][0]=1,l[4][1]=4,l[4][2]=5,l[4][3]=2):(a.set((t+.25)*c,(e+.25)*c,p),h[0].set(-.25*c,-.25*c,s[t][e]-p),h[1].set(.75*c,-.25*c,s[t+1][e]-p),h[2].set(-.25*c,.75*c,s[t][e+1]-p),h[3].set(-.25*c,-.25*c,-p-1),h[4].set(.75*c,-.25*c,-p-1),h[5].set(-.25*c,.75*c,-p-1),l[0][0]=0,l[0][1]=1,l[0][2]=2,l[1][0]=5,l[1][1]=4,l[1][2]=3,l[2][0]=0,l[2][1]=2,l[2][2]=5,l[2][3]=3,l[3][0]=1,l[3][1]=0,l[3][2]=3,l[3][3]=4,l[4][0]=4,l[4][1]=5,l[4][2]=2,l[4][3]=1),o.computeNormals(),o.computeEdges(),o.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(t,e,n,o,a)},a.prototype.calculateLocalInertia=function(t,e){return(e=e||new i).set(0,0,0),e},a.prototype.volume=function(){return Number.MAX_VALUE},a.prototype.calculateWorldAABB=function(t,e,n,r){n.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),r.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},a.prototype.updateBoundingSphereRadius=function(){var t=this.data,e=this.elementSize;this.boundingSphereRadius=new i(t.length*e,t[0].length*e,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(t,e){e.exports=i;var n=t("./Shape"),r=t("../math/Vec3");function i(){n.call(this),this.type=n.types.PARTICLE}i.prototype=new n,i.prototype.constructor=i,i.prototype.calculateLocalInertia=function(t,e){return(e=e||new r).set(0,0,0),e},i.prototype.volume=function(){return 0},i.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0},i.prototype.calculateWorldAABB=function(t,e,n,r){n.copy(t),r.copy(t)}},{"../math/Vec3":30,"./Shape":43}],42:[function(t,e){e.exports=i;var n=t("./Shape"),r=t("../math/Vec3");function i(){n.call(this),this.type=n.types.PLANE,this.worldNormal=new r,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}i.prototype=new n,i.prototype.constructor=i,i.prototype.computeWorldNormal=function(t){var e=this.worldNormal;e.set(0,0,1),t.vmult(e,e),this.worldNormalNeedsUpdate=!1},i.prototype.calculateLocalInertia=function(t,e){return e=e||new r},i.prototype.volume=function(){return Number.MAX_VALUE};var o=new r;i.prototype.calculateWorldAABB=function(t,e,n,r){o.set(0,0,1),e.vmult(o,o);var i=Number.MAX_VALUE;n.set(-i,-i,-i),r.set(i,i,i),1===o.x&&(r.x=t.x),1===o.y&&(r.y=t.y),1===o.z&&(r.z=t.z),-1===o.x&&(n.x=t.x),-1===o.y&&(n.y=t.y),-1===o.z&&(n.z=t.z)},i.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(t,e){e.exports=n;var n=t("./Shape");function n(){this.id=n.idCounter++,this.type=0,this.boundingSphereRadius=0,this.collisionResponse=!0,this.material=null}t("../math/Vec3"),t("../math/Quaternion"),t("../material/Material"),n.prototype.constructor=n,n.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type},n.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type},n.prototype.calculateLocalInertia=function(){throw"calculateLocalInertia() not implemented for shape type "+this.type},n.idCounter=0,n.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(t,e){e.exports=i;var n=t("./Shape"),r=t("../math/Vec3");function i(t){if(n.call(this),this.radius=void 0!==t?Number(t):1,this.type=n.types.SPHERE,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}i.prototype=new n,i.prototype.constructor=i,i.prototype.calculateLocalInertia=function(t,e){e=e||new r;var n=2*t*this.radius*this.radius/5;return e.x=n,e.y=n,e.z=n,e},i.prototype.volume=function(){return 4*Math.PI*this.radius/3},i.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius},i.prototype.calculateWorldAABB=function(t,e,n,r){for(var i=this.radius,o=["x","y","z"],a=0;a<o.length;a++){var s=o[a];n[s]=t[s]-i,r[s]=t[s]+i}}},{"../math/Vec3":30,"./Shape":43}],45:[function(t,e){e.exports=s;var n=t("./Shape"),r=t("../math/Vec3"),i=(t("../math/Quaternion"),t("../math/Transform")),o=t("../collision/AABB"),a=t("../utils/Octree");function s(t,e){n.call(this),this.type=n.types.TRIMESH,this.vertices=new Float32Array(t),this.indices=new Int16Array(e),this.normals=new Float32Array(e.length),this.aabb=new o,this.edges=null,this.scale=new r(1,1,1),this.tree=new a,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}s.prototype=new n,s.prototype.constructor=s;var c=new r;s.prototype.updateTree=function(){var t=this.tree;t.reset(),t.aabb.copy(this.aabb);var e=this.scale;t.aabb.lowerBound.x*=1/e.x,t.aabb.lowerBound.y*=1/e.y,t.aabb.lowerBound.z*=1/e.z,t.aabb.upperBound.x*=1/e.x,t.aabb.upperBound.y*=1/e.y,t.aabb.upperBound.z*=1/e.z;for(var n=new o,i=new r,a=new r,s=new r,c=[i,a,s],l=0;l<this.indices.length/3;l++){var u=3*l;this._getUnscaledVertex(this.indices[u],i),this._getUnscaledVertex(this.indices[u+1],a),this._getUnscaledVertex(this.indices[u+2],s),n.setFromPoints(c),t.insert(n,l)}t.removeEmptyNodes()};var l=new o;s.prototype.getTrianglesInAABB=function(t,e){l.copy(t);var n=this.scale,r=n.x,i=n.y,o=n.z,a=l.lowerBound,s=l.upperBound;return a.x/=r,a.y/=i,a.z/=o,s.x/=r,s.y/=i,s.z/=o,this.tree.aabbQuery(l,e)},s.prototype.setScale=function(t){var e=this.scale.x===this.scale.y===this.scale.z,n=t.x===t.y===t.z;e&&n||this.updateNormals(),this.scale.copy(t),this.updateAABB(),this.updateBoundingSphereRadius()},s.prototype.updateNormals=function(){for(var t=c,e=this.normals,n=0;n<this.indices.length/3;n++){var r=3*n,i=this.indices[r],o=this.indices[r+1],a=this.indices[r+2];this.getVertex(i,d),this.getVertex(o,v),this.getVertex(a,y),s.computeNormal(v,d,y,t),e[r]=t.x,e[r+1]=t.y,e[r+2]=t.z}},s.prototype.updateEdges=function(){for(var t={},e=function(){t[i<o?i+"_"+o:o+"_"+i]=!0},n=0;n<this.indices.length/3;n++){var r=3*n,i=this.indices[r],o=this.indices[r+1],a=this.indices[r+2];e(i,o),e(o,a),e(a,i)}var s=Object.keys(t);for(this.edges=new Int16Array(2*s.length),n=0;n<s.length;n++){var c=s[n].split("_");this.edges[2*n]=parseInt(c[0],10),this.edges[2*n+1]=parseInt(c[1],10)}},s.prototype.getEdgeVertex=function(t,e,n){var r=this.edges[2*t+(e?1:0)];this.getVertex(r,n)};var u=new r,h=new r;s.prototype.getEdgeVector=function(t,e){var n=u,r=h;this.getEdgeVertex(t,0,n),this.getEdgeVertex(t,1,r),r.vsub(n,e)};var p=new r,f=new r;s.computeNormal=function(t,e,n,r){e.vsub(t,f),n.vsub(e,p),p.cross(f,r),r.isZero()||r.normalize()};var d=new r,v=new r,y=new r;s.prototype.getVertex=function(t,e){var n=this.scale;return this._getUnscaledVertex(t,e),e.x*=n.x,e.y*=n.y,e.z*=n.z,e},s.prototype._getUnscaledVertex=function(t,e){var n=3*t,r=this.vertices;return e.set(r[n],r[n+1],r[n+2])},s.prototype.getWorldVertex=function(t,e,n,r){return this.getVertex(t,r),i.pointToWorldFrame(e,n,r,r),r},s.prototype.getTriangleVertices=function(t,e,n,r){var i=3*t;this.getVertex(this.indices[i],e),this.getVertex(this.indices[i+1],n),this.getVertex(this.indices[i+2],r)},s.prototype.getNormal=function(t,e){var n=3*t;return e.set(this.normals[n],this.normals[n+1],this.normals[n+2])};var m=new o;s.prototype.calculateLocalInertia=function(t,e){this.computeLocalAABB(m);var n=m.upperBound.x-m.lowerBound.x,r=m.upperBound.y-m.lowerBound.y,i=m.upperBound.z-m.lowerBound.z;return e.set(1/12*t*(2*r*2*r+2*i*2*i),1/12*t*(2*n*2*n+2*i*2*i),1/12*t*(2*r*2*r+2*n*2*n))};var g=new r;s.prototype.computeLocalAABB=function(t){var e=t.lowerBound,n=t.upperBound,r=this.vertices.length,i=(this.vertices,g);this.getVertex(0,i),e.copy(i),n.copy(i);for(var o=0;o!==r;o++)this.getVertex(o,i),i.x<e.x?e.x=i.x:i.x>n.x&&(n.x=i.x),i.y<e.y?e.y=i.y:i.y>n.y&&(n.y=i.y),i.z<e.z?e.z=i.z:i.z>n.z&&(n.z=i.z)},s.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)},s.prototype.updateBoundingSphereRadius=function(){for(var t=0,e=this.vertices,n=new r,i=0,o=e.length/3;i!==o;i++){this.getVertex(i,n);var a=n.norm2();a>t&&(t=a)}this.boundingSphereRadius=Math.sqrt(t)},new r;var _=new i,b=new o;s.prototype.calculateWorldAABB=function(t,e,n,r){var i=_,o=b;i.position=t,i.quaternion=e,this.aabb.toWorldFrame(i,o),n.copy(o.lowerBound),r.copy(o.upperBound)},s.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},s.createTorus=function(t,e,n,r,i){t=t||1,e=e||.5,n=n||8,r=r||6,i=i||2*Math.PI;for(var o=[],a=[],c=0;c<=n;c++)for(var l=0;l<=r;l++){var u=l/r*i,h=c/n*Math.PI*2,p=(t+e*Math.cos(h))*Math.cos(u),f=(t+e*Math.cos(h))*Math.sin(u),d=e*Math.sin(h);o.push(p,f,d)}for(c=1;c<=n;c++)for(l=1;l<=r;l++){var v=(r+1)*c+l-1,y=(r+1)*(c-1)+l-1,m=(r+1)*(c-1)+l,g=(r+1)*c+l;a.push(v,y,g),a.push(y,m,g)}return new s(o,a)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(t,e){e.exports=r,t("../math/Vec3"),t("../math/Quaternion");var n=t("./Solver");function r(){n.call(this),this.iterations=10,this.tolerance=1e-7}r.prototype=new n;var i=[],o=[],a=[];r.prototype.solve=function(t,e){var n,r,s,c,l,u=0,h=this.iterations,p=this.tolerance*this.tolerance,f=this.equations,d=f.length,v=e.bodies,y=v.length,m=t;if(0!==d)for(var g=0;g!==y;g++)v[g].updateSolveMassProperties();var _=o,b=a,w=i;for(_.length=d,b.length=d,w.length=d,g=0;g!==d;g++){var x=f[g];w[g]=0,b[g]=x.computeB(m),_[g]=1/x.computeC()}if(0!==d){for(g=0;g!==y;g++){var S=(P=v[g]).vlambda,R=P.wlambda;S.set(0,0,0),R&&R.set(0,0,0)}for(u=0;u!==h;u++){c=0;for(var O=0;O!==d;O++)x=f[O],n=b[O],r=_[O],(l=w[O])+(s=r*(n-x.computeGWlambda()-x.eps*l))<x.minForce?s=x.minForce-l:l+s>x.maxForce&&(s=x.maxForce-l),w[O]+=s,c+=s>0?s:-s,x.addToWlambda(s);if(c*c<p)break}for(g=0;g!==y;g++){var P,T=(P=v[g]).velocity,E=P.angularVelocity;T.vadd(P.vlambda,T),E&&E.vadd(P.wlambda,E)}}return u}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(t,e){function n(){this.equations=[]}e.exports=n,n.prototype.solve=function(){return 0},n.prototype.addEquation=function(t){t.enabled&&this.equations.push(t)},n.prototype.removeEquation=function(t){var e=this.equations,n=e.indexOf(t);-1!==n&&e.splice(n,1)},n.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(t,e){e.exports=i,t("../math/Vec3"),t("../math/Quaternion");var n=t("./Solver"),r=t("../objects/Body");function i(t){for(n.call(this),this.iterations=10,this.tolerance=1e-7,this.subsolver=t,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}i.prototype=new n;var o=[],a=[],s={bodies:[]},c=r.STATIC;function l(t){for(var e=t.length,n=0;n!==e;n++){var r=t[n];if(!(r.visited||r.body.type&c))return r}return!1}var u=[];function h(t,e,n,r){for(u.push(t),t.visited=!0,e(t,n,r);u.length;)for(var i,o=u.pop();i=l(o.children);)i.visited=!0,e(i,n,r),u.push(i)}function p(t,e,n){e.push(t.body);for(var r=t.eqs.length,i=0;i!==r;i++){var o=t.eqs[i];-1===n.indexOf(o)&&n.push(o)}}function f(t,e){return e.id-t.id}i.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}},i.prototype.solve=function(t,e){for(var n=o,r=this.nodePool,i=e.bodies,c=this.equations,u=c.length,d=i.length,v=this.subsolver;r.length<d;)r.push(this.createNode());n.length=d;for(var y=0;y<d;y++)n[y]=r[y];for(y=0;y!==d;y++){var m=n[y];m.body=i[y],m.children.length=0,m.eqs.length=0,m.visited=!1}for(var g=0;g!==u;g++){var _=c[g],b=(y=i.indexOf(_.bi),i.indexOf(_.bj)),w=n[y],x=n[b];w.children.push(x),w.eqs.push(_),x.children.push(w),x.eqs.push(_)}var S,R=0,O=a;v.tolerance=this.tolerance,v.iterations=this.iterations;for(var P=s;S=l(n);){O.length=0,P.bodies.length=0,h(S,p,P.bodies,O);var T=O.length;for(O=O.sort(f),y=0;y!==T;y++)v.addEquation(O[y]);v.solve(t,P),v.removeAllEquations(),R++}return R}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(t,e){var n=function(){};e.exports=n,n.prototype={constructor:n,addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e),this},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0===this._listeners)return this;var n=this._listeners;if(void 0===n[t])return this;var r=n[t].indexOf(e);return-1!==r&&n[t].splice(r,1),this},dispatchEvent:function(t){if(void 0===this._listeners)return this;var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=0,r=e.length;n<r;n++)e[n].call(this,t)}return this}}},{}],50:[function(t,e){var n=t("../collision/AABB"),r=t("../math/Vec3");function i(t){t=t||{},this.root=t.root||null,this.aabb=t.aabb?t.aabb.clone():new n,this.data=[],this.children=[]}function o(t,e){(e=e||{}).root=null,e.aabb=t,i.call(this,e),this.maxDepth=void 0!==e.maxDepth?e.maxDepth:8}e.exports=o,o.prototype=new i,i.prototype.reset=function(){this.children.length=this.data.length=0},i.prototype.insert=function(t,e,n){var r=this.data;if(n=n||0,!this.aabb.contains(t))return!1;var i=this.children;if(n<(this.maxDepth||this.root.maxDepth)){var o=!1;i.length||(this.subdivide(),o=!0);for(var a=0;8!==a;a++)if(i[a].insert(t,e,n+1))return!0;o&&(i.length=0)}return r.push(e),!0};var a=new r;i.prototype.subdivide=function(){var t=this.aabb,e=t.lowerBound,o=t.upperBound,s=this.children;s.push(new i({aabb:new n({lowerBound:new r(0,0,0)})}),new i({aabb:new n({lowerBound:new r(1,0,0)})}),new i({aabb:new n({lowerBound:new r(1,1,0)})}),new i({aabb:new n({lowerBound:new r(1,1,1)})}),new i({aabb:new n({lowerBound:new r(0,1,1)})}),new i({aabb:new n({lowerBound:new r(0,0,1)})}),new i({aabb:new n({lowerBound:new r(1,0,1)})}),new i({aabb:new n({lowerBound:new r(0,1,0)})})),o.vsub(e,a),a.scale(.5,a);for(var c=this.root||this,l=0;8!==l;l++){var u=s[l];u.root=c;var h=u.aabb.lowerBound;h.x*=a.x,h.y*=a.y,h.z*=a.z,h.vadd(e,h),h.vadd(a,u.aabb.upperBound)}},i.prototype.aabbQuery=function(t,e){this.data,this.children;for(var n=[this];n.length;){var r=n.pop();r.aabb.overlaps(t)&&Array.prototype.push.apply(e,r.data),Array.prototype.push.apply(n,r.children)}return e};var s=new n;i.prototype.rayQuery=function(t,e,n){return t.getAABB(s),s.toLocalFrame(e,s),this.aabbQuery(s,n),n},i.prototype.removeEmptyNodes=function(){for(var t=[this];t.length;){for(var e=t.pop(),n=e.children.length-1;n>=0;n--)e.children[n].data.length||e.children.splice(n,1);Array.prototype.push.apply(t,e.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(t,e){function n(){this.objects=[],this.type=Object}e.exports=n,n.prototype.release=function(){for(var t=arguments.length,e=0;e!==t;e++)this.objects.push(arguments[e])},n.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()},n.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}},{}],52:[function(t,e){function n(){this.data={keys:[]}}e.exports=n,n.prototype.get=function(t,e){if(t>e){var n=e;e=t,t=n}return this.data[t+"-"+e]},n.prototype.set=function(t,e,n){if(t>e){var r=e;e=t,t=r}var i=t+"-"+e;this.get(t,e)||this.data.keys.push(i),this.data[i]=n},n.prototype.reset=function(){for(var t=this.data,e=t.keys;e.length>0;)delete t[e.pop()]}},{}],53:[function(t,e){function n(){}e.exports=n,n.defaults=function(t,e){for(var n in t=t||{},e)n in t||(t[n]=e[n]);return t}},{}],54:[function(t,e){e.exports=i;var n=t("../math/Vec3"),r=t("./Pool");function i(){r.call(this),this.type=n}i.prototype=new r,i.prototype.constructObject=function(){return new n}},{"../math/Vec3":30,"./Pool":51}],55:[function(t,e){e.exports=h;var n=t("../collision/AABB"),r=t("../shapes/Shape"),i=t("../collision/Ray"),o=t("../math/Vec3"),a=t("../math/Transform"),s=(t("../shapes/ConvexPolyhedron"),t("../math/Quaternion")),c=(t("../solver/Solver"),t("../utils/Vec3Pool")),l=t("../equations/ContactEquation"),u=t("../equations/FrictionEquation");function h(t){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new c,this.world=t,this.currentContactMaterial=null,this.enableFrictionReduction=!1}h.prototype.createContactEquation=function(t,e,n,r,i,o){var a;this.contactPointPool.length?((a=this.contactPointPool.pop()).bi=t,a.bj=e):a=new l(t,e),a.enabled=t.collisionResponse&&e.collisionResponse&&n.collisionResponse&&r.collisionResponse;var s=this.currentContactMaterial;a.restitution=s.restitution,a.setSpookParams(s.contactEquationStiffness,s.contactEquationRelaxation,this.world.dt);var c=n.material||t.material,u=r.material||e.material;return c&&u&&c.restitution>=0&&u.restitution>=0&&(a.restitution=c.restitution*u.restitution),a.si=i||n,a.sj=o||r,a},h.prototype.createFrictionEquationsFromContact=function(t,e){var n=t.bi,r=t.bj,i=t.si,o=t.sj,a=this.world,s=this.currentContactMaterial,c=s.friction,l=i.material||n.material,h=o.material||r.material;if(l&&h&&l.friction>=0&&h.friction>=0&&(c=l.friction*h.friction),c>0){var p=c*a.gravity.length(),f=n.invMass+r.invMass;f>0&&(f=1/f);var d=this.frictionEquationPool,v=d.length?d.pop():new u(n,r,p*f),y=d.length?d.pop():new u(n,r,p*f);return v.bi=y.bi=n,v.bj=y.bj=r,v.minForce=y.minForce=-p*f,v.maxForce=y.maxForce=p*f,v.ri.copy(t.ri),v.rj.copy(t.rj),y.ri.copy(t.ri),y.rj.copy(t.rj),t.ni.tangents(v.t,y.t),v.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,a.dt),y.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,a.dt),v.enabled=y.enabled=t.enabled,e.push(v,y),!0}return!1};var p=new o,f=new o,d=new o;h.prototype.createFrictionFromAverage=function(t){var e=this.result[this.result.length-1];if(this.createFrictionEquationsFromContact(e,this.frictionResult)&&1!==t){var n=this.frictionResult[this.frictionResult.length-2],r=this.frictionResult[this.frictionResult.length-1];p.setZero(),f.setZero(),d.setZero();for(var i=e.bi,o=(e.bj,0);o!==t;o++)(e=this.result[this.result.length-1-o]).bodyA!==i?(p.vadd(e.ni,p),f.vadd(e.ri,f),d.vadd(e.rj,d)):(p.vsub(e.ni,p),f.vadd(e.rj,f),d.vadd(e.ri,d));var a=1/t;f.scale(a,n.ri),d.scale(a,n.rj),r.ri.copy(n.ri),r.rj.copy(n.rj),p.normalize(),p.tangents(n.t,r.t)}};var v=new o,y=new o,m=new s,g=new s;h.prototype.getContacts=function(t,e,n,r,i,o,a){this.contactPointPool=i,this.frictionEquationPool=a,this.result=r,this.frictionResult=o;for(var s=m,c=g,l=v,u=y,h=0,p=t.length;h!==p;h++){var f=t[h],d=e[h],_=null;f.material&&d.material&&(_=n.getContactMaterial(f.material,d.material)||null);for(var b=0;b<f.shapes.length;b++){f.quaternion.mult(f.shapeOrientations[b],s),f.quaternion.vmult(f.shapeOffsets[b],l),l.vadd(f.position,l);for(var w=f.shapes[b],x=0;x<d.shapes.length;x++){d.quaternion.mult(d.shapeOrientations[x],c),d.quaternion.vmult(d.shapeOffsets[x],u),u.vadd(d.position,u);var S=d.shapes[x];if(!(l.distanceTo(u)>w.boundingSphereRadius+S.boundingSphereRadius)){var R=null;w.material&&S.material&&(R=n.getContactMaterial(w.material,S.material)||null),this.currentContactMaterial=R||_||n.defaultContactMaterial;var O=this[w.type|S.type];O&&(w.type<S.type?O.call(this,w,S,l,u,s,c,f,d,w,S):O.call(this,S,w,u,l,c,s,d,f,w,S))}}}}},h.prototype[r.types.BOX|r.types.BOX]=h.prototype.boxBox=function(t,e,n,r,i,o,a,s){t.convexPolyhedronRepresentation.material=t.material,e.convexPolyhedronRepresentation.material=e.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(t.convexPolyhedronRepresentation,e.convexPolyhedronRepresentation,n,r,i,o,a,s,t,e)},h.prototype[r.types.BOX|r.types.CONVEXPOLYHEDRON]=h.prototype.boxConvex=function(t,e,n,r,i,o,a,s){t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexConvex(t.convexPolyhedronRepresentation,e,n,r,i,o,a,s,t,e)},h.prototype[r.types.BOX|r.types.PARTICLE]=h.prototype.boxParticle=function(t,e,n,r,i,o,a,s){t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexParticle(t.convexPolyhedronRepresentation,e,n,r,i,o,a,s,t,e)},h.prototype[r.types.SPHERE]=h.prototype.sphereSphere=function(t,e,n,r,i,o,a,s){var c=this.createContactEquation(a,s,t,e);r.vsub(n,c.ni),c.ni.normalize(),c.ri.copy(c.ni),c.rj.copy(c.ni),c.ri.mult(t.radius,c.ri),c.rj.mult(-e.radius,c.rj),c.ri.vadd(n,c.ri),c.ri.vsub(a.position,c.ri),c.rj.vadd(r,c.rj),c.rj.vsub(s.position,c.rj),this.result.push(c),this.createFrictionEquationsFromContact(c,this.frictionResult)};var _=new o,b=new o,w=new o;h.prototype[r.types.PLANE|r.types.TRIMESH]=h.prototype.planeTrimesh=function(t,e,n,r,i,s,c,l){var u=new o,h=_;h.set(0,0,1),i.vmult(h,h);for(var p=0;p<e.vertices.length/3;p++){e.getVertex(p,u);var f=new o;f.copy(u),a.pointToWorldFrame(r,s,f,u);var d=b;if(u.vsub(n,d),h.dot(d)<=0){var v=this.createContactEquation(c,l,t,e);v.ni.copy(h);var y=w;h.scale(d.dot(h),y),u.vsub(y,y),v.ri.copy(y),v.ri.vsub(c.position,v.ri),v.rj.copy(u),v.rj.vsub(l.position,v.rj),this.result.push(v),this.createFrictionEquationsFromContact(v,this.frictionResult)}}};var x=new o,S=new o,R=(new o,new o),O=new o,P=new o,T=new o,E=new o,C=new o,A=new o,k=new o,M=new o,j=new o,L=new o,B=new n,z=[];h.prototype[r.types.SPHERE|r.types.TRIMESH]=h.prototype.sphereTrimesh=function(t,e,n,r,o,s,c,l){var u=P,h=T,p=E,f=C,d=A,v=k,y=B,m=O,g=S,_=z;a.pointToLocalFrame(r,s,n,d);var b=t.radius;y.lowerBound.set(d.x-b,d.y-b,d.z-b),y.upperBound.set(d.x+b,d.y+b,d.z+b),e.getTrianglesInAABB(y,_);for(var w=R,F=t.radius*t.radius,I=0;I<_.length;I++)for(var D=0;D<3;D++)e.getVertex(e.indices[3*_[I]+D],w),w.vsub(d,g),g.norm2()<=F&&(m.copy(w),a.pointToWorldFrame(r,s,m,w),w.vsub(n,g),(V=this.createContactEquation(c,l,t,e)).ni.copy(g),V.ni.normalize(),V.ri.copy(V.ni),V.ri.scale(t.radius,V.ri),V.ri.vadd(n,V.ri),V.ri.vsub(c.position,V.ri),V.rj.copy(w),V.rj.vsub(l.position,V.rj),this.result.push(V),this.createFrictionEquationsFromContact(V,this.frictionResult));for(I=0;I<_.length;I++)for(D=0;D<3;D++){e.getVertex(e.indices[3*_[I]+D],u),e.getVertex(e.indices[3*_[I]+(D+1)%3],h),h.vsub(u,p),d.vsub(h,v);var q=v.dot(p);d.vsub(u,v);var N=v.dot(p);if(N>0&&q<0&&(d.vsub(u,v),f.copy(p),f.normalize(),N=v.dot(f),f.scale(N,v),v.vadd(u,v),(Y=v.distanceTo(d))<t.radius)){var V=this.createContactEquation(c,l,t,e);v.vsub(d,V.ni),V.ni.normalize(),V.ni.scale(t.radius,V.ri),a.pointToWorldFrame(r,s,v,v),v.vsub(l.position,V.rj),a.vectorToWorldFrame(s,V.ni,V.ni),a.vectorToWorldFrame(s,V.ri,V.ri),this.result.push(V),this.createFrictionEquationsFromContact(V,this.frictionResult)}}for(var W=M,U=j,H=L,G=x,X=(I=0,_.length);I!==X;I++){e.getTriangleVertices(_[I],W,U,H),e.getNormal(_[I],G),d.vsub(W,v);var Y=v.dot(G);G.scale(Y,v),d.vsub(v,v),Y=v.distanceTo(d),i.pointInTriangle(v,W,U,H)&&Y<t.radius&&(V=this.createContactEquation(c,l,t,e),v.vsub(d,V.ni),V.ni.normalize(),V.ni.scale(t.radius,V.ri),a.pointToWorldFrame(r,s,v,v),v.vsub(l.position,V.rj),a.vectorToWorldFrame(s,V.ni,V.ni),a.vectorToWorldFrame(s,V.ri,V.ri),this.result.push(V),this.createFrictionEquationsFromContact(V,this.frictionResult))}_.length=0};var F=new o,I=new o;h.prototype[r.types.SPHERE|r.types.PLANE]=h.prototype.spherePlane=function(t,e,n,r,i,o,a,s){var c=this.createContactEquation(a,s,t,e);if(c.ni.set(0,0,1),o.vmult(c.ni,c.ni),c.ni.negate(c.ni),c.ni.normalize(),c.ni.mult(t.radius,c.ri),n.vsub(r,F),c.ni.mult(c.ni.dot(F),I),F.vsub(I,c.rj),-F.dot(c.ni)<=t.radius){var l=c.ri,u=c.rj;l.vadd(n,l),l.vsub(a.position,l),u.vadd(r,u),u.vsub(s.position,u),this.result.push(c),this.createFrictionEquationsFromContact(c,this.frictionResult)}};var D=new o,q=new o,N=new o;function V(t,e,n){for(var r=null,i=t.length,o=0;o!==i;o++){var a=t[o],s=D;t[(o+1)%i].vsub(a,s);var c=q;s.cross(e,c);var l=N;n.vsub(a,l);var u=c.dot(l);if(!(null===r||u>0&&!0===r||u<=0&&!1===r))return!1;null===r&&(r=u>0)}return!0}var W=new o,U=new o,H=new o,G=new o,X=[new o,new o,new o,new o,new o,new o],Y=new o,K=new o,Q=new o,Z=new o;h.prototype[r.types.SPHERE|r.types.BOX]=h.prototype.sphereBox=function(t,e,n,r,i,o,a,s){var c=this.v3pool,l=X;n.vsub(r,W),e.getSideNormals(l,o);for(var u=t.radius,h=!1,p=K,f=Q,d=Z,v=null,y=0,m=0,g=0,_=null,b=0,w=l.length;b!==w&&!1===h;b++){var x=U;x.copy(l[b]);var S=x.norm();x.normalize();var R=W.dot(x);if(R<S+u&&R>0){var O=H,P=G;O.copy(l[(b+1)%3]),P.copy(l[(b+2)%3]);var T=O.norm(),E=P.norm();O.normalize(),P.normalize();var C=W.dot(O),A=W.dot(P);if(C<T&&C>-T&&A<E&&A>-E){var k=Math.abs(R-S-u);(null===_||k<_)&&(_=k,m=C,g=A,v=S,p.copy(x),f.copy(O),d.copy(P),y++)}}}if(y){h=!0;var M=this.createContactEquation(a,s,t,e);p.mult(-u,M.ri),M.ni.copy(p),M.ni.negate(M.ni),p.mult(v,p),f.mult(m,f),p.vadd(f,p),d.mult(g,d),p.vadd(d,M.rj),M.ri.vadd(n,M.ri),M.ri.vsub(a.position,M.ri),M.rj.vadd(r,M.rj),M.rj.vsub(s.position,M.rj),this.result.push(M),this.createFrictionEquationsFromContact(M,this.frictionResult)}for(var j=c.get(),L=Y,B=0;2!==B&&!h;B++)for(var z=0;2!==z&&!h;z++)for(var F=0;2!==F&&!h;F++)j.set(0,0,0),B?j.vadd(l[0],j):j.vsub(l[0],j),z?j.vadd(l[1],j):j.vsub(l[1],j),F?j.vadd(l[2],j):j.vsub(l[2],j),r.vadd(j,L),L.vsub(n,L),L.norm2()<u*u&&(h=!0,(M=this.createContactEquation(a,s,t,e)).ri.copy(L),M.ri.normalize(),M.ni.copy(M.ri),M.ri.mult(u,M.ri),M.rj.copy(j),M.ri.vadd(n,M.ri),M.ri.vsub(a.position,M.ri),M.rj.vadd(r,M.rj),M.rj.vsub(s.position,M.rj),this.result.push(M),this.createFrictionEquationsFromContact(M,this.frictionResult));c.release(j),j=null;var I=c.get(),D=c.get(),q=(M=c.get(),c.get()),N=(k=c.get(),l.length);for(B=0;B!==N&&!h;B++)for(z=0;z!==N&&!h;z++)if(B%3!=z%3){l[z].cross(l[B],I),I.normalize(),l[B].vadd(l[z],D),M.copy(n),M.vsub(D,M),M.vsub(r,M);var V=M.dot(I);for(I.mult(V,q),F=0;F===B%3||F===z%3;)F++;k.copy(n),k.vsub(q,k),k.vsub(D,k),k.vsub(r,k);var J=Math.abs(V),$=k.norm();if(J<l[F].norm()&&$<u){h=!0;var tt=this.createContactEquation(a,s,t,e);D.vadd(q,tt.rj),tt.rj.copy(tt.rj),k.negate(tt.ni),tt.ni.normalize(),tt.ri.copy(tt.rj),tt.ri.vadd(r,tt.ri),tt.ri.vsub(n,tt.ri),tt.ri.normalize(),tt.ri.mult(u,tt.ri),tt.ri.vadd(n,tt.ri),tt.ri.vsub(a.position,tt.ri),tt.rj.vadd(r,tt.rj),tt.rj.vsub(s.position,tt.rj),this.result.push(tt),this.createFrictionEquationsFromContact(tt,this.frictionResult)}}c.release(I,D,M,q,k)};var J=new o,$=new o,tt=new o,et=new o,nt=new o,rt=new o,it=new o,ot=new o,at=new o,st=new o;h.prototype[r.types.SPHERE|r.types.CONVEXPOLYHEDRON]=h.prototype.sphereConvex=function(t,e,n,r,i,o,a,s){var c=this.v3pool;n.vsub(r,J);for(var l=e.faceNormals,u=e.faces,h=e.vertices,p=t.radius,f=0;f!==h.length;f++){var d=h[f],v=nt;o.vmult(d,v),r.vadd(v,v);var y=et;if(v.vsub(n,y),y.norm2()<p*p)return m=!0,(k=this.createContactEquation(a,s,t,e)).ri.copy(y),k.ri.normalize(),k.ni.copy(k.ri),k.ri.mult(p,k.ri),v.vsub(r,k.rj),k.ri.vadd(n,k.ri),k.ri.vsub(a.position,k.ri),k.rj.vadd(r,k.rj),k.rj.vsub(s.position,k.rj),this.result.push(k),void this.createFrictionEquationsFromContact(k,this.frictionResult)}for(var m=!1,g=(f=0,u.length);f!==g&&!1===m;f++){var _=l[f],b=u[f],w=rt;o.vmult(_,w);var x=it;o.vmult(h[b[0]],x),x.vadd(r,x);var S=ot;w.mult(-p,S),n.vadd(S,S);var R=at;S.vsub(x,R);var O=R.dot(w),P=st;if(n.vsub(x,P),O<0&&P.dot(w)>0){for(var T=[],E=0,C=b.length;E!==C;E++){var A=c.get();o.vmult(h[b[E]],A),r.vadd(A,A),T.push(A)}if(V(T,w,n)){m=!0;var k=this.createContactEquation(a,s,t,e);w.mult(-p,k.ri),w.negate(k.ni);var M=c.get();w.mult(-O,M);var j=c.get();w.mult(-p,j),n.vsub(r,k.rj),k.rj.vadd(j,k.rj),k.rj.vadd(M,k.rj),k.rj.vadd(r,k.rj),k.rj.vsub(s.position,k.rj),k.ri.vadd(n,k.ri),k.ri.vsub(a.position,k.ri),c.release(M),c.release(j),this.result.push(k),this.createFrictionEquationsFromContact(k,this.frictionResult),E=0;for(var L=T.length;E!==L;E++)c.release(T[E]);return}for(E=0;E!==b.length;E++){var B=c.get(),z=c.get();o.vmult(h[b[(E+1)%b.length]],B),o.vmult(h[b[(E+2)%b.length]],z),r.vadd(B,B),r.vadd(z,z);var F=$;z.vsub(B,F);var I=tt;F.unit(I);var D=c.get(),q=c.get();n.vsub(B,q);var N=q.dot(I);I.mult(N,D),D.vadd(B,D);var W=c.get();if(D.vsub(n,W),N>0&&N*N<F.norm2()&&W.norm2()<p*p){for(k=this.createContactEquation(a,s,t,e),D.vsub(r,k.rj),D.vsub(n,k.ni),k.ni.normalize(),k.ni.mult(p,k.ri),k.rj.vadd(r,k.rj),k.rj.vsub(s.position,k.rj),k.ri.vadd(n,k.ri),k.ri.vsub(a.position,k.ri),this.result.push(k),this.createFrictionEquationsFromContact(k,this.frictionResult),E=0,L=T.length;E!==L;E++)c.release(T[E]);return c.release(B),c.release(z),c.release(D),c.release(W),void c.release(q)}c.release(B),c.release(z),c.release(D),c.release(W),c.release(q)}for(E=0,L=T.length;E!==L;E++)c.release(T[E])}}},new o,new o,h.prototype[r.types.PLANE|r.types.BOX]=h.prototype.planeBox=function(t,e,n,r,i,o,a,s){e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.planeConvex(t,e.convexPolyhedronRepresentation,n,r,i,o,a,s)};var ct=new o,lt=new o,ut=new o,ht=new o;h.prototype[r.types.PLANE|r.types.CONVEXPOLYHEDRON]=h.prototype.planeConvex=function(t,e,n,r,i,o,a,s){var c=ct,l=lt;l.set(0,0,1),i.vmult(l,l);for(var u=0,h=ut,p=0;p!==e.vertices.length;p++)if(c.copy(e.vertices[p]),o.vmult(c,c),r.vadd(c,c),c.vsub(n,h),l.dot(h)<=0){var f=this.createContactEquation(a,s,t,e),d=ht;l.mult(l.dot(h),d),c.vsub(d,d),d.vsub(n,f.ri),f.ni.copy(l),c.vsub(r,f.rj),f.ri.vadd(n,f.ri),f.ri.vsub(a.position,f.ri),f.rj.vadd(r,f.rj),f.rj.vsub(s.position,f.rj),this.result.push(f),u++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(f,this.frictionResult)}this.enableFrictionReduction&&u&&this.createFrictionFromAverage(u)};var pt=new o,ft=new o;h.prototype[r.types.CONVEXPOLYHEDRON]=h.prototype.convexConvex=function(t,e,n,r,i,o,a,s,c,l,u,h){var p=pt;if(!(n.distanceTo(r)>t.boundingSphereRadius+e.boundingSphereRadius)&&t.findSeparatingAxis(e,n,i,r,o,p,u,h)){var f=[],d=ft;t.clipAgainstHull(n,i,e,r,o,p,-100,100,f);for(var v=0,y=0;y!==f.length;y++){var m=this.createContactEquation(a,s,t,e,c,l),g=m.ri,_=m.rj;p.negate(m.ni),f[y].normal.negate(d),d.mult(f[y].depth,d),f[y].point.vadd(d,g),_.copy(f[y].point),g.vsub(n,g),_.vsub(r,_),g.vadd(n,g),g.vsub(a.position,g),_.vadd(r,_),_.vsub(s.position,_),this.result.push(m),v++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(m,this.frictionResult)}this.enableFrictionReduction&&v&&this.createFrictionFromAverage(v)}};var dt=new o,vt=new o,yt=new o;h.prototype[r.types.PLANE|r.types.PARTICLE]=h.prototype.planeParticle=function(t,e,n,r,i,o,a,s){var c=dt;c.set(0,0,1),a.quaternion.vmult(c,c);var l=vt;if(r.vsub(a.position,l),c.dot(l)<=0){var u=this.createContactEquation(s,a,e,t);u.ni.copy(c),u.ni.negate(u.ni),u.ri.set(0,0,0);var h=yt;c.mult(c.dot(r),h),r.vsub(h,h),u.rj.copy(h),this.result.push(u),this.createFrictionEquationsFromContact(u,this.frictionResult)}};var mt=new o;h.prototype[r.types.PARTICLE|r.types.SPHERE]=h.prototype.sphereParticle=function(t,e,n,r,i,o,a,s){var c=mt;if(c.set(0,0,1),r.vsub(n,c),c.norm2()<=t.radius*t.radius){var l=this.createContactEquation(s,a,e,t);c.normalize(),l.rj.copy(c),l.rj.mult(t.radius,l.rj),l.ni.copy(c),l.ni.negate(l.ni),l.ri.set(0,0,0),this.result.push(l),this.createFrictionEquationsFromContact(l,this.frictionResult)}};var gt=new s,_t=new o,bt=(new o,new o),wt=new o,xt=new o;h.prototype[r.types.PARTICLE|r.types.CONVEXPOLYHEDRON]=h.prototype.convexParticle=function(t,e,n,r,i,o,a,s){var c=-1,l=bt,u=xt,h=null,p=_t;if(p.copy(r),p.vsub(n,p),i.conjugate(gt),gt.vmult(p,p),t.pointIsInside(p)){t.worldVerticesNeedsUpdate&&t.computeWorldVertices(n,i),t.worldFaceNormalsNeedsUpdate&&t.computeWorldFaceNormals(i);for(var f=0,d=t.faces.length;f!==d;f++){var v=[t.worldVertices[t.faces[f][0]]],y=t.worldFaceNormals[f];r.vsub(v[0],wt);var m=-y.dot(wt);(null===h||Math.abs(m)<Math.abs(h))&&(h=m,c=f,l.copy(y))}if(-1!==c){var g=this.createContactEquation(s,a,e,t);l.mult(h,u),u.vadd(r,u),u.vsub(n,u),g.rj.copy(u),l.negate(g.ni),g.ri.set(0,0,0);var _=g.ri,b=g.rj;_.vadd(r,_),_.vsub(s.position,_),b.vadd(n,b),b.vsub(a.position,b),this.result.push(g),this.createFrictionEquationsFromContact(g,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}},h.prototype[r.types.BOX|r.types.HEIGHTFIELD]=h.prototype.boxHeightfield=function(t,e,n,r,i,o,a,s){t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexHeightfield(t.convexPolyhedronRepresentation,e,n,r,i,o,a,s)};var St=new o,Rt=new o,Ot=[0];h.prototype[r.types.CONVEXPOLYHEDRON|r.types.HEIGHTFIELD]=h.prototype.convexHeightfield=function(t,e,n,r,i,o,s,c){var l=e.data,u=e.elementSize,h=t.boundingSphereRadius,p=Rt,f=Ot,d=St;a.pointToLocalFrame(r,o,n,d);var v=Math.floor((d.x-h)/u)-1,y=Math.ceil((d.x+h)/u)+1,m=Math.floor((d.y-h)/u)-1,g=Math.ceil((d.y+h)/u)+1;if(!(y<0||g<0||v>l.length||m>l[0].length)){v<0&&(v=0),y<0&&(y=0),m<0&&(m=0),g<0&&(g=0),v>=l.length&&(v=l.length-1),y>=l.length&&(y=l.length-1),g>=l[0].length&&(g=l[0].length-1),m>=l[0].length&&(m=l[0].length-1);var _=[];e.getRectMinMax(v,m,y,g,_);var b=_[0],w=_[1];if(!(d.z-h>w||d.z+h<b))for(var x=v;x<y;x++)for(var S=m;S<g;S++)e.getConvexTrianglePillar(x,S,!1),a.pointToWorldFrame(r,o,e.pillarOffset,p),n.distanceTo(p)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&this.convexConvex(t,e.pillarConvex,n,p,i,o,s,c,null,null,f,null),e.getConvexTrianglePillar(x,S,!0),a.pointToWorldFrame(r,o,e.pillarOffset,p),n.distanceTo(p)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&this.convexConvex(t,e.pillarConvex,n,p,i,o,s,c,null,null,f,null)}};var Pt=new o,Tt=new o;h.prototype[r.types.SPHERE|r.types.HEIGHTFIELD]=h.prototype.sphereHeightfield=function(t,e,n,r,i,o,s,c){var l=e.data,u=t.radius,h=e.elementSize,p=Tt,f=Pt;a.pointToLocalFrame(r,o,n,f);var d=Math.floor((f.x-u)/h)-1,v=Math.ceil((f.x+u)/h)+1,y=Math.floor((f.y-u)/h)-1,m=Math.ceil((f.y+u)/h)+1;if(!(v<0||m<0||d>l.length||m>l[0].length)){d<0&&(d=0),v<0&&(v=0),y<0&&(y=0),m<0&&(m=0),d>=l.length&&(d=l.length-1),v>=l.length&&(v=l.length-1),m>=l[0].length&&(m=l[0].length-1),y>=l[0].length&&(y=l[0].length-1);var g=[];e.getRectMinMax(d,y,v,m,g);var _=g[0],b=g[1];if(!(f.z-u>b||f.z+u<_))for(var w=this.result,x=d;x<v;x++)for(var S=y;S<m;S++){var R=w.length;if(e.getConvexTrianglePillar(x,S,!1),a.pointToWorldFrame(r,o,e.pillarOffset,p),n.distanceTo(p)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&this.sphereConvex(t,e.pillarConvex,n,p,i,o,s,c),e.getConvexTrianglePillar(x,S,!0),a.pointToWorldFrame(r,o,e.pillarOffset,p),n.distanceTo(p)<e.pillarConvex.boundingSphereRadius+t.boundingSphereRadius&&this.sphereConvex(t,e.pillarConvex,n,p,i,o,s,c),w.length-R>2)return}}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(t,e){e.exports=m;var n=t("../shapes/Shape"),r=t("../math/Vec3"),i=t("../math/Quaternion"),o=t("../solver/GSSolver"),a=(t("../utils/Vec3Pool"),t("../equations/ContactEquation"),t("../equations/FrictionEquation"),t("./Narrowphase")),s=t("../utils/EventTarget"),c=t("../collision/ArrayCollisionMatrix"),l=t("../material/Material"),u=t("../material/ContactMaterial"),h=t("../objects/Body"),p=t("../utils/TupleDictionary"),f=t("../collision/RaycastResult"),d=t("../collision/AABB"),v=t("../collision/Ray"),y=t("../collision/NaiveBroadphase");function m(){s.apply(this),this.dt=-1,this.allowSleep=!1,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=0,this.quatNormalizeFast=!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new r,this.broadphase=new y,this.bodies=[],this.solver=new o,this.constraints=[],this.narrowphase=new a(this),this.collisionMatrix=new c,this.collisionMatrixPrevious=new c,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new p,this.defaultMaterial=new l("default"),this.defaultContactMaterial=new u(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null}}m.prototype=new s,new d;var g=new v;if(m.prototype.getContactMaterial=function(t,e){return this.contactMaterialTable.get(t.id,e.id)},m.prototype.numObjects=function(){return this.bodies.length},m.prototype.collisionMatrixTick=function(){var t=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=t,this.collisionMatrix.reset()},m.prototype.add=m.prototype.addBody=function(t){-1===this.bodies.indexOf(t)&&(t.index=this.bodies.length,this.bodies.push(t),t.world=this,t.initPosition.copy(t.position),t.initVelocity.copy(t.velocity),t.timeLastSleepy=this.time,t instanceof h&&(t.initAngularVelocity.copy(t.angularVelocity),t.initQuaternion.copy(t.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=t,this.dispatchEvent(this.addBodyEvent))},m.prototype.addConstraint=function(t){this.constraints.push(t)},m.prototype.removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e&&this.constraints.splice(e,1)},m.prototype.rayTest=function(t,e,n){n instanceof f?this.raycastClosest(t,e,{skipBackfaces:!0},n):this.raycastAll(t,e,{skipBackfaces:!0},n)},m.prototype.raycastAll=function(t,e,n,r){return n.mode=v.ALL,n.from=t,n.to=e,n.callback=r,g.intersectWorld(this,n)},m.prototype.raycastAny=function(t,e,n,r){return n.mode=v.ANY,n.from=t,n.to=e,n.result=r,g.intersectWorld(this,n)},m.prototype.raycastClosest=function(t,e,n,r){return n.mode=v.CLOSEST,n.from=t,n.to=e,n.result=r,g.intersectWorld(this,n)},m.prototype.remove=function(t){t.world=null;var e=this.bodies.length-1,n=this.bodies,r=n.indexOf(t);if(-1!==r){n.splice(r,1);for(var i=0;i!==n.length;i++)n[i].index=i;this.collisionMatrix.setNumObjects(e),this.removeBodyEvent.body=t,this.dispatchEvent(this.removeBodyEvent)}},m.prototype.removeBody=m.prototype.remove,m.prototype.addMaterial=function(t){this.materials.push(t)},m.prototype.addContactMaterial=function(t){this.contactmaterials.push(t),this.contactMaterialTable.set(t.materials[0].id,t.materials[1].id,t)},"undefined"==typeof performance&&(performance={}),!performance.now){var _=Date.now();performance.timing&&performance.timing.navigationStart&&(_=performance.timing.navigationStart),performance.now=function(){return Date.now()-_}}var b=new r;m.prototype.step=function(t,e,n){if(n=n||10,0===(e=e||0))this.internalStep(t),this.time+=t;else{var r=Math.floor((this.time+e)/t)-Math.floor(this.time/t);r=Math.min(r,n);for(var i=performance.now(),o=0;o!==r&&(this.internalStep(t),!(performance.now()-i>1e3*t));o++);this.time+=e;for(var a=this.time%t/t,s=b,c=this.bodies,l=0;l!==c.length;l++){var u=c[l];u.type!==h.STATIC&&u.sleepState!==h.SLEEPING?(u.position.vsub(u.previousPosition,s),s.scale(a,s),u.position.vadd(s,u.interpolatedPosition)):(u.interpolatedPosition.copy(u.position),u.interpolatedQuaternion.copy(u.quaternion))}}};var w={type:"postStep"},x={type:"preStep"},S={type:"collide",body:null,contact:null},R=[],O=[],P=[],T=[],E=(new r,new r,new r,new r,new r,new r,new r,new r,new r,new i,new i),C=new i,A=new r;m.prototype.internalStep=function(t){this.dt=t;var e,r=this.contacts,i=P,o=T,a=this.numObjects(),s=this.bodies,c=this.solver,l=this.gravity,u=this.doProfiling,p=this.profile,f=h.DYNAMIC,d=this.constraints,v=O,y=(l.norm(),l.x),m=l.y,g=l.z,_=0;for(u&&(e=performance.now()),_=0;_!==a;_++)if((q=s[_]).type&f){var b=q.force,k=q.mass;b.x+=k*y,b.y+=k*m,b.z+=k*g}_=0;for(var M=this.subsystems.length;_!==M;_++)this.subsystems[_].update();u&&(e=performance.now()),i.length=0,o.length=0,this.broadphase.collisionPairs(this,i,o),u&&(p.broadphase=performance.now()-e);var j=d.length;for(_=0;_!==j;_++)if(!(V=d[_]).collideConnected)for(var L=i.length-1;L>=0;L-=1)(V.bodyA===i[L]&&V.bodyB===o[L]||V.bodyB===i[L]&&V.bodyA===o[L])&&(i.splice(L,1),o.splice(L,1));this.collisionMatrixTick(),u&&(e=performance.now());var B=R,z=r.length;for(_=0;_!==z;_++)B.push(r[_]);r.length=0;var F=this.frictionEquations.length;for(_=0;_!==F;_++)v.push(this.frictionEquations[_]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(i,o,this,r,B,this.frictionEquations,v),u&&(p.narrowphase=performance.now()-e),u&&(e=performance.now()),_=0;_<this.frictionEquations.length;_++)c.addEquation(this.frictionEquations[_]);for(var I=r.length,D=0;D!==I;D++){var q=(V=r[D]).bi,N=V.bj;V.si,V.sj,(q.material&&N.material&&this.getContactMaterial(q.material,N.material)||this.defaultContactMaterial).friction,q.material&&N.material&&(q.material.friction>=0&&N.material.friction>=0&&(q.material.friction,N.material.friction),q.material.restitution>=0&&N.material.restitution>=0&&(V.restitution=q.material.restitution*N.material.restitution)),c.addEquation(V),q.allowSleep&&q.type===h.DYNAMIC&&q.sleepState===h.SLEEPING&&N.sleepState===h.AWAKE&&N.type!==h.STATIC&&N.velocity.norm2()+N.angularVelocity.norm2()>=2*Math.pow(N.sleepSpeedLimit,2)&&(q._wakeUpAfterNarrowphase=!0),N.allowSleep&&N.type===h.DYNAMIC&&N.sleepState===h.SLEEPING&&q.sleepState===h.AWAKE&&q.type!==h.STATIC&&q.velocity.norm2()+q.angularVelocity.norm2()>=2*Math.pow(q.sleepSpeedLimit,2)&&(N._wakeUpAfterNarrowphase=!0),this.collisionMatrix.set(q,N,!0),this.collisionMatrixPrevious.get(q,N)||(S.body=N,S.contact=V,q.dispatchEvent(S),S.body=q,N.dispatchEvent(S))}for(u&&(p.makeContactConstraints=performance.now()-e,e=performance.now()),_=0;_!==a;_++)(q=s[_])._wakeUpAfterNarrowphase&&(q.wakeUp(),q._wakeUpAfterNarrowphase=!1);for(j=d.length,_=0;_!==j;_++){var V;(V=d[_]).update(),L=0;for(var W=V.equations.length;L!==W;L++){var U=V.equations[L];c.addEquation(U)}}c.solve(t,this),u&&(p.solve=performance.now()-e),c.removeAllEquations();var H=Math.pow;for(_=0;_!==a;_++)if((q=s[_]).type&f){var G=H(1-q.linearDamping,t),X=q.velocity;X.mult(G,X);var Y=q.angularVelocity;if(Y){var K=H(1-q.angularDamping,t);Y.mult(K,Y)}}for(this.dispatchEvent(x),_=0;_!==a;_++)(q=s[_]).preStep&&q.preStep.call(q);u&&(e=performance.now());var Q=E,Z=C,J=this.stepnumber,$=h.DYNAMIC|h.KINEMATIC,tt=J%(this.quatNormalizeSkip+1)==0,et=this.quatNormalizeFast,nt=.5*t;for(n.types.PLANE,n.types.CONVEXPOLYHEDRON,_=0;_!==a;_++){var rt=s[_],it=rt.force,ot=rt.torque;if(rt.type&$&&rt.sleepState!==h.SLEEPING){var at=rt.velocity,st=rt.angularVelocity,ct=rt.position,lt=rt.quaternion,ut=rt.invMass,ht=rt.invInertiaWorld;at.x+=it.x*ut*t,at.y+=it.y*ut*t,at.z+=it.z*ut*t,rt.angularVelocity&&(ht.vmult(ot,A),A.mult(t,A),A.vadd(st,st)),ct.x+=at.x*t,ct.y+=at.y*t,ct.z+=at.z*t,rt.angularVelocity&&(Q.set(st.x,st.y,st.z,0),Q.mult(lt,Z),lt.x+=nt*Z.x,lt.y+=nt*Z.y,lt.z+=nt*Z.z,lt.w+=nt*Z.w,tt&&(et?lt.normalizeFast():lt.normalize())),rt.aabb&&(rt.aabbNeedsUpdate=!0),rt.updateInertiaWorld&&rt.updateInertiaWorld()}}for(this.clearForces(),this.broadphase.dirty=!0,u&&(p.integrate=performance.now()-e),this.time+=t,this.stepnumber+=1,this.dispatchEvent(w),_=0;_!==a;_++){var pt=(q=s[_]).postStep;pt&&pt.call(q)}if(this.allowSleep)for(_=0;_!==a;_++)s[_].sleepTick(this.time)},m.prototype.clearForces=function(){for(var t=this.bodies,e=t.length,n=0;n!==e;n++){var r=t[n];r.force,r.torque,r.force.set(0,0,0),r.torque.set(0,0,0)}}},{"../collision/AABB":3,"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)},113:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n(6),i=n.n(r),o=n(0);function a(t){const e=function(t){if("container"in t)return{width:t.container.clientWidth,height:t.container.clientHeight};return{width:t.width,height:t.height}}(t),n=function(t){const{source:e}=t;if(e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};return{width:e.width,height:e.height}}(t);let r;return"cover"===t.rule?r=function(t,e,n){let r=e.width*s(t),i=n.height*r/n.width;i/s(t)<e.height&&(i=e.height*s(t),r=n.width*i/n.height);const o=(e.width-r)/2,a=(e.height-i)/2;return{width:r,height:i,x:o,y:a}}(t,e,n):"contain"===t.rule?r=function(t,e,n){let r=0,i=0;n.width>n.height?(r=e.width*s(t),i=n.height*r/n.width):n.height>=n.width&&(i=e.height*s(t),r=n.width*i/n.height);const o=(e.width-r)/2,a=(e.height-i)/2;return{width:r,height:i,x:o,y:a}}(t,e,n):"top-left"===t.rule?r=function(t,e){const n=e.width*s(t),r=e.height*s(t);return{width:n,height:r,x:0,y:0}}(t,n):"top-right"===t.rule?r=function(t,e,n){const r=n.width*s(t),i=n.height*s(t),o=e.width-n.width;return{width:r,height:i,x:o,y:0}}(t,e,n):"bottom-left"===t.rule?r=function(t,e,n){const r=n.width*s(t),i=n.height*s(t),o=e.height-n.height;return{width:r,height:i,x:0,y:o}}(t,e,n):"bottom-right"===t.rule?r=function(t,e,n){const r=n.width*s(t),i=n.height*s(t),o=e.width-n.width,a=e.height-n.height;return{width:r,height:i,x:o,y:a}}(t,e,n):"center"===t.rule&&(r=function(t,e,n){const r=n.width*s(t),i=n.height*s(t),o=(e.width-n.width)/2,a=(e.height-n.height)/2;return{width:r,height:i,x:o,y:a}}(t,e,n)),Object.assign(r,{sourceWidth:n.width,sourceHeight:n.height})}function s(t){return void 0!==t.scale?t.scale:1}var c=n(34),l=n(24),u=n(53);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=m(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m(t);if(e){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y(this,n)}}function y(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(c,t);var e,n,r,s=v(c);function c(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),s.call(this,t)}return e=c,(n=[{key:"_extra",value:function(){f(m(c.prototype),"_extra",this).call(this),this._resource=!1,this._loaded=!1,this._prop.uniformsData.push({key:"u_video_repeatX",value:1,type:"float"}),this._prop.uniformsData.push({key:"u_video_repeatY",value:1,type:"float"}),this._isVideo=!1}},{key:"on",value:function(t,e,n){return f(m(c.prototype),"on",this).call(this,t,e,n)}},{key:"_createTHREE",value:function(){this._loadRes(f(m(c.prototype),"_createTHREE",this).bind(this))}},{key:"_loadRes",value:function(t){var e=this,n=this._prop.resource;n?(this._resource=n,this._resLoaded(t)):Object(l.a)(this._prop.src,(function(n){e._resource=n,e._resLoaded(t)}),(function(){e._resource=!1,e._prop.materialProp.color=5855577,e._resLoaded(t)}))}},{key:"_resLoaded",value:function(t){this._loaded||this.lbt("loaded"),this._loaded=!0,t()}},{key:"_createTexture",value:function(){var t,e=this,n=this._resource;n instanceof HTMLVideoElement?(this._isVideo=!0,(t=new o.Eb(n)).mapping=o.o,n.addEventListener("loadedmetadata",(function(){e.resize()}))):n instanceof HTMLCanvasElement?(t=new o.i(n)).mapping=o.o:n instanceof HTMLImageElement?t=this._prop.posRule?this._createCanvasTexture(n):new o.Eb(n):this._texture=void 0,t&&(t.needsUpdate=!0,t.magFilter=o.I,t.minFilter=o.I,this._texture=t)}},{key:"_createCanvasTexture",value:function(t){var e=this;this._ctx2D=new u.a(this._prop.el),this._ctx2D.updateSize(),this._drawCanvasTexture(t);var n=new o.i(this._ctx2D.canvas);return this._threeEvents.push(this._prop.three.on("resize",(function(){e._ctx2D.updateSize(),e._drawCanvasTexture(t),n.needsUpdate=!0}))),n}},{key:"_drawCanvasTexture",value:function(t){var e=this._ctx2D,n=e.width,r=e.height,i=e.ctx;i.clearRect(0,0,n,r);var o=a({source:t,rule:this.prop.posRule||"top-left",scale:1,width:n,height:r});i.drawImage(t,0,0,o.sourceWidth,o.sourceHeight,o.x,o.y,o.width,o.height)}},{key:"resize",value:function(){f(m(c.prototype),"resize",this).call(this),this._resizeVideoTexture()}},{key:"_resizeVideoTexture",value:function(){var t=this._prop.resource;if(t instanceof HTMLVideoElement){var e=this.texture;if(e){var n,r,i=this._startSize[0]*this._scale[0],o=this._startSize[1]*this._scale[1],a=t.videoWidth,s=t.videoHeight;(n=i*s/(o*a))>1?(n=1,r=o*a/(i*s),e.repeat.set(n,r),e.offset.y=(r-1)/2*-1):(n=i*s/(o*a),r=1,e.repeat.set(n,r),e.offset.x=(n-1)/2*-1),this._material.userData.u_video_repeatX.value=n,this._material.userData.u_video_repeatY.value=r}}}},{key:"_renderTexture",value:function(){f(m(c.prototype),"_renderTexture",this).call(this),this._isVideo&&this._renderedFrames%2==0&&this._texture&&(this._texture.needsUpdate=!0)}},{key:"destroy",value:function(){if(this.prop.resource instanceof HTMLVideoElement)try{this.prop.resource.pause()}catch(t){}f(m(c.prototype),"destroy",this).call(this)}},{key:"defaultProp",get:function(){return i()(f(m(c.prototype),"defaultProp",this),{src:"",resource:!1,posRule:!1})}},{key:"prop",get:function(){return this._prop}},{key:"loaded",get:function(){return this._loaded}}])&&p(e.prototype,n),r&&p(e,r),c}(c.a)},118:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nfloat dist(vec2 p0, vec2 pf) {\n    return sqrt((pf.x-p0.x)*(pf.x-p0.x)+(pf.y-p0.y)*(pf.y-p0.y));\n}\n\n"},119:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n#ifndef HALF_PI\n#define HALF_PI 1.5707963267948966\n#endif\n\nfloat easing(float t) {\n    return sin(t * HALF_PI);\n}\n\nvec2 pinch(vec2 coord, vec2 center, float strength, float radius) {\n\n    float scale = strength;\n    coord -= vec2(0.5);\n    coord *= 1. + scale / 2.;\n    coord += vec2(0.5);\n\n    coord -= center;\n    float distanceBulge = length(coord);\n    float power = strength; // * pow(easing(distanceBulge), .5);\n\n    if (distanceBulge < radius) {\n        float percent = distanceBulge / radius;\n        if (power > 0.0) {\n            coord *= mix(1.0, smoothstep(0.0, radius / distanceBulge, percent), power * 0.75);\n        } else {\n            coord *= mix(1.0, pow(percent, 1.0 + power * 0.75) * radius / distanceBulge, 1.0 - percent);\n        }\n    }\n    coord += center;\n\n    return coord;\n\n}\n\n"},120:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvec4 blend(vec4 bg,vec4 fg){\n    vec3 bgm=bg.rgb*bg.a;\n    vec3 fgm=fg.rgb*fg.a;\n    float ia=1.0-fg.a;\n    float a=(fg.a + bg.a * ia);\n    vec3 rgb;\n    if (a!=0.0) {\n        rgb=(fgm + bgm * ia) / a;\n    }\n    else {\n        rgb=vec3(0.0,0.0,0.0);\n    }\n    return vec4(rgb,a);\n}\n\n"},123:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var r=n(114),i=n.n(r),o=n(1),a=n(106),s=n(108),c=n(109),l=n(48);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=m(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m(t);if(e){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y(this,n)}}function y(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(u,t);var e,n,r,a=v(u);function u(){var t;return h(this,u),(t=a.apply(this,arguments))._text=!1,t}return e=u,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"_connectedCallback",value:function(){f(m(u.prototype),"_connectedCallback",this).call(this),Object(s.a)(this);var t=this.children;if(!(t.length<1)){if(o.a.viewport.mobiledevice)if(this.innerText.length>50)for(var e=0;e<t.length;e++)t[e].classList.add("v-view_b");else this._create();else this._create();this._updateView(),Object(c.a)(this)}}},{key:"_disconnectedCallback",value:function(){f(m(u.prototype),"_disconnectedCallback",this).call(this),this._destroy()}},{key:"_create",value:function(){var t=this,e=this.children[0],n=new i.a(Object.assign({selector:e},this.textProp));this._text=n,e.classList.add("v-view"),e["v-view-callback"]=function(){n.play(Object.assign(t.playProp,{callbacks:[{target:.8,do:function(){t.classList.add("animated")}}]}))}}},{key:"_destroy",value:function(){this._text&&this._text.destroy()}},{key:"_updateView",value:function(){var t=l.a.get();t&&t.updateEl()}},{key:"textProp",get:function(){return{}}},{key:"playProp",get:function(){return{}}}])&&p(e.prototype,n),r&&p(e,r),u}(a.a)},127:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0),i=function(t,e){r.R.call(this,t),this.type="Reflector";var n=this,o=void 0!==(e=e||{}).color?new r.l(e.color):new r.l(8355711),a=e.textureWidth||512,s=e.textureHeight||512,c=e.clipBias||0,l=e.shader||i.ReflectorShader,u=void 0!==e.recursion?e.recursion:0,h=void 0!==e.encoding?e.encoding:r.H,p=new r.hb,f=new r.Lb,d=new r.Lb,v=new r.Lb,y=new r.Q,m=new r.Lb(0,0,-1),g=new r.Mb,_=new r.Lb,b=new r.Lb,w=new r.Mb,x=new r.Q,S=new r.gb,R={minFilter:r.I,magFilter:r.I,format:r.sb,stencilBuffer:!1,encoding:h},O=new r.Ob(a,s,R);r.P.isPowerOfTwo(a)&&r.P.isPowerOfTwo(s)||(O.texture.generateMipmaps=!1);var P=new r.vb({uniforms:r.Ib.clone(l.uniforms),fragmentShader:l.fragmentShader,vertexShader:l.vertexShader});P.uniforms.tDiffuse.value=O.texture,P.uniforms.color.value=o,P.uniforms.textureMatrix.value=x,this.material=P,this.onBeforeRender=function(t,e,r){if("recursion"in r.userData){if(r.userData.recursion===u)return;r.userData.recursion++}if(d.setFromMatrixPosition(n.matrixWorld),v.setFromMatrixPosition(r.matrixWorld),y.extractRotation(n.matrixWorld),f.set(0,0,1),f.applyMatrix4(y),_.subVectors(d,v),!(_.dot(f)>0)){_.reflect(f).negate(),_.add(d),y.extractRotation(r.matrixWorld),m.set(0,0,-1),m.applyMatrix4(y),m.add(v),b.subVectors(d,m),b.reflect(f).negate(),b.add(d),S.position.copy(_),S.up.set(0,1,0),S.up.applyMatrix4(y),S.up.reflect(f),S.lookAt(b),S.far=r.far,S.updateMatrixWorld(),S.projectionMatrix.copy(r.projectionMatrix),S.userData.recursion=0,x.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),x.multiply(S.projectionMatrix),x.multiply(S.matrixWorldInverse),x.multiply(n.matrixWorld),p.setFromNormalAndCoplanarPoint(f,d),p.applyMatrix4(S.matrixWorldInverse),g.set(p.normal.x,p.normal.y,p.normal.z,p.constant);var i=S.projectionMatrix;w.x=(Math.sign(g.x)+i.elements[8])/i.elements[0],w.y=(Math.sign(g.y)+i.elements[9])/i.elements[5],w.z=-1,w.w=(1+i.elements[10])/i.elements[14],g.multiplyScalar(2/g.dot(w)),i.elements[2]=g.x,i.elements[6]=g.y,i.elements[10]=g.z+1-c,i.elements[14]=g.w,n.visible=!1;var o=t.getRenderTarget(),a=t.xr.enabled,s=t.shadowMap.autoUpdate;t.xr.enabled=!1,t.shadowMap.autoUpdate=!1,t.setRenderTarget(O),!1===t.autoClear&&t.clear(),t.render(e,S),t.xr.enabled=a,t.shadowMap.autoUpdate=s,t.setRenderTarget(o);var l=r.viewport;void 0!==l&&t.state.viewport(l),n.visible=!0}},this.getRenderTarget=function(){return O}};i.prototype=Object.create(r.R.prototype),i.prototype.constructor=i,i.ReflectorShader={uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")}},128:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1),i=n(167).default;function o(){if(r.a.viewport.mobiledevice){var t=1;"macos"===r.a.os&&(t=2),i=i.replace("const float Quality","const float Quality = ".concat(t,".8; //"))}return i}},129:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n//\n// Description : Array and textureless GLSL 2D/3D/4D simplex\n//               noise functions.\n//      Author : Ian McEwan, Ashima Arts.\n//  Maintainer : ijm\n//     Lastmod : 20110822 (ijm)\n//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.\n//               Distributed under the MIT License. See LICENSE file.\n//               https://github.com/ashima/webgl-noise\n//\n\nvec3 mod289(vec3 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 mod289(vec4 x) {\n  return x - floor(x * (1.0 / 289.0)) * 289.0;\n}\n\nvec4 permute(vec4 x) {\n     return mod289(((x*34.0)+1.0)*x);\n}\n\nvec4 taylorInvSqrt(vec4 r)\n{\n  return 1.79284291400159 - 0.85373472095314 * r;\n}\n\nfloat snoise(vec3 v)\n  {\n  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\n// First corner\n  vec3 i  = floor(v + dot(v, C.yyy) );\n  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\n// Other corners\n  vec3 g = step(x0.yzx, x0.xyz);\n  vec3 l = 1.0 - g;\n  vec3 i1 = min( g.xyz, l.zxy );\n  vec3 i2 = max( g.xyz, l.zxy );\n\n  //   x0 = x0 - 0.0 + 0.0 * C.xxx;\n  //   x1 = x0 - i1  + 1.0 * C.xxx;\n  //   x2 = x0 - i2  + 2.0 * C.xxx;\n  //   x3 = x0 - 1.0 + 3.0 * C.xxx;\n  vec3 x1 = x0 - i1 + C.xxx;\n  vec3 x2 = x0 - i2 + C.yyy; // 2.0*C.x = 1/3 = C.y\n  vec3 x3 = x0 - D.yyy;      // -1.0+3.0*C.x = -0.5 = -D.y\n\n// Permutations\n  i = mod289(i);\n  vec4 p = permute( permute( permute(\n             i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n           + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n           + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\n// Gradients: 7x7 points over a square, mapped onto an octahedron.\n// The ring size 17*17 = 289 is close to a multiple of 49 (49*6 = 294)\n  float n_ = 0.142857142857; // 1.0/7.0\n  vec3  ns = n_ * D.wyz - D.xzx;\n\n  vec4 j = p - 49.0 * floor(p * ns.z * ns.z);  //  mod(p,7*7)\n\n  vec4 x_ = floor(j * ns.z);\n  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\n  vec4 x = x_ *ns.x + ns.yyyy;\n  vec4 y = y_ *ns.x + ns.yyyy;\n  vec4 h = 1.0 - abs(x) - abs(y);\n\n  vec4 b0 = vec4( x.xy, y.xy );\n  vec4 b1 = vec4( x.zw, y.zw );\n\n  //vec4 s0 = vec4(lessThan(b0,0.0))*2.0 - 1.0;\n  //vec4 s1 = vec4(lessThan(b1,0.0))*2.0 - 1.0;\n  vec4 s0 = floor(b0)*2.0 + 1.0;\n  vec4 s1 = floor(b1)*2.0 + 1.0;\n  vec4 sh = -step(h, vec4(0.0));\n\n  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\n  vec3 p0 = vec3(a0.xy,h.x);\n  vec3 p1 = vec3(a0.zw,h.y);\n  vec3 p2 = vec3(a1.xy,h.z);\n  vec3 p3 = vec3(a1.zw,h.w);\n\n//Normalise gradients\n  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n  p0 *= norm.x;\n  p1 *= norm.y;\n  p2 *= norm.z;\n  p3 *= norm.w;\n\n// Mix final noise value\n  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n  m = m * m;\n  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\n                                dot(p2,x2), dot(p3,x3) ) );\n  }\n\n"},130:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){var e=(new r.e).setFromObject(t),n=new r.yb;return e.getBoundingSphere(n).radius}},142:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return c}));var r=.85,i=.935,o=1e3,a=1e3;function s(t){return{durationAuto:!0,durationElement:o,types:["line"],shift:r,shiftLine:r,line:[{property:"transform",value:function(e){return l(t.lines[e.position].el,e.e)}},{property:"opacity",value:function(t){return t.e.toString()}}]}}function c(t){return{durationAuto:!0,durationElement:a,types:["lineletter"],shift:i,shiftLine:r,letter:[{property:"transform",value:function(e){return l(t.letters[e.position].el,e.e)}},{property:"opacity",value:function(t){return t.e.toString()}}]}}function l(t,e){var n=0;t&&(n=t.clientHeight);var r=-90*(1-e),i=n/2*(1-e)*-1;return"translate3d(0, ".concat(n/2*(1-e),"px, ").concat(i,"px) rotateX(").concat(r,"deg)")}},147:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nconst float MAX_KERNEL_SIZE = 4.0; // 7.0\n\n// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float randK(vec2 co, float seed) {\n    const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);\n    return fract(sin(sn) * c + seed);\n}"},148:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n#ifdef USE_MAP\n\n    vec2 uv = vUv;\n    float strength = u_strength;\n    vec4 color = vec4(0.0);\n\n    vec2 dir = vec2(u_center.xy / u_filterArea.xy - uv);\n    dir *= strength;\n        \n    // randomize the lookup values to hide the fixed number of samples\n    float offset = randK(uv, 0.0);\n\n    float total = 0.0;\n\n    // blur\n    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {\n\n        float percent = (t + offset) / MAX_KERNEL_SIZE;\n        float weight = 4.0 * (percent - percent * percent);\n        vec2 p = uv + dir * percent;\n        vec4 sample = texture2D(map, p);\n\n        color += sample * weight;\n        total += weight;\n\n        if (t > MAX_KERNEL_SIZE){\n            break;\n        }\n\n    }\n\n    color /= total;\n    \n\tcolor = mapTexelToLinear( color );\n\tdiffuseColor *= color;\n\n#endif"},149:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvec3 transformed = vec3( position );\nfloat M_PI = 3.1415926535897932384626433832795;\n\nfloat maxDistortion = 40. * u_dpr;\n\n// calc y\nfloat yParallax = (-0.5 - sin(uv.x * M_PI)) * (u_strength * maxDistortion);\ntransformed.y = (transformed.y - yParallax);\n\n// calc x\n// float xStrength = 0.;\n// if (u_strength > 0.) {\n//     xStrength = cos(uv.x * M_PI) * cos((.5 - uv.y) * M_PI) * u_strength;\n// }\n// float xAdd = xStrength * (maxDistortion * 2.5);\n// transformed.x += xAdd;"},150:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n#ifdef USE_MAP\n\n    vec2 coord = vUv;\n\n    // parallax\n    float parallaxStrength = .05;\n    // apply parallax\n    coord.y += u_strength * parallaxStrength;\n\n    // hover scale\n    float maxScale = .1;\n    float hoverScaleStrength = maxScale * u_hoverProgress;\n\n    // scale coord for parallax & hover\n    coord -= vec2(0.5);\n    coord *= 1. - parallaxStrength - hoverScaleStrength;\n    coord += vec2(0.5);\n    \n    // apply parallax\n    coord.x += (hoverScaleStrength * u_parallaxX) / 2.;\n    coord.y -= (hoverScaleStrength * u_parallaxY) / 2.;\n\n\tvec4 texelColor = texture2D( map, coord );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n#endif"},151:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(152))&&r.__esModule?r:{default:r};var o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={selector:"#html-rotate",rotate:-90,updateOnResize:!0,fitParentHeight:!1};t=Object.assign(e,t);var n=(0,i.default)(t.selector);if(!(n instanceof HTMLElement))return!1;var r=document.createElement("div");for(r.style.display="inline-block";n.childNodes.length>0;)r.appendChild(n.childNodes[0]);n.appendChild(r),a();var o=a.bind(this);function a(){var e=n.parentElement;n.style.position="relative",r.style.position="absolute",r.style.display="inline-block",r.style.transform="rotate(".concat(s(),"deg)"),t.fitParentHeight?r.style.width=e.clientHeight+"px":r.style.whiteSpace="nowrap";var i=r.clientWidth,o=r.clientHeight;n.style.height=i+"px",n.style.width=o+"px",r.style.top=(i-o)/2+"px",r.style.left=(o-i)/2+"px"}function s(){return 90===t.rotate||-90===t.rotate?t.rotate:-90}function c(){for(window.removeEventListener("resize",o);r.childNodes.length>0;)n.appendChild(r.childNodes[0]);r.remove(),n.style.height="",n.style.width=""}return window.addEventListener("resize",o),{update:a.bind(this),destroy:c.bind(this)}};e.default=o},152:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(t instanceof HTMLElement)return t;if("string"==typeof t)return document.querySelector(t);return!1}},156:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(n(7)),o=s(n(6)),a=s(n(51));function s(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f(t);if(e){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function p(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=n(23),v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(s,t);var e,n,r,i=h(s);function s(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),i.call(this,t)}return e=s,(n=[{key:"prefix",get:function(){return"".concat(this._v.prefix,"filter")}},{key:"defaultProp",get:function(){var t=this._prefix;return(0,o.default)(l(f(s.prototype),"defaultProp",this),{selectors:{group:".".concat(t,"__group"),filter:".".concat(t,"__filter")},saveOnChange:!0,multipleSeparator:"_",timeout:0,popstate:{event:!0,reload:!1,timeout:300},pagination:{}})}},{key:"_extra",value:function(){l(f(s.prototype),"_extra",this).call(this);var t=this._prefix;this._data={group:"data-".concat(t,"-group"),multiple:"data-".concat(t,"-multiple"),id:"data-".concat(t,"-id")},this._groups=[],this._filters=[],this._filtersEvents=[],this._json="{}",this._popstateTimeout=!1,this._elementsGet(),this.setFilters(!0),this._json=this._getFiltersQuery()}},{key:"filters",get:function(){return this._filters}},{key:"groups",get:function(){return this._groups}},{key:"_elementsGet",value:function(){this._getGroups(),this._getFilters()}},{key:"_getGroups",value:function(){var t=this;this._groups=[],d.all(this._prop.selectors.group).forEach((function(e){var n=t._getGroupId(e);if(n){var r=t._getGroupMultiple(e);t._groups.push({el:e,id:n,multiple:r})}}))}},{key:"_getFilters",value:function(){var t=this;this._clearFilters();var e=d.all(this._prop.selectors.filter),n=0;e.forEach((function(e){var r=t._getGroupByElement(e),i=t._getFilterID(e);if(!1!==r&!1!==i){var o={el:e,group:r,active:e.classList.contains("".concat(t._prefix,"__filter_active")),disabled:!1,unique_id:(0,a.default)(n),id:i};t._filters.push(o);var s=t.listener(e,"click",t.filterClick.bind(t,e));t._filtersEvents.push(s)}n++}))}},{key:"_clearFilters",value:function(){var t=this;this._filtersEvents.forEach((function(e){t.removeEventListener(e)})),this._filters=[],this._filtersEvents=[]}},{key:"_getGroupId",value:function(t){var e=t.getAttribute(this._data.group);return e||!1}},{key:"_getGroupMultiple",value:function(t){return!!t.getAttribute(this._data.multiple)}},{key:"_getGroupByElement",value:function(t){var e=t.getAttribute(this._data.group);if(e){var n=!1;return this._groups.forEach((function(t){t.id==e&&(n=t)})),n}return!1}},{key:"_getFilterByElement",value:function(t){var e=!1;return this._filters.forEach((function(n){n.el==t&&(e=n)})),e}},{key:"_getFiltersByGroupID",value:function(t){var e=[];return this._filters.forEach((function(n){n.group.id==t&&e.push(n)})),e}},{key:"_getFilterID",value:function(t){var e=t.getAttribute(this._data.id);return e||!1}},{key:"save",value:function(){var t=this._getFiltersQuery();if(t!==this._json){if(!this._update(t))return!1;this._json=t,this.lbt("save")}return!0}},{key:"filterClick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&e.preventDefault();var n=this._getFilterByElement(t);return!!n&&!!this._checkFilterClick(n)&&(this._changeFiltersProp(n),this._changeFiltersClasses(n),!this._prop.saveOnChange||this.save())}},{key:"_checkFilterClick",value:function(t){return!this._prop.pagination.loading&&!t.disabled}},{key:"_changeFiltersProp",value:function(t){for(var e=t.group,n=this._getFiltersByGroupID(e.id),r=0;r<n.length;r++){var i=n[r];e.multiple?i.unique_id==t.unique_id&&(i.active=!t.active):i.unique_id==t.unique_id?i.active=!0:i.active=!1}}},{key:"_changeFiltersClasses",value:function(){var t=this._prefix;this._filters.forEach((function(e){var n="".concat(t,"__filter_active");e.active?e.el.classList.add(n):e.el.classList.remove(n);var r="".concat(t,"__filter_disabled");e.disabled?(e.el.classList.add(r),e.el.disabled=!0):(e.el.classList.remove(r),e.el.disabled=!1)}))}},{key:"setFilters",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n="".concat(this._prefix,"__filter_active");this._groups.forEach((function(r){var i=t._v.url.getParam({key:r.id});if(i){var o=i.split(t._prop.multipleSeparator);t._getFiltersByGroupID(r.id).forEach((function(t){o.includes(t.id)?t.active=!0:(t.active=!1,e&&t.el.classList.contains(n)&&(t.active=!0))}))}else t._getFiltersByGroupID(r.id).forEach((function(t){t.active=!1,e&&t.el.classList.contains(n)&&(t.active=!0)}))})),this._changeFiltersClasses()}},{key:"_getFiltersQuery",value:function(){var t={};return this._filters.forEach((function(e){if(e.active){var n=e.group.id;void 0===t[n]&&(t[n]=[]),t[n].push(e.id)}})),JSON.stringify(t)}},{key:"_getURLParams",value:function(t){var e=this._prop,n=JSON.parse(t),r=[];for(var i in n){var o=n[i].join(e.multipleSeparator);r.push([i,o])}return r}},{key:"_update",value:function(t){var e=this._prop;if(this._json==t)return!1;for(var n=this._getURLParams(t),r=this._getURLParams(this._json),i=e.pagination,o=this._v.url.setParam({key:i.prop.param,value:"",push:!1}),a=0;a<r.length;a++){var s=!1;a==r.length-1&&(s=0===n.length),o=this._v.url.setParam({url:o,key:r[a][0],value:"",push:s})}for(var c=0;c<n.length;c++){var l=!1;c==n.length-1&&(l=!0),o=this._v.url.setParam({url:o,key:n[c][0],value:"null"==n[c][1]?"":n[c][1],push:l})}return i.url=o,i.reload(!1),!0}},{key:"_setEvents",value:function(){this.listener(window,"popstate",this._popstate.bind(this))}},{key:"_popstate",value:function(){var t=this._prop.popstate;if(!t.event)return t.reload&&window.location.reload(),!1;this._popstateLoad()}},{key:"_popstateLoad",value:function(){var t=this._prop,e=t.popstate.timeout,n=t.pagination;this._popstateTimeout&&(clearTimeout(this._popstateTimeout),this._popstateTimeout=!1),n.loading?this._popstateTimeout=setTimeout(this._popstateBusyLoad.bind(this),e):this._popstateTimeout=setTimeout(this._popstateForceLoad.bind(this),e)}},{key:"_popstateBusyLoad",value:function(){var t=this;this._prop.pagination.on("load",(function(){t._popstateLoad()}),{once:!0})}},{key:"_popstateForceLoad",value:function(){this.lbt("popstate",{href:window.location.href}),this.setFilters();var t=this._prop.pagination;t.url=window.location.href;var e=this._v.url.getParam({key:t.prop.param});e=null!=e?parseInt(e):1,t._active=e,t.reload(!1,!1)}}])&&c(e.prototype,n),r&&c(e,r),s}(i.default);e.default=v},158:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(n(6)),o=s(n(44)),a=s(n(28));function s(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f(t);if(e){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function p(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=n(77),v="hover",y="no-action",m="in-action",g="hide",_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(s,t);var e,n,r,a=h(s);function s(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),a.call(this,t,!1)}return e=s,(n=[{key:"defaultProp",get:function(){return(0,i.default)(l(f(s.prototype),"defaultProp",this),{draggable:!0,autoSize:!0,minSize:50})}},{key:"bars",get:function(){return this._bars}},{key:"_extra",value:function(){l(f(s.prototype),"_extra",this).call(this),this._vars(),this._create()}},{key:"_vars",value:function(){this._scrollEvents=[],this._bars={},this._dragging=!1}},{key:"_create",value:function(){this._createScrollbar("x"),this._createScrollbar("y")}},{key:"_createScrollbar",value:function(t){var e=this,n=this._m;this._bars[t]={};var r=this._bars[t],i=n.prefix;r.outer=d({selector:"div",styles:"".concat(i,"__scrollbar ").concat(i,"__scrollbar_").concat(t," ").concat(g," ").concat(y)}),n.outer.appendChild(r.outer),r.outer.addEventListener("mouseenter",(function(){e._setScrollBarClass(t,v,!0)})),r.outer.addEventListener("mouseleave",(function(){e._setScrollBarClass(t,v,!1)})),r.bar=d({selector:"div",styles:"".concat(i,"__bar")}),r.outer.appendChild(r.bar),r.outerWidth=0,r.outerHeight=0,r.barWidth=0,r.barHeight=0}},{key:"_setScrollBarsClass",value:function(t,e){this._setScrollBarClass("x",t,e),this._setScrollBarClass("y",t,e)}},{key:"_setScrollBarClass",value:function(t,e,n){var r=this._bars[t].outer;n?r.classList.add(e):r.classList.remove(e)}},{key:"_updateSizes",value:function(){this._updateBarSize("x"),this._updateBarSize("y"),this._showHideBars()}},{key:"_updateBarSize",value:function(t){var e=this._m,n=e.outerSizes,r=e.sizes,i=this._prop.minSize,o=this._bars[t];if(this._prop.autoSize)if("x"==t){var a=o.outer.clientWidth/(r[0]/n[0]);a<i&&(a=i),o.bar.style.width=a+"px",o.bar.style.height="100%"}else if("y"==t){var s=o.outer.clientHeight/(r[1]/n[1]);s<i&&(s=i),o.bar.style.width="100%",o.bar.style.height=s+"px"}o.outerWidth=o.outer.clientWidth,o.outerHeight=o.outer.clientHeight,o.barWidth=o.bar.clientWidth,o.barHeight=o.bar.clientHeight}},{key:"_showHideBars",value:function(){this._showHideBar("x"),this._showHideBar("y")}},{key:"_showHideBar",value:function(t){var e=this._m,n=e.outerSizes,r=e.sizes,i=this._bars[t];"x"==t?n[0]==r[0]?i.outer.classList.add(g):i.outer.classList.remove(g):"y"==t&&(n[1]==r[1]?i.outer.classList.add(g):i.outer.classList.remove(g))}},{key:"_render",value:function(){this._renderBar("x"),this._renderBar("y"),this._setScrollBarsClass(m,!0)}},{key:"_renderBar",value:function(t){var e=this._m,n=this._bars[t],r=e.outerSizes,i=e.sizes;if("y"==t){var o=i[1]-r[1],a=e.scrollTop/o,s=n.outerHeight-n.barHeight;n.bar.style.transform="translateY(".concat(s*a,"px)")}else if("x"==t){var c=i[0]-r[0],l=e.scrollLeft/c,u=n.outerWidth-n.barWidth;n.bar.style.transform="translateX(".concat(u*l,"px)")}}},{key:"_setEvents",value:function(){var t=this;this._setDrag(),this._updateSizes(),this._scrollEvents.push(this._m.on("size",this._updateSizes.bind(this))),this._scrollEvents.push(this._m.on("update",this._render.bind(this)));var e=this._m.on("wheel",(function(){t._setScrollBarsClass(m,!0),t._setScrollBarsClass(y,!1)}));this._scrollEvents.push(e);var n=this._m.on("approximate",(function(){t._setScrollBarsClass(y,!0),t._setScrollBarsClass(m,!1)}));this._scrollEvents.push(n)}},{key:"_setDrag",value:function(){this._setDragOnBar("x"),this._setDragOnBar("y")}},{key:"_setDragOnBar",value:function(t){var e=this._bars[t],n=new o.default({on:this._prop.draggable,outer:e.bar,parent:this,thresholdPropagation:{dir:t,value:1}});n.on("start",this._start.bind(this,t)),n.on("move",this._move.bind(this,t)),n.on("end",this._end.bind(this,t))}},{key:"_start",value:function(){this._m.prop.run&this._prop.draggable&&(this._dragging=!0,this._setScrollBarsClass(m,!0),this._setScrollBarsClass(y,!1))}},{key:"_move",value:function(t,e){var n=this._m;if(n.prop.run&&this._prop.draggable&&this._dragging){var r=this._bars[t];this._m.play();var i=e.step,o=n.sizes;"x"==t?n.targetLeft+=i.x*(o[0]/(r.outer.clientWidth-r.bar.clientWidth)):"y"==t&&(n.targetTop+=i.y*(o[1]/(r.outer.clientHeight-r.bar.clientHeight))),n._boundariesBoth()}}},{key:"_end",value:function(){this._m.prop.run&&this._prop.draggable&&(this._dragging=!1)}},{key:"_destroy",value:function(){var t=this;l(f(s.prototype),"_destroy",this).call(this),this._scrollEvents.forEach((function(e){t._m.remove(e)})),this._bars.x.outer.remove(),this._bars.y.outer.remove()}}])&&c(e.prototype,n),r&&c(e,r),s}(a.default);e.default=_},164:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvec4 mvPosition = vec4( transformed, 1.0 );\n\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\n\nmvPosition = modelViewMatrix * mvPosition;\n\nfloat distance = length(mvPosition.xy);\nfloat sizeDist = length(vec2(.5, .5));\nfloat normalizedDistance = distance / sizeDist;\n\nmvPosition.xy *= 1. - u_strength;\n\nmvPosition.z += normalizedDistance * u_strength;\n\nvec4 GL_POS = projectionMatrix * mvPosition;\n\n// float BarrelPower = 0.9;\n\n// vec2 v = GL_POS.xy / GL_POS.w;\n// // Convert to polar coords:\n// float radius = length(v);\n// if (radius > 0.) {\n// \tfloat theta = atan(v.y,v.x);\n// \t// Distort:\n// \tradius = pow(radius, BarrelPower);\n// \t// Convert back to Cartesian:\n// \tv.x = radius * cos(theta);\n// \tv.y = radius * sin(theta);\n// \tGL_POS.xy = v.xy * GL_POS.w;\n// }\n\ngl_Position = GL_POS;"},165:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nfloat getScatter(vec3 start, vec3 dir, vec3 lightPos, float d, float lightScatterDivider, float lightScatterPowInv) {\n    // light to ray origin\n    vec3 q = start - lightPos;\n\n    // coefficients\n    float b = dot(dir, q);\n    float c = dot(q, q);\n\n    // evaluate integral\n    // float s = 1.0 / sqrt(c - b*b);\n    float t = c - b*b;\n    // float s = t <= 0.0 ? 1.0 : 1.0 / sqrt(t);\n    float s = 1.0 / sqrt(max(0.0001, t));\n    float l = s * (atan( (d + b) * s) - atan( b*s ));\n\n    return pow(max(0.0, l / lightScatterDivider), lightScatterPowInv);\n}\n\n"},166:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n#ifdef USE_MAP\n\n    vec4 outColor = vec4(1.);\n\n    vec2 mainTextureCoord = vUv;\n    // mainTextureCoord = pinch(mainTextureCoord, u_center, u_strength, u_radius);\n    vec4 textureColor = texture2D(map, mainTextureCoord);\n\n    // mirror\n    // vec2 mirrorTextureCoord = vec2(vUv.x, 1.0 - vUv.y);\n    // mirrorTextureCoord.y -= .55;\n    // mirrorTextureCoord = pinch(mirrorTextureCoord, u_center, u_strength, u_radius);\n    // vec4 mirrorTexture = texture2D(map, mirrorTextureCoord);\n    // mirrorTexture.a *= .1;\n\n    // calculate gradient\n    float d = dist(vec2(.5, .5), vUv.xy) * 1.;\n\tvec4 gradient = mix(vec4(0.0, 0.0, 0.0, 0.0), vec4(0.0, 0.0, 0.0, 1.0), d);\n\n    // bg color\n    vec4 bgColor = vec4(u_color, 1.);\n    bgColor = blend(bgColor, gradient);\n\n    // scatter prop\n    vec3 toCameraWorld = v_worldPosition - u_cameraPosition;\n    vec3 nToCameraWorldDir = normalize(toCameraWorld);\n    float toCameraDist = length(toCameraWorld);\n\n    vec3 u_lightColor = vec3(1., 1., 1.);\n    float u_lightScatterDivider = .7;\n    float u_lightScatterPowInv = .75;\n\n    if (u_useLight) {\n\n        // get scatter for background\n        float bgScatter = getScatter(u_cameraPosition, nToCameraWorldDir, u_lightPosition, toCameraDist, u_lightScatterDivider, u_lightScatterPowInv);\n        vec3 bgWithLight = bgColor.rgb + bgScatter * u_lightColor;\n        bgColor = vec4(dithering(bgWithLight), 1.);\n\n        // get scatter for foreground\n        float fgScatter = getScatter(u_cameraPosition, nToCameraWorldDir, u_lightPosition, toCameraDist, u_lightScatterDivider, u_lightScatterPowInv * 1.5);\n        textureColor = blend(textureColor, vec4(fgScatter));\n\n    }\n\n    // apply background\n    outColor = bgColor;\n    // apply texture\n    outColor = blend(bgColor, textureColor);\n\n    // return the color\n    vec4 texelColor = mapTexelToLinear( vec4(dithering(outColor.rgb), 1.) );\n    diffuseColor *= texelColor;\n\n#endif"},167:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\n// https://www.shadertoy.com/view/Xltfzj\n\nvec4 blurShift(vec4 coord, float shiftX, float shiftY) {\n    coord.x = coord.x + shiftX;\n    coord.y = coord.y + shiftY;\n    return coord;\n}\n\nvec4 blur_texture2DProj(sampler2D tDiffuse, vec4 uv) {\n\n    const float Pi = 6.28318530718;\n    const float Directions = 16.0;\n    const float DirStep = Pi / Directions;\n    const float Quality = 2.0;\n    const float QualityStep = 1. / Quality;\n    const float Size = 15.0;\n    \n    // Pixel colour\n    vec4 Color = texture2DProj(tDiffuse, uv);\n    \n    // Blur calculations\n    for (float d = 0.0; d < Pi; d += DirStep) {\n\t\tfor (float i = QualityStep; i <= 1.0; i += QualityStep) {\n            Color += texture2DProj( tDiffuse, blurShift(uv, cos(d)*Size*i, sin(d)*Size*i) );\n        }\n    }\n    \n    // Output to screen\n    Color /= Quality * Directions - 15.0;\n\n    return Color;\n\n}\n\n"},168:function(t,e,n){"use strict";n.r(e),e.default="#define GLSLIFY 1\nvec3 transformed = vec3( position );\n\nfloat distance = length(transformed.xy - .5);\nfloat sizeDist = length(vec2(.5, .5));\nfloat normalizedDistance = distance / sizeDist;\n\nfloat stickOutEffect = normalizedDistance;\nfloat stickInEffect = -normalizedDistance;\n\nfloat myDirection = -1.;\nfloat stickEffect = mix(stickOutEffect, stickInEffect, myDirection);\n\nfloat stickOffset = u_strength;\ntransformed.z -= stickEffect * stickOffset * u_progress;"},212:function(t,e,n){"use strict";n.r(e),n.d(e,"HeaderTextLines",(function(){return y}));var r=n(18),i=n(123),o=n(142);function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p(t);if(e){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var d=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":f(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},v="header-text-lines",y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(h,t);var e,n,r,i=u(h);function h(){return a(this,h),i.apply(this,arguments)}return e=h,(n=[{key:"_create",value:function(){c(p(h.prototype),"_create",this).call(this),this.classList.add(v),this._text&&this.classList.add("lines")}},{key:"textProp",get:function(){return{appendLines:!0,appendLetters:!1}}},{key:"playProp",get:function(){return Object(o.b)(this._text)}}])&&s(e.prototype,n),r&&s(e,r),h}(i.a);y=d([Object(r.b)(v)],y)},213:function(t,e,n){"use strict";n.r(e),n.d(e,"HeaderTextLetters",(function(){return m}));var r=n(18),i=n(123),o=n(142),a=n(1);function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f(t);if(e){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function p(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var v=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":d(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},y="header-text-letters",m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(p,t);var e,n,r,i=h(p);function p(){return s(this,p),i.apply(this,arguments)}return e=p,(n=[{key:"_create",value:function(){l(f(p.prototype),"_create",this).call(this),this.classList.add(y),this._text&&(a.a.viewport.mobiledevice||this._text.lines.length>1?this.classList.add("lines"):this.classList.add("letters"))}},{key:"textProp",get:function(){return{appendLines:!0}}},{key:"playProp",get:function(){return this.classList.contains("letters")?Object(o.a)(this._text):Object(o.b)(this._text)}}])&&c(e.prototype,n),r&&c(e,r),p}(i.a);m=v([Object(r.b)(y)],m)},218:function(t,e,n){"use strict";n.r(e),n.d(e,"PortfolioGallery",(function(){return jo}));var r=n(2),i=n(18),o=n(5),a=n.n(o),s=n(81),c=n.n(s),l=n(79),u=n.n(l),h=n(11),p=n.n(h),f=n(0),d=n(35),v=n(113),y=n(3);function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b(t,e,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=R(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=R(t);if(e){var i=R(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return S(this,n)}}function S(t,e){return!e||"object"!==m(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var O=n(118).default,P=n(119).default,T=n(164).default,E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}(o,t);var e,n,r,i=x(o);function o(){return g(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"_extra",value:function(){this._prop.uniformsData=[{key:"u_strength",type:"float",value:y.i.pinchStrength}],b(R(o.prototype),"_extra",this).call(this),this._prop.extendFragmentShader="empty"}},{key:"_setMaterialOnBeforeCompile",value:function(){var t=this;this._material.onBeforeCompile=function(e){window.r="".concat(Math.random(),"portfolio gallery image plane"),t._onMaterialBeforeCompileFragment(e)}}},{key:"_onMaterialBeforeCompileFragment",value:function(t){this.prop.extendFragmentShader&&(this._setShaderUniforms(t),t.vertexShader=O+P+t.vertexShader,t.vertexShader=t.vertexShader.replace("#include <project_vertex>",T))}},{key:"render",value:function(){b(R(o.prototype),"render",this).call(this),this._uniforms.u_strength&&(this._uniforms.u_strength.value=-1*y.i.pinchStrength)}}])&&_(e.prototype,n),r&&_(e,r),o}(v.a),C=n(15),A=n(1);function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function j(t,e,n){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=F(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function B(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=F(t);if(e){var i=F(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return z(this,n)}}function z(t,e){return!e||"object"!==I(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function F(t){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var D=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":I(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(a,t);var e,n,i,o=B(a);function a(){var t;return k(this,a),(t=o.apply(this,arguments)).imageTitle="",t.imageColor="#ffffff",t._width=0,t._height=0,t._x=0,t._y=0,t}return e=a,(n=[{key:"setCoords",value:function(t,e){this._x=t,this._y=e,this._updatePosition()}},{key:"createRenderRoot",value:function(){return this}},{key:"firstUpdated",value:function(){this._create()}},{key:"disconnectedCallback",value:function(){if(j(F(a.prototype),"disconnectedCallback",this).call(this),this._plane&&this._plane.destroy(),this._guiColorFolder&&C.b)try{C.b.removeFolder(this._guiColorFolder)}catch(t){}}},{key:"_create",value:function(){var t=this,e=Object(r.g)(".portfolio-gallery-image__content",this);if(!Object(r.c)(e))throw new Error('The element doesn\'t have a child element ".content"');var n=this.imageSrc;if("string"!=typeof n)throw console.error(this),new Error('The element doesn\'t have the attribute "image-src"');var i=Object(r.d)(this,So);if(i){var o=this.imageTitle;o&&(this._title=o);var a=this.imageColor;if(a&&(this._color=a),this._plane=new E({el:e,src:n,scene:!!i.group&&i.group,renderPosition:!1,material:f.T,posRule:"cover"}),this._plane.on("mesh",(function(){t._plane.mesh.castShadow=!0})),C.b){var s=C.b.addFolder("Portfolio ".concat(this._title));s.addColor(this,"_color"),this._guiColorFolder=s}}}},{key:"_updatePosition",value:function(){if(this.style.transform="translate(".concat(this._x,"px, ").concat(this._y,"px)"),this._plane&&this._plane.mesh){var t=this._x+this._width/2-A.a.viewport.size[0]/2,e=-1*(this._y+this._height/2-A.a.viewport.size[1]/2),n=this._plane.mesh;n.position.x=t,n.position.y=e}}},{key:"outer",get:function(){return this}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}},{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._updatePosition()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._updatePosition()}},{key:"plane",get:function(){return this._plane}},{key:"color",get:function(){return this._color}}])&&M(e.prototype,n),i&&M(e,i),a}(i.a);D([Object(i.d)({attribute:"image-src"})],q.prototype,"imageSrc",void 0),D([Object(i.d)({attribute:"image-title"})],q.prototype,"imageTitle",void 0),D([Object(i.d)({attribute:"image-color"})],q.prototype,"imageColor",void 0),q=D([Object(i.b)("portfolio-gallery-image")],q);var N=n(34),V=n(4),W=n(54);function U(t){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function X(t,e,n){return(X="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Z(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Y(t,e){return(Y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function K(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Z(t);if(e){var i=Z(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Q(this,n)}}function Q(t,e){return!e||"object"!==U(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Z(t){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var J=n(118).default,$=n(120).default,tt=n(119).default,et=n(165).default,nt=n(166).default,rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Y(t,e)}(o,t);var e,n,r,i=K(o);function o(){return H(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"_extra",value:function(){this._prop.uniformsData=[{key:"u_cameraPosition",type:"vec3",value:V.a.camera3d.position},{key:"u_lightPosition",type:"vec3",value:new f.Lb(0,0,1)},{key:"u_color",type:"vec3",value:new f.l(0,0,0)},{key:"u_useLight",type:"bool",value:!A.a.viewport.mobiledevice}],X(Z(o.prototype),"_extra",this).call(this),this._prop.extendFragmentShader="empty",this._prop.materialProp.transparent=!0,this._prop.materialProp.dithering=!0}},{key:"_setMaterialOnBeforeCompile",value:function(){var t=this;this._material.onBeforeCompile=function(e){window.r="".concat(Math.random(),"portfolio gallery images plane"),t._onMaterialBeforeCompileFragment(e)}}},{key:"_onMaterialBeforeCompileFragment",value:function(t){this.prop.extendFragmentShader&&(this._setShaderUniforms(t),t.fragmentShader=J+$+tt+et+t.fragmentShader,t.fragmentShader="varying vec3 v_worldPosition; \n            ".concat(t.fragmentShader),t.fragmentShader=t.fragmentShader.replace("#include <common>","\n                        #include <common>\n                        #include <dithering_pars_fragment>\n                    "),t.fragmentShader=t.fragmentShader.replace("#include <map_fragment>",nt),t.vertexShader="varying vec3 v_worldPosition; ".concat(t.vertexShader),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>","\n                        vec3 transformed = vec3( position );\n                        v_worldPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n                    "))}},{key:"render",value:function(){if(X(Z(o.prototype),"render",this).call(this),W.a){var t=this._uniforms;t.u_lightPosition&&(t.u_lightPosition.value=W.a.getPosition())}}}])&&G(e.prototype,n),r&&G(e,r),o}(N.a),it=n(127),ot=n(128),at=n(120).default,st=n(129).default,ct=Object(ot.a)();function lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ht(t,e,n){return(ht="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vt(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function pt(t,e){return(pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=vt(t);if(e){var i=vt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return dt(this,n)}}function dt(t,e){return!e||"object"!==yt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vt(t){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yt(t){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var mt=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":yt(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},gt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pt(t,e)}(a,t);var e,n,i,o=ft(a);function a(){var t;return lt(this,a),(t=o.apply(this,arguments))._progress=0,t}return e=a,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"firstUpdated",value:function(){this._create()}},{key:"disconnectedCallback",value:function(){ht(vt(a.prototype),"disconnectedCallback",this).call(this)}},{key:"_create",value:function(){this._itemsOuter=Object(r.g)(".portfolio-gallery-titles__item",this),this._items=Object(r.f)(".portfolio-gallery-titles__item",this),this._length=this._items.length}},{key:"_render",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._progress;t*=-1;for(var e=this._itemsOuter.clientHeight,n=0;n<this._length;n++){var r=this._items[n],i=e*n+e*t;i=gsap.utils.wrap(-e,e*(this._length-1),i),r.style.transform="translate3d(0, ".concat(i,"px, 0)")}}},{key:"progress",set:function(t){this._progress=t,this._render(t)}}])&&ut(e.prototype,n),i&&ut(e,i),a}(i.a);gt=mt([Object(i.b)("portfolio-gallery-titles")],gt);var _t=n(57);function bt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wt(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var xt,St,Rt,Ot,Pt,Tt,Et,Ct,At,kt,Mt,jt,Lt,Bt,zt,Ft,It,Dt,qt,Nt,Vt,Wt,Ut,Ht,Gt,Xt,Yt,Kt,Qt={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Zt={duration:.5,overwrite:!1,delay:0},Jt=1e8,$t=1e-8,te=2*Math.PI,ee=te/4,ne=0,re=Math.sqrt,ie=Math.cos,oe=Math.sin,ae=function(t){return"string"==typeof t},se=function(t){return"function"==typeof t},ce=function(t){return"number"==typeof t},le=function(t){return void 0===t},ue=function(t){return"object"==typeof t},he=function(t){return!1!==t},pe=function(){return"undefined"!=typeof window},fe=function(t){return se(t)||ae(t)},de="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},ve=Array.isArray,ye=/(?:-?\.?\d|\.)+/gi,me=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,ge=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,_e=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,be=/[+-]=-?[.\d]+/,we=/[#\-+.]*\b[a-z\d-=+%.]+/gi,xe=/[\d.+\-=]+(?:e[-+]\d*)*/i,Se={},Re={},Oe=function(t){return(Re=Ze(t,Se))&&Fr},Pe=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Te=function(t,e){return!e&&console.warn(t)},Ee=function(t,e){return t&&(Se[t]=e)&&Re&&(Re[t]=e)||Se},Ce=function(){return 0},Ae={},ke=[],Me={},je={},Le={},Be=30,ze=[],Fe="",Ie=function(t){var e,n,r=t[0];if(ue(r)||se(r)||(t=[t]),!(e=(r._gsap||{}).harness)){for(n=ze.length;n--&&!ze[n].targetTest(r););e=ze[n]}for(n=t.length;n--;)t[n]&&(t[n]._gsap||(t[n]._gsap=new cr(t[n],e)))||t.splice(n,1);return t},De=function(t){return t._gsap||Ie(Tn(t))[0]._gsap},qe=function(t,e,n){return(n=t[e])&&se(n)?t[e]():le(n)&&t.getAttribute&&t.getAttribute(e)||n},Ne=function(t,e){return(t=t.split(",")).forEach(e)||t},Ve=function(t){return Math.round(1e5*t)/1e5||0},We=function(t,e){for(var n=e.length,r=0;t.indexOf(e[r])<0&&++r<n;);return r<n},Ue=function(t,e,n){var r,i=ce(t[1]),o=(i?2:1)+(e<2?0:1),a=t[o];if(i&&(a.duration=t[1]),a.parent=n,e){for(r=a;n&&!("immediateRender"in r);)r=n.vars.defaults||{},n=he(n.vars.inherit)&&n.parent;a.immediateRender=he(r.immediateRender),e<2?a.runBackwards=1:a.startAt=t[o-1]}return a},He=function(){var t,e,n=ke.length,r=ke.slice(0);for(Me={},ke.length=0,t=0;t<n;t++)(e=r[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},Ge=function(t,e,n,r){ke.length&&He(),t.render(e,n,r),ke.length&&He()},Xe=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(we).length<2?e:ae(t)?t.trim():t},Ye=function(t){return t},Ke=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},Qe=function(t,e){for(var n in e)n in t||"duration"===n||"ease"===n||(t[n]=e[n])},Ze=function(t,e){for(var n in e)t[n]=e[n];return t},Je=function t(e,n){for(var r in n)"__proto__"!==r&&"constructor"!==r&&"prototype"!==r&&(e[r]=ue(n[r])?t(e[r]||(e[r]={}),n[r]):n[r]);return e},$e=function(t,e){var n,r={};for(n in t)n in e||(r[n]=t[n]);return r},tn=function(t){var e=t.parent||St,n=t.keyframes?Qe:Ke;if(he(t.inherit))for(;e;)n(t,e.vars.defaults),e=e.parent||e._dp;return t},en=function(t,e,n,r){void 0===n&&(n="_first"),void 0===r&&(r="_last");var i=e._prev,o=e._next;i?i._next=o:t[n]===e&&(t[n]=o),o?o._prev=i:t[r]===e&&(t[r]=i),e._next=e._prev=e.parent=null},nn=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},rn=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},on=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},an=function t(e){return!e||e._ts&&t(e.parent)},sn=function(t){return t._repeat?cn(t._tTime,t=t.duration()+t._rDelay)*t:0},cn=function(t,e){var n=Math.floor(t/=e);return t&&n===t?n-1:n},ln=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},un=function(t){return t._end=Ve(t._start+(t._tDur/Math.abs(t._ts||t._rts||$t)||0))},hn=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=Ve(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),un(t),n._dirty||rn(n,t)),t},pn=function(t,e){var n;if((e._time||e._initted&&!e._dur)&&(n=ln(t.rawTime(),e),(!e._dur||xn(0,e.totalDuration(),n)-e._tTime>$t)&&e.render(n,!0)),rn(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-1e-8}},fn=function(t,e,n,r){return e.parent&&nn(e),e._start=Ve(n+e._delay),e._end=Ve(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),function(t,e,n,r,i){void 0===n&&(n="_first"),void 0===r&&(r="_last");var o,a=t[r];if(i)for(o=e[i];a&&a[i]>o;)a=a._prev;a?(e._next=a._next,a._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[r]=e,e._prev=a,e.parent=e._dp=t}(t,e,"_first","_last",t._sort?"_start":0),t._recent=e,r||pn(t,e),t},dn=function(t,e){return(Se.ScrollTrigger||Pe("scrollTrigger",e))&&Se.ScrollTrigger.create(e,t)},vn=function(t,e,n,r){return vr(t,e),t._initted?!n&&t._pt&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&Et!==Kn.frame?(ke.push(t),t._lazy=[e,r],1):void 0:1},yn=function t(e){var n=e.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||t(n))},mn=function(t,e,n,r){var i=t._repeat,o=Ve(e)||0,a=t._tTime/t._tDur;return a&&!r&&(t._time*=o/t._dur),t._dur=o,t._tDur=i?i<0?1e10:Ve(o*(i+1)+t._rDelay*i):o,a&&!r?hn(t,t._tTime=t._tDur*a):t.parent&&un(t),n||rn(t.parent,t),t},gn=function(t){return t instanceof ur?rn(t):mn(t,t._dur)},_n={_start:0,endTime:Ce},bn=function t(e,n){var r,i,o=e.labels,a=e._recent||_n,s=e.duration()>=Jt?a.endTime(!1):e._dur;return ae(n)&&(isNaN(n)||n in o)?"<"===(r=n.charAt(0))||">"===r?("<"===r?a._start:a.endTime(a._repeat>=0))+(parseFloat(n.substr(1))||0):(r=n.indexOf("="))<0?(n in o||(o[n]=s),o[n]):(i=+(n.charAt(r-1)+n.substr(r+1)),r>1?t(e,n.substr(0,r-1))+i:s+i):null==n?s:+n},wn=function(t,e){return t||0===t?e(t):e},xn=function(t,e,n){return n<t?t:n>e?e:n},Sn=function(t){if("string"!=typeof t)return"";var e=xe.exec(t);return e?t.substr(e.index+e[0].length):""},Rn=[].slice,On=function(t,e){return t&&ue(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&ue(t[0]))&&!t.nodeType&&t!==Rt},Pn=function(t,e,n){return void 0===n&&(n=[]),t.forEach((function(t){var r;return ae(t)&&!e||On(t,1)?(r=n).push.apply(r,Tn(t)):n.push(t)}))||n},Tn=function(t,e){return!ae(t)||e||!Ot&&Qn()?ve(t)?Pn(t,e):On(t)?Rn.call(t,0):t?[t]:[]:Rn.call(Pt.querySelectorAll(t),0)},En=function(t){return t.sort((function(){return.5-Math.random()}))},Cn=function(t){if(se(t))return t;var e=ue(t)?t:{each:t},n=rr(e.ease),r=e.from||0,i=parseFloat(e.base)||0,o={},a=r>0&&r<1,s=isNaN(r)||a,c=e.axis,l=r,u=r;return ae(r)?l=u={center:.5,edges:.5,end:1}[r]||0:!a&&s&&(l=r[0],u=r[1]),function(t,a,h){var p,f,d,v,y,m,g,_,b,w=(h||e).length,x=o[w];if(!x){if(!(b="auto"===e.grid?0:(e.grid||[1,Jt])[1])){for(g=-Jt;g<(g=h[b++].getBoundingClientRect().left)&&b<w;);b--}for(x=o[w]=[],p=s?Math.min(b,w)*l-.5:r%b,f=s?w*u/b-.5:r/b|0,g=0,_=Jt,m=0;m<w;m++)d=m%b-p,v=f-(m/b|0),x[m]=y=c?Math.abs("y"===c?v:d):re(d*d+v*v),y>g&&(g=y),y<_&&(_=y);"random"===r&&En(x),x.max=g-_,x.min=_,x.v=w=(parseFloat(e.amount)||parseFloat(e.each)*(b>w?w-1:c?"y"===c?w/b:b:Math.max(b,w/b))||0)*("edges"===r?-1:1),x.b=w<0?i-w:i,x.u=Sn(e.amount||e.each)||0,n=n&&w<0?er(n):n}return w=(x[t]-x.min)/x.max||0,Ve(x.b+(n?n(w):w)*x.v)+x.u}},An=function(t){var e=t<1?Math.pow(10,(t+"").length-2):1;return function(n){var r=Math.round(parseFloat(n)/t)*t*e;return(r-r%1)/e+(ce(n)?0:Sn(n))}},kn=function(t,e){var n,r,i=ve(t);return!i&&ue(t)&&(n=i=t.radius||Jt,t.values?(t=Tn(t.values),(r=!ce(t[0]))&&(n*=n)):t=An(t.increment)),wn(e,i?se(t)?function(e){return r=t(e),Math.abs(r-e)<=n?r:e}:function(e){for(var i,o,a=parseFloat(r?e.x:e),s=parseFloat(r?e.y:0),c=Jt,l=0,u=t.length;u--;)(i=r?(i=t[u].x-a)*i+(o=t[u].y-s)*o:Math.abs(t[u]-a))<c&&(c=i,l=u);return l=!n||c<=n?t[l]:e,r||l===e||ce(e)?l:l+Sn(e)}:An(t))},Mn=function(t,e,n,r){return wn(ve(t)?!e:!0===n?!!(n=0):!r,(function(){return ve(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(r=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+.99*n))/n)*n*r)/r}))},jn=function(t,e,n){return wn(n,(function(n){return t[~~e(n)]}))},Ln=function(t){for(var e,n,r,i,o=0,a="";~(e=t.indexOf("random(",o));)r=t.indexOf(")",e),i="["===t.charAt(e+7),n=t.substr(e+7,r-e-7).match(i?we:ye),a+=t.substr(o,e-o)+Mn(i?n:+n[0],i?0:+n[1],+n[2]||1e-5),o=r+1;return a+t.substr(o,t.length-o)},Bn=function(t,e,n,r,i){var o=e-t,a=r-n;return wn(i,(function(e){return n+((e-t)/o*a||0)}))},zn=function(t,e,n){var r,i,o,a=t.labels,s=Jt;for(r in a)(i=a[r]-e)<0==!!n&&i&&s>(i=Math.abs(i))&&(o=r,s=i);return o},Fn=function(t,e,n){var r,i,o=t.vars,a=o[e];if(a)return r=o[e+"Params"],i=o.callbackScope||t,n&&ke.length&&He(),r?a.apply(i,r):a.call(i)},In=function(t){return nn(t),t.progress()<1&&Fn(t,"onInterrupt"),t},Dn=function(t){var e=(t=!t.name&&t.default||t).name,n=se(t),r=e&&!n&&t.init?function(){this._props=[]}:t,i={init:Ce,render:Er,add:fr,kill:Ar,modifier:Cr,rawVars:0},o={targetTest:0,get:0,getSetter:Rr,aliases:{},register:0};if(Qn(),t!==r){if(je[e])return;Ke(r,Ke($e(t,i),o)),Ze(r.prototype,Ze(i,$e(t,o))),je[r.prop=e]=r,t.targetTest&&(ze.push(r),Ae[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Ee(e,r),t.register&&t.register(Fr,r,jr)},qn=255,Nn={aqua:[0,qn,qn],lime:[0,qn,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,qn],navy:[0,0,128],white:[qn,qn,qn],olive:[128,128,0],yellow:[qn,qn,0],orange:[qn,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[qn,0,0],pink:[qn,192,203],cyan:[0,qn,qn],transparent:[qn,qn,qn,0]},Vn=function(t,e,n){return(6*(t=t<0?t+1:t>1?t-1:t)<1?e+(n-e)*t*6:t<.5?n:3*t<2?e+(n-e)*(2/3-t)*6:e)*qn+.5|0},Wn=function(t,e,n){var r,i,o,a,s,c,l,u,h,p,f=t?ce(t)?[t>>16,t>>8&qn,t&qn]:0:Nn.black;if(!f){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),Nn[t])f=Nn[t];else if("#"===t.charAt(0)){if(t.length<6&&(r=t.charAt(1),i=t.charAt(2),o=t.charAt(3),t="#"+r+r+i+i+o+o+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(f=parseInt(t.substr(1,6),16))>>16,f>>8&qn,f&qn,parseInt(t.substr(7),16)/255];f=[(t=parseInt(t.substr(1),16))>>16,t>>8&qn,t&qn]}else if("hsl"===t.substr(0,3))if(f=p=t.match(ye),e){if(~t.indexOf("="))return f=t.match(me),n&&f.length<4&&(f[3]=1),f}else a=+f[0]%360/360,s=+f[1]/100,r=2*(c=+f[2]/100)-(i=c<=.5?c*(s+1):c+s-c*s),f.length>3&&(f[3]*=1),f[0]=Vn(a+1/3,r,i),f[1]=Vn(a,r,i),f[2]=Vn(a-1/3,r,i);else f=t.match(ye)||Nn.transparent;f=f.map(Number)}return e&&!p&&(r=f[0]/qn,i=f[1]/qn,o=f[2]/qn,c=((l=Math.max(r,i,o))+(u=Math.min(r,i,o)))/2,l===u?a=s=0:(h=l-u,s=c>.5?h/(2-l-u):h/(l+u),a=l===r?(i-o)/h+(i<o?6:0):l===i?(o-r)/h+2:(r-i)/h+4,a*=60),f[0]=~~(a+.5),f[1]=~~(100*s+.5),f[2]=~~(100*c+.5)),n&&f.length<4&&(f[3]=1),f},Un=function(t){var e=[],n=[],r=-1;return t.split(Gn).forEach((function(t){var i=t.match(ge)||[];e.push.apply(e,i),n.push(r+=i.length+1)})),e.c=n,e},Hn=function(t,e,n){var r,i,o,a,s="",c=(t+s).match(Gn),l=e?"hsla(":"rgba(",u=0;if(!c)return t;if(c=c.map((function(t){return(t=Wn(t,e,1))&&l+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"})),n&&(o=Un(t),(r=n.c).join(s)!==o.c.join(s)))for(a=(i=t.replace(Gn,"1").split(ge)).length-1;u<a;u++)s+=i[u]+(~r.indexOf(u)?c.shift()||l+"0,0,0,0)":(o.length?o:c.length?c:n).shift());if(!i)for(a=(i=t.split(Gn)).length-1;u<a;u++)s+=i[u]+c[u];return s+i[a]},Gn=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in Nn)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),Xn=/hsl[a]?\(/,Yn=function(t){var e,n=t.join(" ");if(Gn.lastIndex=0,Gn.test(n))return e=Xn.test(n),t[1]=Hn(t[1],e),t[0]=Hn(t[0],e,Un(t[1])),!0},Kn=(Ft=Date.now,It=500,Dt=33,qt=Ft(),Nt=qt,Wt=Vt=1e3/240,Ht=function t(e){var n,r,i,o,a=Ft()-Nt,s=!0===e;if(a>It&&(qt+=a-Dt),((n=(i=(Nt+=a)-qt)-Wt)>0||s)&&(o=++Lt.frame,Bt=i-1e3*Lt.time,Lt.time=i/=1e3,Wt+=n+(n>=Vt?4:Vt-n),r=1),s||(kt=Mt(t)),r)for(zt=0;zt<Ut.length;zt++)Ut[zt](i,Bt,o,e)},Lt={time:0,frame:0,tick:function(){Ht(!0)},deltaRatio:function(t){return Bt/(1e3/(t||60))},wake:function(){Tt&&(!Ot&&pe()&&(Rt=Ot=window,Pt=Rt.document||{},Se.gsap=Fr,(Rt.gsapVersions||(Rt.gsapVersions=[])).push(Fr.version),Oe(Re||Rt.GreenSockGlobals||!Rt.gsap&&Rt||{}),jt=Rt.requestAnimationFrame),kt&&Lt.sleep(),Mt=jt||function(t){return setTimeout(t,Wt-1e3*Lt.time+1|0)},At=1,Ht(2))},sleep:function(){(jt?Rt.cancelAnimationFrame:clearTimeout)(kt),At=0,Mt=Ce},lagSmoothing:function(t,e){It=t||1e8,Dt=Math.min(e,It,0)},fps:function(t){Vt=1e3/(t||240),Wt=1e3*Lt.time+Vt},add:function(t){Ut.indexOf(t)<0&&Ut.push(t),Qn()},remove:function(t){var e;~(e=Ut.indexOf(t))&&Ut.splice(e,1)&&zt>=e&&zt--},_listeners:Ut=[]}),Qn=function(){return!At&&Kn.wake()},Zn={},Jn=/^[\d.\-M][\d.\-,\s]/,$n=/["']/g,tr=function(t){for(var e,n,r,i={},o=t.substr(1,t.length-3).split(":"),a=o[0],s=1,c=o.length;s<c;s++)n=o[s],e=s!==c-1?n.lastIndexOf(","):n.length,r=n.substr(0,e),i[a]=isNaN(r)?r.replace($n,"").trim():+r,a=n.substr(e+1).trim();return i},er=function(t){return function(e){return 1-t(1-e)}},nr=function t(e,n){for(var r,i=e._first;i;)i instanceof ur?t(i,n):!i.vars.yoyoEase||i._yoyo&&i._repeat||i._yoyo===n||(i.timeline?t(i.timeline,n):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=n)),i=i._next},rr=function(t,e){return t&&(se(t)?t:Zn[t]||function(t){var e,n,r,i,o=(t+"").split("("),a=Zn[o[0]];return a&&o.length>1&&a.config?a.config.apply(null,~t.indexOf("{")?[tr(o[1])]:(e=t,n=e.indexOf("(")+1,r=e.indexOf(")"),i=e.indexOf("(",n),e.substring(n,~i&&i<r?e.indexOf(")",r+1):r)).split(",").map(Xe)):Zn._CE&&Jn.test(t)?Zn._CE("",t):a}(t))||e},ir=function(t,e,n,r){void 0===n&&(n=function(t){return 1-e(1-t)}),void 0===r&&(r=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var i,o={easeIn:e,easeOut:n,easeInOut:r};return Ne(t,(function(t){for(var e in Zn[t]=Se[t]=o,Zn[i=t.toLowerCase()]=n,o)Zn[i+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=Zn[t+"."+e]=o[e]})),o},or=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},ar=function t(e,n,r){var i=n>=1?n:1,o=(r||(e?.3:.45))/(n<1?n:1),a=o/te*(Math.asin(1/i)||0),s=function(t){return 1===t?1:i*Math.pow(2,-10*t)*oe((t-a)*o)+1},c="out"===e?s:"in"===e?function(t){return 1-s(1-t)}:or(s);return o=te/o,c.config=function(n,r){return t(e,n,r)},c},sr=function t(e,n){void 0===n&&(n=1.70158);var r=function(t){return t?--t*t*((n+1)*t+n)+1:0},i="out"===e?r:"in"===e?function(t){return 1-r(1-t)}:or(r);return i.config=function(n){return t(e,n)},i};Ne("Linear,Quad,Cubic,Quart,Quint,Strong",(function(t,e){var n=e<5?e+1:e;ir(t+",Power"+(n-1),e?function(t){return Math.pow(t,n)}:function(t){return t},(function(t){return 1-Math.pow(1-t,n)}),(function(t){return t<.5?Math.pow(2*t,n)/2:1-Math.pow(2*(1-t),n)/2}))})),Zn.Linear.easeNone=Zn.none=Zn.Linear.easeIn,ir("Elastic",ar("in"),ar("out"),ar()),Gt=7.5625,Yt=1/(Xt=2.75),ir("Bounce",(function(t){return 1-Kt(1-t)}),Kt=function(t){return t<Yt?Gt*t*t:t<.7272727272727273?Gt*Math.pow(t-1.5/Xt,2)+.75:t<.9090909090909092?Gt*(t-=2.25/Xt)*t+.9375:Gt*Math.pow(t-2.625/Xt,2)+.984375}),ir("Expo",(function(t){return t?Math.pow(2,10*(t-1)):0})),ir("Circ",(function(t){return-(re(1-t*t)-1)})),ir("Sine",(function(t){return 1===t?1:1-ie(t*ee)})),ir("Back",sr("in"),sr("out"),sr()),Zn.SteppedEase=Zn.steps=Se.SteppedEase={config:function(t,e){void 0===t&&(t=1);var n=1/t,r=t+(e?0:1),i=e?1:0;return function(t){return((r*xn(0,.99999999,t)|0)+i)*n}}},Zt.ease=Zn["quad.out"],Ne("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(t){return Fe+=t+","+t+"Params,"}));var cr=function(t,e){this.id=ne++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:qe,this.set=e?e.getSetter:Rr},lr=function(){function t(t,e){var n=t.parent||St;this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,mn(this,+t.duration,1,1),this.data=t.data,At||Kn.wake(),n&&fn(n,this,e||0===e?e:n._time,1),t.reversed&&this.reverse(),t.paused&&this.paused(!0)}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,mn(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(Qn(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(hn(this,t),!n._dp||n.parent||pn(n,this);n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&fn(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===$t||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),Ge(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+sn(this))%this._dur||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+sn(this),e):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(t,e){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*n,e):this._repeat?cn(this._tTime,n)+1:1},e.timeScale=function(t){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var e=this.parent&&this._ts?ln(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,on(this.totalTime(xn(-this._delay,this._tDur,e),!0))},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Qn(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&(this._tTime-=$t)&&Math.abs(this._zTime)!==$t))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&fn(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(he(t)?this.totalDuration():this.duration())/Math.abs(this._ts)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?ln(e.rawTime(t),this):this._tTime:this._tTime},e.globalTime=function(t){for(var e=this,n=arguments.length?t:e.rawTime();e;)n=e._start+n/(e._ts||1),e=e._dp;return n},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,gn(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){return arguments.length?(this._rDelay=t,gn(this)):this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(bn(this,t),he(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,he(e))},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,n=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=n&&t<this.endTime(!0)-$t))},e.eventCallback=function(t,e,n){var r=this.vars;return arguments.length>1?(e?(r[t]=e,n&&(r[t+"Params"]=n),"onUpdate"===t&&(this._onUpdate=e)):delete r[t],this):r[t]},e.then=function(t){var e=this;return new Promise((function(n){var r=se(t)?t:Ye,i=function(){var t=e.then;e.then=null,se(r)&&(r=r(e))&&(r.then||r===e)&&(e.then=t),n(r),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?i():e._prom=i}))},e.kill=function(){In(this)},t}();Ke(lr.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var ur=function(t){function e(e,n){var r;return void 0===e&&(e={}),(r=t.call(this,e,n)||this).labels={},r.smoothChildTiming=!!e.smoothChildTiming,r.autoRemoveChildren=!!e.autoRemoveChildren,r._sort=he(e.sortChildren),r.parent&&pn(r.parent,bt(r)),e.scrollTrigger&&dn(bt(r),e.scrollTrigger),r}wt(e,t);var n=e.prototype;return n.to=function(t,e,n){return new _r(t,Ue(arguments,0,this),bn(this,ce(e)?arguments[3]:n)),this},n.from=function(t,e,n){return new _r(t,Ue(arguments,1,this),bn(this,ce(e)?arguments[3]:n)),this},n.fromTo=function(t,e,n,r){return new _r(t,Ue(arguments,2,this),bn(this,ce(e)?arguments[4]:r)),this},n.set=function(t,e,n){return e.duration=0,e.parent=this,tn(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new _r(t,e,bn(this,n),1),this},n.call=function(t,e,n){return fn(this,_r.delayedCall(0,t,e),bn(this,n))},n.staggerTo=function(t,e,n,r,i,o,a){return n.duration=e,n.stagger=n.stagger||r,n.onComplete=o,n.onCompleteParams=a,n.parent=this,new _r(t,n,bn(this,i)),this},n.staggerFrom=function(t,e,n,r,i,o,a){return n.runBackwards=1,tn(n).immediateRender=he(n.immediateRender),this.staggerTo(t,e,n,r,i,o,a)},n.staggerFromTo=function(t,e,n,r,i,o,a,s){return r.startAt=n,tn(r).immediateRender=he(r.immediateRender),this.staggerTo(t,e,r,i,o,a,s)},n.render=function(t,e,n){var r,i,o,a,s,c,l,u,h,p,f,d,v=this._time,y=this._dirty?this.totalDuration():this._tDur,m=this._dur,g=this!==St&&t>y-$t&&t>=0?y:t<$t?0:t,_=this._zTime<0!=t<0&&(this._initted||!m);if(g!==this._tTime||n||_){if(v!==this._time&&m&&(g+=this._time-v,t+=this._time-v),r=g,h=this._start,c=!(u=this._ts),_&&(m||(v=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(f=this._yoyo,s=m+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*s+t,e,n);if(r=Ve(g%s),g===y?(a=this._repeat,r=m):((a=~~(g/s))&&a===g/s&&(r=m,a--),r>m&&(r=m)),p=cn(this._tTime,s),!v&&this._tTime&&p!==a&&(p=a),f&&1&a&&(r=m-r,d=1),a!==p&&!this._lock){var b=f&&1&p,w=b===(f&&1&a);if(a<p&&(b=!b),v=b?0:m,this._lock=1,this.render(v||(d?0:Ve(a*s)),e,!m)._lock=0,!e&&this.parent&&Fn(this,"onRepeat"),this.vars.repeatRefresh&&!d&&(this.invalidate()._lock=1),v!==this._time||c!==!this._ts)return this;if(m=this._dur,y=this._tDur,w&&(this._lock=2,v=b?m:-1e-4,this.render(v,!0),this.vars.repeatRefresh&&!d&&this.invalidate()),this._lock=0,!this._ts&&!c)return this;nr(this,d)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(l=function(t,e,n){var r;if(n>e)for(r=t._first;r&&r._start<=n;){if(!r._dur&&"isPause"===r.data&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=n;){if(!r._dur&&"isPause"===r.data&&r._start<e)return r;r=r._prev}}(this,Ve(v),Ve(r)))&&(g-=r-(r=l._start)),this._tTime=g,this._time=r,this._act=!u,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,v=0),!v&&(r||!m&&t>=0)&&!e&&Fn(this,"onStart"),r>=v&&t>=0)for(i=this._first;i;){if(o=i._next,(i._act||r>=i._start)&&i._ts&&l!==i){if(i.parent!==this)return this.render(t,e,n);if(i.render(i._ts>0?(r-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(r-i._start)*i._ts,e,n),r!==this._time||!this._ts&&!c){l=0,o&&(g+=this._zTime=-1e-8);break}}i=o}else{i=this._last;for(var x=t<0?t:r;i;){if(o=i._prev,(i._act||x<=i._end)&&i._ts&&l!==i){if(i.parent!==this)return this.render(t,e,n);if(i.render(i._ts>0?(x-i._start)*i._ts:(i._dirty?i.totalDuration():i._tDur)+(x-i._start)*i._ts,e,n),r!==this._time||!this._ts&&!c){l=0,o&&(g+=this._zTime=x?-1e-8:$t);break}}i=o}}if(l&&!e&&(this.pause(),l.render(r>=v?0:-1e-8)._zTime=r>=v?1:-1,this._ts))return this._start=h,un(this),this.render(t,e,n);this._onUpdate&&!e&&Fn(this,"onUpdate",!0),(g===y&&y>=this.totalDuration()||!g&&v)&&(h!==this._start&&Math.abs(u)===Math.abs(this._ts)||this._lock||((t||!m)&&(g===y&&this._ts>0||!g&&this._ts<0)&&nn(this,1),e||t<0&&!v||!g&&!v||(Fn(this,g===y?"onComplete":"onReverseComplete",!0),this._prom&&!(g<y&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(t,e){var n=this;if(ce(e)||(e=bn(this,e)),!(t instanceof lr)){if(ve(t))return t.forEach((function(t){return n.add(t,e)})),this;if(ae(t))return this.addLabel(t,e);if(!se(t))return this;t=_r.delayedCall(0,t)}return this!==t?fn(this,t,e):this},n.getChildren=function(t,e,n,r){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===r&&(r=-Jt);for(var i=[],o=this._first;o;)o._start>=r&&(o instanceof _r?e&&i.push(o):(n&&i.push(o),t&&i.push.apply(i,o.getChildren(!0,e,n)))),o=o._next;return i},n.getById=function(t){for(var e=this.getChildren(1,1,1),n=e.length;n--;)if(e[n].vars.id===t)return e[n]},n.remove=function(t){return ae(t)?this.removeLabel(t):se(t)?this.killTweensOf(t):(en(this,t),t===this._recent&&(this._recent=this._last),rn(this))},n.totalTime=function(e,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Ve(Kn.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,n),this._forcing=0,this):this._tTime},n.addLabel=function(t,e){return this.labels[t]=bn(this,e),this},n.removeLabel=function(t){return delete this.labels[t],this},n.addPause=function(t,e,n){var r=_r.delayedCall(0,e||Ce,n);return r.data="isPause",this._hasPause=1,fn(this,r,bn(this,t))},n.removePause=function(t){var e=this._first;for(t=bn(this,t);e;)e._start===t&&"isPause"===e.data&&nn(e),e=e._next},n.killTweensOf=function(t,e,n){for(var r=this.getTweensOf(t,n),i=r.length;i--;)hr!==r[i]&&r[i].kill(t,e);return this},n.getTweensOf=function(t,e){for(var n,r=[],i=Tn(t),o=this._first,a=ce(e);o;)o instanceof _r?We(o._targets,i)&&(a?(!hr||o._initted&&o._ts)&&o.globalTime(0)<=e&&o.globalTime(o.totalDuration())>e:!e||o.isActive())&&r.push(o):(n=o.getTweensOf(i,e)).length&&r.push.apply(r,n),o=o._next;return r},n.tweenTo=function(t,e){e=e||{};var n=this,r=bn(n,t),i=e,o=i.startAt,a=i.onStart,s=i.onStartParams,c=i.immediateRender,l=_r.to(n,Ke({ease:"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:e.duration||Math.abs((r-(o&&"time"in o?o.time:n._time))/n.timeScale())||$t,onStart:function(){n.pause();var t=e.duration||Math.abs((r-n._time)/n.timeScale());l._dur!==t&&mn(l,t,0,1).render(l._time,!0,!0),a&&a.apply(l,s||[])}},e));return c?l.render(0):l},n.tweenFromTo=function(t,e,n){return this.tweenTo(e,Ke({startAt:{time:bn(this,t)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(t){return void 0===t&&(t=this._time),zn(this,bn(this,t))},n.previousLabel=function(t){return void 0===t&&(t=this._time),zn(this,bn(this,t),1)},n.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+$t)},n.shiftChildren=function(t,e,n){void 0===n&&(n=0);for(var r,i=this._first,o=this.labels;i;)i._start>=n&&(i._start+=t,i._end+=t),i=i._next;if(e)for(r in o)o[r]>=n&&(o[r]+=t);return rn(this)},n.invalidate=function(){var e=this._first;for(this._lock=0;e;)e.invalidate(),e=e._next;return t.prototype.invalidate.call(this)},n.clear=function(t){void 0===t&&(t=!0);for(var e,n=this._first;n;)e=n._next,this.remove(n),n=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),rn(this)},n.totalDuration=function(t){var e,n,r,i=0,o=this,a=o._last,s=Jt;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-t:t));if(o._dirty){for(r=o.parent;a;)e=a._prev,a._dirty&&a.totalDuration(),(n=a._start)>s&&o._sort&&a._ts&&!o._lock?(o._lock=1,fn(o,a,n-a._delay,1)._lock=0):s=n,n<0&&a._ts&&(i-=n,(!r&&!o._dp||r&&r.smoothChildTiming)&&(o._start+=n/o._ts,o._time-=n,o._tTime-=n),o.shiftChildren(-n,!1,-Infinity),s=0),a._end>i&&a._ts&&(i=a._end),a=e;mn(o,o===St&&o._time>i?o._time:i,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(t){if(St._ts&&(Ge(St,ln(t,St)),Et=Kn.frame),Kn.frame>=Be){Be+=Qt.autoSleep||120;var e=St._first;if((!e||!e._ts)&&Qt.autoSleep&&Kn._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||Kn.sleep()}}},e}(lr);Ke(ur.prototype,{_lock:0,_hasPause:0,_forcing:0});var hr,pr=function(t,e,n,r,i,o,a){var s,c,l,u,h,p,f,d,v=new jr(this._pt,t,e,0,1,Tr,null,i),y=0,m=0;for(v.b=n,v.e=r,n+="",(f=~(r+="").indexOf("random("))&&(r=Ln(r)),o&&(o(d=[n,r],t,e),n=d[0],r=d[1]),c=n.match(_e)||[];s=_e.exec(r);)u=s[0],h=r.substring(y,s.index),l?l=(l+1)%5:"rgba("===h.substr(-5)&&(l=1),u!==c[m++]&&(p=parseFloat(c[m-1])||0,v._pt={_next:v._pt,p:h||1===m?h:",",s:p,c:"="===u.charAt(1)?parseFloat(u.substr(2))*("-"===u.charAt(0)?-1:1):parseFloat(u)-p,m:l&&l<4?Math.round:0},y=_e.lastIndex);return v.c=y<r.length?r.substring(y,r.length):"",v.fp=a,(be.test(r)||f)&&(v.e=0),this._pt=v,v},fr=function(t,e,n,r,i,o,a,s,c){se(r)&&(r=r(i||0,t,o));var l,u=t[e],h="get"!==n?n:se(u)?c?t[e.indexOf("set")||!se(t["get"+e.substr(3)])?e:"get"+e.substr(3)](c):t[e]():u,p=se(u)?c?xr:wr:br;if(ae(r)&&(~r.indexOf("random(")&&(r=Ln(r)),"="===r.charAt(1)&&(r=parseFloat(h)+parseFloat(r.substr(2))*("-"===r.charAt(0)?-1:1)+(Sn(h)||0))),h!==r)return isNaN(h*r)?(!u&&!(e in t)&&Pe(e,r),pr.call(this,t,e,h,r,p,s||Qt.stringFilter,c)):(l=new jr(this._pt,t,e,+h||0,r-(h||0),"boolean"==typeof u?Pr:Or,0,p),c&&(l.fp=c),a&&l.modifier(a,this,t),this._pt=l)},dr=function(t,e,n,r,i,o){var a,s,c,l;if(je[t]&&!1!==(a=new je[t]).init(i,a.rawVars?e[t]:function(t,e,n,r,i){if(se(t)&&(t=yr(t,i,e,n,r)),!ue(t)||t.style&&t.nodeType||ve(t)||de(t))return ae(t)?yr(t,i,e,n,r):t;var o,a={};for(o in t)a[o]=yr(t[o],i,e,n,r);return a}(e[t],r,i,o,n),n,r,o)&&(n._pt=s=new jr(n._pt,i,t,0,1,a.render,a,0,a.priority),n!==Ct))for(c=n._ptLookup[n._targets.indexOf(i)],l=a._props.length;l--;)c[a._props[l]]=s;return a},vr=function t(e,n){var r,i,o,a,s,c,l,u,h,p,f,d,v,y=e.vars,m=y.ease,g=y.startAt,_=y.immediateRender,b=y.lazy,w=y.onUpdate,x=y.onUpdateParams,S=y.callbackScope,R=y.runBackwards,O=y.yoyoEase,P=y.keyframes,T=y.autoRevert,E=e._dur,C=e._startAt,A=e._targets,k=e.parent,M=k&&"nested"===k.data?k.parent._targets:A,j="auto"===e._overwrite&&!xt,L=e.timeline;if(L&&(!P||!m)&&(m="none"),e._ease=rr(m,Zt.ease),e._yEase=O?er(rr(!0===O?m:O,Zt.ease)):0,O&&e._yoyo&&!e._repeat&&(O=e._yEase,e._yEase=e._ease,e._ease=O),!L){if(d=(u=A[0]?De(A[0]).harness:0)&&y[u.prop],r=$e(y,Ae),C&&C.render(-1,!0).kill(),g){if(nn(e._startAt=_r.set(A,Ke({data:"isStart",overwrite:!1,parent:k,immediateRender:!0,lazy:he(b),startAt:null,delay:0,onUpdate:w,onUpdateParams:x,callbackScope:S,stagger:0},g))),_)if(n>0)T||(e._startAt=0);else if(E&&!(n<0&&C))return void(n&&(e._zTime=n))}else if(R&&E)if(C)!T&&(e._startAt=0);else if(n&&(_=!1),o=Ke({overwrite:!1,data:"isFromStart",lazy:_&&he(b),immediateRender:_,stagger:0,parent:k},r),d&&(o[u.prop]=d),nn(e._startAt=_r.set(A,o)),_){if(!n)return}else t(e._startAt,$t);for(e._pt=0,b=E&&he(b)||b&&!E,i=0;i<A.length;i++){if(l=(s=A[i])._gsap||Ie(A)[i]._gsap,e._ptLookup[i]=p={},Me[l.id]&&ke.length&&He(),f=M===A?i:M.indexOf(s),u&&!1!==(h=new u).init(s,d||r,e,f,M)&&(e._pt=a=new jr(e._pt,s,h.name,0,1,h.render,h,0,h.priority),h._props.forEach((function(t){p[t]=a})),h.priority&&(c=1)),!u||d)for(o in r)je[o]&&(h=dr(o,r,e,f,s,M))?h.priority&&(c=1):p[o]=a=fr.call(e,s,o,"get",r[o],f,M,0,y.stringFilter);e._op&&e._op[i]&&e.kill(s,e._op[i]),j&&e._pt&&(hr=e,St.killTweensOf(s,p,e.globalTime(0)),v=!e.parent,hr=0),e._pt&&b&&(Me[l.id]=1)}c&&Mr(e),e._onInit&&e._onInit(e)}e._from=!L&&!!y.runBackwards,e._onUpdate=w,e._initted=(!e._op||e._pt)&&!v},yr=function(t,e,n,r,i){return se(t)?t.call(e,n,r,i):ae(t)&&~t.indexOf("random(")?Ln(t):t},mr=Fe+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",gr=(mr+",id,stagger,delay,duration,paused,scrollTrigger").split(","),_r=function(t){function e(e,n,r,i){var o;"number"==typeof n&&(r.duration=n,n=r,r=null);var a,s,c,l,u,h,p,f,d=(o=t.call(this,i?n:tn(n),r)||this).vars,v=d.duration,y=d.delay,m=d.immediateRender,g=d.stagger,_=d.overwrite,b=d.keyframes,w=d.defaults,x=d.scrollTrigger,S=d.yoyoEase,R=o.parent,O=(ve(e)||de(e)?ce(e[0]):"length"in n)?[e]:Tn(e);if(o._targets=O.length?Ie(O):Te("GSAP target "+e+" not found. https://greensock.com",!Qt.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=_,b||g||fe(v)||fe(y)){if(n=o.vars,(a=o.timeline=new ur({data:"nested",defaults:w||{}})).kill(),a.parent=a._dp=bt(o),a._start=0,b)Ke(a.vars.defaults,{ease:"none"}),b.forEach((function(t){return a.to(O,t,">")}));else{if(l=O.length,p=g?Cn(g):Ce,ue(g))for(u in g)~mr.indexOf(u)&&(f||(f={}),f[u]=g[u]);for(s=0;s<l;s++){for(u in c={},n)gr.indexOf(u)<0&&(c[u]=n[u]);c.stagger=0,S&&(c.yoyoEase=S),f&&Ze(c,f),h=O[s],c.duration=+yr(v,bt(o),s,h,O),c.delay=(+yr(y,bt(o),s,h,O)||0)-o._delay,!g&&1===l&&c.delay&&(o._delay=y=c.delay,o._start+=y,c.delay=0),a.to(h,c,p(s,h,O))}a.duration()?v=y=0:o.timeline=0}v||o.duration(v=a.duration())}else o.timeline=0;return!0!==_||xt||(hr=bt(o),St.killTweensOf(O),hr=0),R&&pn(R,bt(o)),(m||!v&&!b&&o._start===Ve(R._time)&&he(m)&&an(bt(o))&&"nested"!==R.data)&&(o._tTime=-1e-8,o.render(Math.max(0,-y))),x&&dn(bt(o),x),o}wt(e,t);var n=e.prototype;return n.render=function(t,e,n){var r,i,o,a,s,c,l,u,h,p=this._time,f=this._tDur,d=this._dur,v=t>f-$t&&t>=0?f:t<$t?0:t;if(d){if(v!==this._tTime||!t||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=t<0){if(r=v,u=this.timeline,this._repeat){if(a=d+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*a+t,e,n);if(r=Ve(v%a),v===f?(o=this._repeat,r=d):((o=~~(v/a))&&o===v/a&&(r=d,o--),r>d&&(r=d)),(c=this._yoyo&&1&o)&&(h=this._yEase,r=d-r),s=cn(this._tTime,a),r===p&&!n&&this._initted)return this;o!==s&&(u&&this._yEase&&nr(u,c),!this.vars.repeatRefresh||c||this._lock||(this._lock=n=1,this.render(Ve(a*o),!0).invalidate()._lock=0))}if(!this._initted){if(vn(this,t<0?t:r,n,e))return this._tTime=0,this;if(d!==this._dur)return this.render(t,e,n)}for(this._tTime=v,this._time=r,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=l=(h||this._ease)(r/d),this._from&&(this.ratio=l=1-l),r&&!p&&!e&&Fn(this,"onStart"),i=this._pt;i;)i.r(l,i.d),i=i._next;u&&u.render(t<0?t:!r&&c?-1e-8:u._dur*l,e,n)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(t<0&&this._startAt&&this._startAt.render(t,!0,n),Fn(this,"onUpdate")),this._repeat&&o!==s&&this.vars.onRepeat&&!e&&this.parent&&Fn(this,"onRepeat"),v!==this._tDur&&v||this._tTime!==v||(t<0&&this._startAt&&!this._onUpdate&&this._startAt.render(t,!0,!0),(t||!d)&&(v===this._tDur&&this._ts>0||!v&&this._ts<0)&&nn(this,1),e||t<0&&!p||!v&&!p||(Fn(this,v===f?"onComplete":"onReverseComplete",!0),this._prom&&!(v<f&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,n,r){var i,o,a,s=t.ratio,c=e<0||!e&&(!t._start&&yn(t)||(t._ts<0||t._dp._ts<0)&&"isFromStart"!==t.data&&"isStart"!==t.data)?0:1,l=t._rDelay,u=0;if(l&&t._repeat&&(u=xn(0,t._tDur,e),o=cn(u,l),a=cn(t._tTime,l),t._yoyo&&1&o&&(c=1-c),o!==a&&(s=1-c,t.vars.repeatRefresh&&t._initted&&t.invalidate())),c!==s||r||t._zTime===$t||!e&&t._zTime){if(!t._initted&&vn(t,e,r,n))return;for(a=t._zTime,t._zTime=e||(n?$t:0),n||(n=e&&!a),t.ratio=c,t._from&&(c=1-c),t._time=0,t._tTime=u,n||Fn(t,"onStart"),i=t._pt;i;)i.r(c,i.d),i=i._next;t._startAt&&e<0&&t._startAt.render(e,!0,!0),t._onUpdate&&!n&&Fn(t,"onUpdate"),u&&t._repeat&&!n&&t.parent&&Fn(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===c&&(c&&nn(t,1),n||(Fn(t,c?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,n);return this},n.targets=function(){return this._targets},n.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),t.prototype.invalidate.call(this)},n.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?In(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,hr&&!0!==hr.vars.overwrite)._first||In(this),this.parent&&n!==this.timeline.totalDuration()&&mn(this,this._dur*this.timeline._tDur/n,0,1),this}var r,i,o,a,s,c,l,u=this._targets,h=t?Tn(t):u,p=this._ptLookup,f=this._pt;if((!e||"all"===e)&&function(t,e){for(var n=t.length,r=n===e.length;r&&n--&&t[n]===e[n];);return n<0}(u,h))return"all"===e&&(this._pt=0),In(this);for(r=this._op=this._op||[],"all"!==e&&(ae(e)&&(s={},Ne(e,(function(t){return s[t]=1})),e=s),e=function(t,e){var n,r,i,o,a=t[0]?De(t[0]).harness:0,s=a&&a.aliases;if(!s)return e;for(r in n=Ze({},e),s)if(r in n)for(i=(o=s[r].split(",")).length;i--;)n[o[i]]=n[r];return n}(u,e)),l=u.length;l--;)if(~h.indexOf(u[l]))for(s in i=p[l],"all"===e?(r[l]=e,a=i,o={}):(o=r[l]=r[l]||{},a=e),a)(c=i&&i[s])&&("kill"in c.d&&!0!==c.d.kill(s)||en(this,c,"_pt"),delete i[s]),"all"!==o&&(o[s]=1);return this._initted&&!this._pt&&f&&In(this),this},e.to=function(t,n){return new e(t,n,arguments[2])},e.from=function(t,n){return new e(t,Ue(arguments,1))},e.delayedCall=function(t,n,r,i){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:n,onReverseComplete:n,onCompleteParams:r,onReverseCompleteParams:r,callbackScope:i})},e.fromTo=function(t,n,r){return new e(t,Ue(arguments,2))},e.set=function(t,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(t,n)},e.killTweensOf=function(t,e,n){return St.killTweensOf(t,e,n)},e}(lr);Ke(_r.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),Ne("staggerTo,staggerFrom,staggerFromTo",(function(t){_r[t]=function(){var e=new ur,n=Rn.call(arguments,0);return n.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,n)}}));var br=function(t,e,n){return t[e]=n},wr=function(t,e,n){return t[e](n)},xr=function(t,e,n,r){return t[e](r.fp,n)},Sr=function(t,e,n){return t.setAttribute(e,n)},Rr=function(t,e){return se(t[e])?wr:le(t[e])&&t.setAttribute?Sr:br},Or=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4,e)},Pr=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Tr=function(t,e){var n=e._pt,r="";if(!t&&e.b)r=e.b;else if(1===t&&e.e)r=e.e;else{for(;n;)r=n.p+(n.m?n.m(n.s+n.c*t):Math.round(1e4*(n.s+n.c*t))/1e4)+r,n=n._next;r+=e.c}e.set(e.t,e.p,r,e)},Er=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},Cr=function(t,e,n,r){for(var i,o=this._pt;o;)i=o._next,o.p===r&&o.modifier(t,e,n),o=i},Ar=function(t){for(var e,n,r=this._pt;r;)n=r._next,r.p===t&&!r.op||r.op===t?en(this,r,"_pt"):r.dep||(e=1),r=n;return!e},kr=function(t,e,n,r){r.mSet(t,e,r.m.call(r.tween,n,r.mt),r)},Mr=function(t){for(var e,n,r,i,o=t._pt;o;){for(e=o._next,n=r;n&&n.pr>o.pr;)n=n._next;(o._prev=n?n._prev:i)?o._prev._next=o:r=o,(o._next=n)?n._prev=o:i=o,o=e}t._pt=r},jr=function(){function t(t,e,n,r,i,o,a,s,c){this.t=e,this.s=r,this.c=i,this.p=n,this.r=o||Or,this.d=a||this,this.set=s||br,this.pr=c||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,n){this.mSet=this.mSet||this.set,this.set=kr,this.m=t,this.mt=n,this.tween=e},t}();Ne(Fe+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(t){return Ae[t]=1})),Se.TweenMax=Se.TweenLite=_r,Se.TimelineLite=Se.TimelineMax=ur,St=new ur({sortChildren:!1,defaults:Zt,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),Qt.stringFilter=Yn;var Lr={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((function(t){return Dn(t)}))},timeline:function(t){return new ur(t)},getTweensOf:function(t,e){return St.getTweensOf(t,e)},getProperty:function(t,e,n,r){ae(t)&&(t=Tn(t)[0]);var i=De(t||{}).get,o=n?Ye:Xe;return"native"===n&&(n=""),t?e?o((je[e]&&je[e].get||i)(t,e,n,r)):function(e,n,r){return o((je[e]&&je[e].get||i)(t,e,n,r))}:t},quickSetter:function(t,e,n){if((t=Tn(t)).length>1){var r=t.map((function(t){return Fr.quickSetter(t,e,n)})),i=r.length;return function(t){for(var e=i;e--;)r[e](t)}}t=t[0]||{};var o=je[e],a=De(t),s=a.harness&&(a.harness.aliases||{})[e]||e,c=o?function(e){var r=new o;Ct._pt=0,r.init(t,n?e+n:e,Ct,0,[t]),r.render(1,r),Ct._pt&&Er(1,Ct)}:a.set(t,s);return o?c:function(e){return c(t,s,n?e+n:e,a,1)}},isTweening:function(t){return St.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=rr(t.ease,Zt.ease)),Je(Zt,t||{})},config:function(t){return Je(Qt,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,r=t.plugins,i=t.defaults,o=t.extendTimeline;(r||"").split(",").forEach((function(t){return t&&!je[t]&&!Se[t]&&Te(e+" effect requires "+t+" plugin.")})),Le[e]=function(t,e,r){return n(Tn(t),Ke(e||{},i),r)},o&&(ur.prototype[e]=function(t,n,r){return this.add(Le[e](t,ue(n)?n:(r=n)&&{},this),r)})},registerEase:function(t,e){Zn[t]=rr(e)},parseEase:function(t,e){return arguments.length?rr(t,e):Zn},getById:function(t){return St.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var n,r,i=new ur(t);for(i.smoothChildTiming=he(t.smoothChildTiming),St.remove(i),i._dp=0,i._time=i._tTime=St._time,n=St._first;n;)r=n._next,!e&&!n._dur&&n instanceof _r&&n.vars.onComplete===n._targets[0]||fn(i,n,n._start-n._delay),n=r;return fn(St,i,0),i},utils:{wrap:function t(e,n,r){var i=n-e;return ve(e)?jn(e,t(0,e.length),n):wn(r,(function(t){return(i+(t-e)%i)%i+e}))},wrapYoyo:function t(e,n,r){var i=n-e,o=2*i;return ve(e)?jn(e,t(0,e.length-1),n):wn(r,(function(t){return e+((t=(o+(t-e)%o)%o||0)>i?o-t:t)}))},distribute:Cn,random:Mn,snap:kn,normalize:function(t,e,n){return Bn(t,e,0,1,n)},getUnit:Sn,clamp:function(t,e,n){return wn(n,(function(n){return xn(t,e,n)}))},splitColor:Wn,toArray:Tn,mapRange:Bn,pipe:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce((function(t,e){return e(t)}),t)}},unitize:function(t,e){return function(n){return t(parseFloat(n))+(e||Sn(n))}},interpolate:function t(e,n,r,i){var o=isNaN(e+n)?0:function(t){return(1-t)*e+t*n};if(!o){var a,s,c,l,u,h=ae(e),p={};if(!0===r&&(i=1)&&(r=null),h)e={p:e},n={p:n};else if(ve(e)&&!ve(n)){for(c=[],l=e.length,u=l-2,s=1;s<l;s++)c.push(t(e[s-1],e[s]));l--,o=function(t){t*=l;var e=Math.min(u,~~t);return c[e](t-e)},r=n}else i||(e=Ze(ve(e)?[]:{},e));if(!c){for(a in n)fr.call(p,e,a,"get",n[a]);o=function(t){return Er(t,p)||(h?e.p:e)}}}return wn(r,o)},shuffle:En},install:Oe,effects:Le,ticker:Kn,updateRoot:ur.updateRoot,plugins:je,globalTimeline:St,core:{PropTween:jr,globals:Ee,Tween:_r,Timeline:ur,Animation:lr,getCache:De,_removeLinkedListItem:en,suppressOverwrites:function(t){return xt=t}}};Ne("to,from,fromTo,delayedCall,set,killTweensOf",(function(t){return Lr[t]=_r[t]})),Kn.add(ur.updateRoot),Ct=Lr.to({},{duration:0});var Br=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},zr=function(t,e){return{name:t,rawVars:1,init:function(t,n,r){r._onInit=function(t){var r,i;if(ae(n)&&(r={},Ne(n,(function(t){return r[t]=1})),n=r),e){for(i in r={},n)r[i]=e(n[i]);n=r}!function(t,e){var n,r,i,o=t._targets;for(n in e)for(r=o.length;r--;)(i=t._ptLookup[r][n])&&(i=i.d)&&(i._pt&&(i=Br(i,n)),i&&i.modifier&&i.modifier(e[n],t,o[r],n))}(t,n)}}}},Fr=Lr.registerPlugin({name:"attr",init:function(t,e,n,r,i){var o,a;for(o in e)(a=this.add(t,"setAttribute",(t.getAttribute(o)||0)+"",e[o],r,i,0,0,o))&&(a.op=o),this._props.push(o)}},{name:"endArray",init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n])}},zr("roundProps",An),zr("modifiers"),zr("snap",kn))||Lr;_r.version=ur.version=Fr.version="3.6.0",Tt=1,pe()&&Qn();Zn.Power0,Zn.Power1,Zn.Power2,Zn.Power3,Zn.Power4,Zn.Linear,Zn.Quad,Zn.Cubic,Zn.Quart,Zn.Quint,Zn.Strong,Zn.Elastic,Zn.Back,Zn.SteppedEase,Zn.Bounce,Zn.Sine,Zn.Expo,Zn.Circ;var Ir,Dr,qr,Nr,Vr,Wr,Ur,Hr,Gr={},Xr=180/Math.PI,Yr=Math.PI/180,Kr=Math.atan2,Qr=/([A-Z])/g,Zr=/(?:left|right|width|margin|padding|x)/i,Jr=/[\s,\(]\S/,$r={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},ti=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},ei=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},ni=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},ri=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},ii=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},oi=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},ai=function(t,e,n){return t.style[e]=n},si=function(t,e,n){return t.style.setProperty(e,n)},ci=function(t,e,n){return t._gsap[e]=n},li=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},ui=function(t,e,n,r,i){var o=t._gsap;o.scaleX=o.scaleY=n,o.renderTransform(i,o)},hi=function(t,e,n,r,i){var o=t._gsap;o[e]=n,o.renderTransform(i,o)},pi="transform",fi=pi+"Origin",di=function(t,e){var n=Dr.createElementNS?Dr.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Dr.createElement(t);return n.style?n:Dr.createElement(t)},vi=function t(e,n,r){var i=getComputedStyle(e);return i[n]||i.getPropertyValue(n.replace(Qr,"-$1").toLowerCase())||i.getPropertyValue(n)||!r&&t(e,mi(n)||n,1)||""},yi="O,Moz,ms,Ms,Webkit".split(","),mi=function(t,e,n){var r=(e||Vr).style,i=5;if(t in r&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);i--&&!(yi[i]+t in r););return i<0?null:(3===i?"ms":i>=0?yi[i]:"")+t},gi=function(){"undefined"!=typeof window&&window.document&&(Ir=window,Dr=Ir.document,qr=Dr.documentElement,Vr=di("div")||{style:{}},Wr=di("div"),pi=mi(pi),fi=pi+"Origin",Vr.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Hr=!!mi("perspective"),Nr=1)},_i=function t(e){var n,r=di("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,o=this.nextSibling,a=this.style.cssText;if(qr.appendChild(r),r.appendChild(this),this.style.display="block",e)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch(s){}else this._gsapBBox&&(n=this._gsapBBox());return i&&(o?i.insertBefore(this,o):i.appendChild(this)),qr.removeChild(r),this.style.cssText=a,n},bi=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},wi=function(t){var e;try{e=t.getBBox()}catch(n){e=_i.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===_i||(e=_i.call(t,!0)),!e||e.width||e.x||e.y?e:{x:+bi(t,["x","cx","x1"])||0,y:+bi(t,["y","cy","y1"])||0,width:0,height:0}},xi=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!wi(t))},Si=function(t,e){if(e){var n=t.style;e in Gr&&e!==fi&&(e=pi),n.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),n.removeProperty(e.replace(Qr,"-$1").toLowerCase())):n.removeAttribute(e)}},Ri=function(t,e,n,r,i,o){var a=new jr(t._pt,e,n,0,1,o?oi:ii);return t._pt=a,a.b=r,a.e=i,t._props.push(n),a},Oi={deg:1,rad:1,turn:1},Pi=function t(e,n,r,i){var o,a,s,c,l=parseFloat(r)||0,u=(r+"").trim().substr((l+"").length)||"px",h=Vr.style,p=Zr.test(n),f="svg"===e.tagName.toLowerCase(),d=(f?"client":"offset")+(p?"Width":"Height"),v=100,y="px"===i,m="%"===i;return i===u||!l||Oi[i]||Oi[u]?l:("px"!==u&&!y&&(l=t(e,n,r,"px")),c=e.getCTM&&xi(e),!m&&"%"!==u||!Gr[n]&&!~n.indexOf("adius")?(h[p?"width":"height"]=v+(y?u:i),a=~n.indexOf("adius")||"em"===i&&e.appendChild&&!f?e:e.parentNode,c&&(a=(e.ownerSVGElement||{}).parentNode),a&&a!==Dr&&a.appendChild||(a=Dr.body),(s=a._gsap)&&m&&s.width&&p&&s.time===Kn.time?Ve(l/s.width*v):((m||"%"===u)&&(h.position=vi(e,"position")),a===e&&(h.position="static"),a.appendChild(Vr),o=Vr[d],a.removeChild(Vr),h.position="absolute",p&&m&&((s=De(a)).time=Kn.time,s.width=a[d]),Ve(y?o*l/v:o&&l?v/o*l:0))):(o=c?e.getBBox()[p?"width":"height"]:e[d],Ve(m?l/o*v:l/100*o)))},Ti=function(t,e,n,r){var i;return Nr||gi(),e in $r&&"transform"!==e&&~(e=$r[e]).indexOf(",")&&(e=e.split(",")[0]),Gr[e]&&"transform"!==e?(i=Ii(t,r),i="transformOrigin"!==e?i[e]:Di(vi(t,fi))+" "+i.zOrigin+"px"):(!(i=t.style[e])||"auto"===i||r||~(i+"").indexOf("calc("))&&(i=ki[e]&&ki[e](t,e,n)||vi(t,e)||qe(t,e)||("opacity"===e?1:0)),n&&!~(i+"").trim().indexOf(" ")?Pi(t,e,i,n)+n:i},Ei=function(t,e,n,r){if(!n||"none"===n){var i=mi(e,t,1),o=i&&vi(t,i,1);o&&o!==n?(e=i,n=o):"borderColor"===e&&(n=vi(t,"borderTopColor"))}var a,s,c,l,u,h,p,f,d,v,y,m,g=new jr(this._pt,t.style,e,0,1,Tr),_=0,b=0;if(g.b=n,g.e=r,n+="","auto"===(r+="")&&(t.style[e]=r,r=vi(t,e)||r,t.style[e]=n),Yn(a=[n,r]),r=a[1],c=(n=a[0]).match(ge)||[],(r.match(ge)||[]).length){for(;s=ge.exec(r);)p=s[0],d=r.substring(_,s.index),u?u=(u+1)%5:"rgba("!==d.substr(-5)&&"hsla("!==d.substr(-5)||(u=1),p!==(h=c[b++]||"")&&(l=parseFloat(h)||0,y=h.substr((l+"").length),(m="="===p.charAt(1)?+(p.charAt(0)+"1"):0)&&(p=p.substr(2)),f=parseFloat(p),v=p.substr((f+"").length),_=ge.lastIndex-v.length,v||(v=v||Qt.units[e]||y,_===r.length&&(r+=v,g.e+=v)),y!==v&&(l=Pi(t,e,h,v)||0),g._pt={_next:g._pt,p:d||1===b?d:",",s:l,c:m?m*f:f-l,m:u&&u<4||"zIndex"===e?Math.round:0});g.c=_<r.length?r.substring(_,r.length):""}else g.r="display"===e&&"none"===r?oi:ii;return be.test(r)&&(g.e=0),this._pt=g,g},Ci={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Ai=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n,r,i,o=e.t,a=o.style,s=e.u,c=o._gsap;if("all"===s||!0===s)a.cssText="",r=1;else for(i=(s=s.split(",")).length;--i>-1;)n=s[i],Gr[n]&&(r=1,n="transformOrigin"===n?fi:pi),Si(o,n);r&&(Si(o,pi),c&&(c.svg&&o.removeAttribute("transform"),Ii(o,1),c.uncache=1))}},ki={clearProps:function(t,e,n,r,i){if("isFromStart"!==i.data){var o=t._pt=new jr(t._pt,e,n,0,0,Ai);return o.u=r,o.pr=-10,o.tween=i,t._props.push(n),1}}},Mi=[1,0,0,1,0,0],ji={},Li=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},Bi=function(t){var e=vi(t,pi);return Li(e)?Mi:e.substr(7).match(me).map(Ve)},zi=function(t,e){var n,r,i,o,a=t._gsap||De(t),s=t.style,c=Bi(t);return a.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(c=[(i=t.transform.baseVal.consolidate().matrix).a,i.b,i.c,i.d,i.e,i.f]).join(",")?Mi:c:(c!==Mi||t.offsetParent||t===qr||a.svg||(i=s.display,s.display="block",(n=t.parentNode)&&t.offsetParent||(o=1,r=t.nextSibling,qr.appendChild(t)),c=Bi(t),i?s.display=i:Si(t,"display"),o&&(r?n.insertBefore(t,r):n?n.appendChild(t):qr.removeChild(t))),e&&c.length>6?[c[0],c[1],c[4],c[5],c[12],c[13]]:c)},Fi=function(t,e,n,r,i,o){var a,s,c,l=t._gsap,u=i||zi(t,!0),h=l.xOrigin||0,p=l.yOrigin||0,f=l.xOffset||0,d=l.yOffset||0,v=u[0],y=u[1],m=u[2],g=u[3],_=u[4],b=u[5],w=e.split(" "),x=parseFloat(w[0])||0,S=parseFloat(w[1])||0;n?u!==Mi&&(s=v*g-y*m)&&(c=x*(-y/s)+S*(v/s)-(v*b-y*_)/s,x=x*(g/s)+S*(-m/s)+(m*b-g*_)/s,S=c):(x=(a=wi(t)).x+(~w[0].indexOf("%")?x/100*a.width:x),S=a.y+(~(w[1]||w[0]).indexOf("%")?S/100*a.height:S)),r||!1!==r&&l.smooth?(_=x-h,b=S-p,l.xOffset=f+(_*v+b*m)-_,l.yOffset=d+(_*y+b*g)-b):l.xOffset=l.yOffset=0,l.xOrigin=x,l.yOrigin=S,l.smooth=!!r,l.origin=e,l.originIsAbsolute=!!n,t.style[fi]="0px 0px",o&&(Ri(o,l,"xOrigin",h,x),Ri(o,l,"yOrigin",p,S),Ri(o,l,"xOffset",f,l.xOffset),Ri(o,l,"yOffset",d,l.yOffset)),t.setAttribute("data-svg-origin",x+" "+S)},Ii=function(t,e){var n=t._gsap||new cr(t);if("x"in n&&!e&&!n.uncache)return n;var r,i,o,a,s,c,l,u,h,p,f,d,v,y,m,g,_,b,w,x,S,R,O,P,T,E,C,A,k,M,j,L,B=t.style,z=n.scaleX<0,F="px",I="deg",D=vi(t,fi)||"0";return r=i=o=c=l=u=h=p=f=0,a=s=1,n.svg=!(!t.getCTM||!xi(t)),y=zi(t,n.svg),n.svg&&(P=!n.uncache&&t.getAttribute("data-svg-origin"),Fi(t,P||D,!!P||n.originIsAbsolute,!1!==n.smooth,y)),d=n.xOrigin||0,v=n.yOrigin||0,y!==Mi&&(b=y[0],w=y[1],x=y[2],S=y[3],r=R=y[4],i=O=y[5],6===y.length?(a=Math.sqrt(b*b+w*w),s=Math.sqrt(S*S+x*x),c=b||w?Kr(w,b)*Xr:0,(h=x||S?Kr(x,S)*Xr+c:0)&&(s*=Math.cos(h*Yr)),n.svg&&(r-=d-(d*b+v*x),i-=v-(d*w+v*S))):(L=y[6],M=y[7],C=y[8],A=y[9],k=y[10],j=y[11],r=y[12],i=y[13],o=y[14],l=(m=Kr(L,k))*Xr,m&&(P=R*(g=Math.cos(-m))+C*(_=Math.sin(-m)),T=O*g+A*_,E=L*g+k*_,C=R*-_+C*g,A=O*-_+A*g,k=L*-_+k*g,j=M*-_+j*g,R=P,O=T,L=E),u=(m=Kr(-x,k))*Xr,m&&(g=Math.cos(-m),j=S*(_=Math.sin(-m))+j*g,b=P=b*g-C*_,w=T=w*g-A*_,x=E=x*g-k*_),c=(m=Kr(w,b))*Xr,m&&(P=b*(g=Math.cos(m))+w*(_=Math.sin(m)),T=R*g+O*_,w=w*g-b*_,O=O*g-R*_,b=P,R=T),l&&Math.abs(l)+Math.abs(c)>359.9&&(l=c=0,u=180-u),a=Ve(Math.sqrt(b*b+w*w+x*x)),s=Ve(Math.sqrt(O*O+L*L)),m=Kr(R,O),h=Math.abs(m)>2e-4?m*Xr:0,f=j?1/(j<0?-j:j):0),n.svg&&(P=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!Li(vi(t,pi)),P&&t.setAttribute("transform",P))),Math.abs(h)>90&&Math.abs(h)<270&&(z?(a*=-1,h+=c<=0?180:-180,c+=c<=0?180:-180):(s*=-1,h+=h<=0?180:-180)),n.x=r-((n.xPercent=r&&(n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-r)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+F,n.y=i-((n.yPercent=i&&(n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-i)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+F,n.z=o+F,n.scaleX=Ve(a),n.scaleY=Ve(s),n.rotation=Ve(c)+I,n.rotationX=Ve(l)+I,n.rotationY=Ve(u)+I,n.skewX=h+I,n.skewY=p+I,n.transformPerspective=f+F,(n.zOrigin=parseFloat(D.split(" ")[2])||0)&&(B[fi]=Di(D)),n.xOffset=n.yOffset=0,n.force3D=Qt.force3D,n.renderTransform=n.svg?Gi:Hr?Hi:Ni,n.uncache=0,n},Di=function(t){return(t=t.split(" "))[0]+" "+t[1]},qi=function(t,e,n){var r=Sn(e);return Ve(parseFloat(e)+parseFloat(Pi(t,"x",n+"px",r)))+r},Ni=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Hi(t,e)},Vi="0deg",Wi="0px",Ui=") ",Hi=function(t,e){var n=e||this,r=n.xPercent,i=n.yPercent,o=n.x,a=n.y,s=n.z,c=n.rotation,l=n.rotationY,u=n.rotationX,h=n.skewX,p=n.skewY,f=n.scaleX,d=n.scaleY,v=n.transformPerspective,y=n.force3D,m=n.target,g=n.zOrigin,_="",b="auto"===y&&t&&1!==t||!0===y;if(g&&(u!==Vi||l!==Vi)){var w,x=parseFloat(l)*Yr,S=Math.sin(x),R=Math.cos(x);x=parseFloat(u)*Yr,w=Math.cos(x),o=qi(m,o,S*w*-g),a=qi(m,a,-Math.sin(x)*-g),s=qi(m,s,R*w*-g+g)}v!==Wi&&(_+="perspective("+v+Ui),(r||i)&&(_+="translate("+r+"%, "+i+"%) "),(b||o!==Wi||a!==Wi||s!==Wi)&&(_+=s!==Wi||b?"translate3d("+o+", "+a+", "+s+") ":"translate("+o+", "+a+Ui),c!==Vi&&(_+="rotate("+c+Ui),l!==Vi&&(_+="rotateY("+l+Ui),u!==Vi&&(_+="rotateX("+u+Ui),h===Vi&&p===Vi||(_+="skew("+h+", "+p+Ui),1===f&&1===d||(_+="scale("+f+", "+d+Ui),m.style[pi]=_||"translate(0, 0)"},Gi=function(t,e){var n,r,i,o,a,s=e||this,c=s.xPercent,l=s.yPercent,u=s.x,h=s.y,p=s.rotation,f=s.skewX,d=s.skewY,v=s.scaleX,y=s.scaleY,m=s.target,g=s.xOrigin,_=s.yOrigin,b=s.xOffset,w=s.yOffset,x=s.forceCSS,S=parseFloat(u),R=parseFloat(h);p=parseFloat(p),f=parseFloat(f),(d=parseFloat(d))&&(f+=d=parseFloat(d),p+=d),p||f?(p*=Yr,f*=Yr,n=Math.cos(p)*v,r=Math.sin(p)*v,i=Math.sin(p-f)*-y,o=Math.cos(p-f)*y,f&&(d*=Yr,a=Math.tan(f-d),i*=a=Math.sqrt(1+a*a),o*=a,d&&(a=Math.tan(d),n*=a=Math.sqrt(1+a*a),r*=a)),n=Ve(n),r=Ve(r),i=Ve(i),o=Ve(o)):(n=v,o=y,r=i=0),(S&&!~(u+"").indexOf("px")||R&&!~(h+"").indexOf("px"))&&(S=Pi(m,"x",u,"px"),R=Pi(m,"y",h,"px")),(g||_||b||w)&&(S=Ve(S+g-(g*n+_*i)+b),R=Ve(R+_-(g*r+_*o)+w)),(c||l)&&(a=m.getBBox(),S=Ve(S+c/100*a.width),R=Ve(R+l/100*a.height)),a="matrix("+n+","+r+","+i+","+o+","+S+","+R+")",m.setAttribute("transform",a),x&&(m.style[pi]=a)},Xi=function(t,e,n,r,i,o){var a,s,c=360,l=ae(i),u=parseFloat(i)*(l&&~i.indexOf("rad")?Xr:1),h=o?u*o:u-r,p=r+h+"deg";return l&&("short"===(a=i.split("_")[1])&&(h%=c)!==h%180&&(h+=h<0?c:-360),"cw"===a&&h<0?h=(h+36e9)%c-~~(h/c)*c:"ccw"===a&&h>0&&(h=(h-36e9)%c-~~(h/c)*c)),t._pt=s=new jr(t._pt,e,n,r,h,ei),s.e=p,s.u="deg",t._props.push(n),s},Yi=function(t,e,n){var r,i,o,a,s,c,l,u=Wr.style,h=n._gsap;for(i in u.cssText=getComputedStyle(n).cssText+";position:absolute;display:block;",u[pi]=e,Dr.body.appendChild(Wr),r=Ii(Wr,1),Gr)(o=h[i])!==(a=r[i])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(i)<0&&(s=Sn(o)!==(l=Sn(a))?Pi(n,i,o,l):parseFloat(o),c=parseFloat(a),t._pt=new jr(t._pt,h,i,s,c-s,ti),t._pt.u=l||0,t._props.push(i));Dr.body.removeChild(Wr)};Ne("padding,margin,Width,Radius",(function(t,e){var n="Top",r="Right",i="Bottom",o="Left",a=(e<3?[n,r,i,o]:[n+o,n+r,i+r,i+o]).map((function(n){return e<2?t+n:"border"+n+t}));ki[e>1?"border"+t:t]=function(t,e,n,r,i){var o,s;if(arguments.length<4)return o=a.map((function(e){return Ti(t,e,n)})),5===(s=o.join(" ")).split(o[0]).length?o[0]:s;o=(r+"").split(" "),s={},a.forEach((function(t,e){return s[t]=o[e]=o[e]||o[(e-1)/2|0]})),t.init(e,s,i)}}));var Ki,Qi,Zi,Ji={name:"css",register:gi,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,r,i){var o,a,s,c,l,u,h,p,f,d,v,y,m,g,_,b,w,x,S,R=this._props,O=t.style,P=n.vars.startAt;for(h in Nr||gi(),e)if("autoRound"!==h&&(a=e[h],!je[h]||!dr(h,e,n,r,t,i)))if(l=typeof a,u=ki[h],"function"===l&&(l=typeof(a=a.call(n,r,t,i))),"string"===l&&~a.indexOf("random(")&&(a=Ln(a)),u)u(this,t,h,a,n)&&(_=1);else if("--"===h.substr(0,2))o=(getComputedStyle(t).getPropertyValue(h)+"").trim(),a+="",p=Sn(o),(f=Sn(a))?p!==f&&(o=Pi(t,h,o,f)+f):p&&(a+=p),this.add(O,"setProperty",o,a,r,i,0,0,h);else if("undefined"!==l){if(P&&h in P?(o="function"==typeof P[h]?P[h].call(n,r,t,i):P[h],h in Qt.units&&!Sn(o)&&(o+=Qt.units[h]),"="===(o+"").charAt(1)&&(o=Ti(t,h))):o=Ti(t,h),c=parseFloat(o),(d="string"===l&&"="===a.charAt(1)?+(a.charAt(0)+"1"):0)&&(a=a.substr(2)),s=parseFloat(a),h in $r&&("autoAlpha"===h&&(1===c&&"hidden"===Ti(t,"visibility")&&s&&(c=0),Ri(this,O,"visibility",c?"inherit":"hidden",s?"inherit":"hidden",!s)),"scale"!==h&&"transform"!==h&&~(h=$r[h]).indexOf(",")&&(h=h.split(",")[0])),v=h in Gr)if(y||((m=t._gsap).renderTransform&&!e.parseTransform||Ii(t,e.parseTransform),g=!1!==e.smoothOrigin&&m.smooth,(y=this._pt=new jr(this._pt,O,pi,0,1,m.renderTransform,m,0,-1)).dep=1),"scale"===h)this._pt=new jr(this._pt,m,"scaleY",m.scaleY,d?d*s:s-m.scaleY),R.push("scaleY",h),h+="X";else{if("transformOrigin"===h){w=void 0,x=void 0,S=void 0,w=(b=a).split(" "),x=w[0],S=w[1]||"50%","top"!==x&&"bottom"!==x&&"left"!==S&&"right"!==S||(b=x,x=S,S=b),w[0]=Ci[x]||x,w[1]=Ci[S]||S,a=w.join(" "),m.svg?Fi(t,a,0,g,0,this):((f=parseFloat(a.split(" ")[2])||0)!==m.zOrigin&&Ri(this,m,"zOrigin",m.zOrigin,f),Ri(this,O,h,Di(o),Di(a)));continue}if("svgOrigin"===h){Fi(t,a,1,g,0,this);continue}if(h in ji){Xi(this,m,h,c,a,d);continue}if("smoothOrigin"===h){Ri(this,m,"smooth",m.smooth,a);continue}if("force3D"===h){m[h]=a;continue}if("transform"===h){Yi(this,a,t);continue}}else h in O||(h=mi(h)||h);if(v||(s||0===s)&&(c||0===c)&&!Jr.test(a)&&h in O)s||(s=0),(p=(o+"").substr((c+"").length))!==(f=Sn(a)||(h in Qt.units?Qt.units[h]:p))&&(c=Pi(t,h,o,f)),this._pt=new jr(this._pt,v?m:O,h,c,d?d*s:s-c,v||"px"!==f&&"zIndex"!==h||!1===e.autoRound?ti:ri),this._pt.u=f||0,p!==f&&(this._pt.b=o,this._pt.r=ni);else if(h in O)Ei.call(this,t,h,o,a);else{if(!(h in t)){Pe(h,a);continue}this.add(t,h,t[h],a,r,i)}R.push(h)}_&&Mr(this)},get:Ti,aliases:$r,getSetter:function(t,e,n){var r=$r[e];return r&&r.indexOf(",")<0&&(e=r),e in Gr&&e!==fi&&(t._gsap.x||Ti(t,"x"))?n&&Ur===n?"scale"===e?li:ci:(Ur=n||{})&&("scale"===e?ui:hi):t.style&&!le(t.style[e])?ai:~e.indexOf("-")?si:Rr(t,e)},core:{_removeProperty:Si,_getMatrix:zi}};Fr.utils.checkPrefix=mi,Zi=Ne((Ki="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(Qi="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(t){Gr[t]=1})),Ne(Qi,(function(t){Qt.units[t]="deg",ji[t]=1})),$r[Zi[13]]=Ki+","+Qi,Ne("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(t){var e=t.split(":");$r[e[1]]=Zi[e[0]]})),Ne("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(t){Qt.units[t]="px"})),Fr.registerPlugin(Ji);var $i=Fr.registerPlugin(Ji)||Fr,to=($i.core.Tween,n(44)),eo=n.n(to),no=n(47),ro=n.n(no),io=n(13),oo=n(17),ao=A.a.viewport,so=.05;A.a.viewport.mobiledevice&&(so=.15,"macos"===A.a.os&&(so*=2));var co={isSticky:!0,ease:so};function lo(t){var e=t=Object.assign({speed:1,updateTransforms:!0,isNested:!1,boundScroll:!1,dir:"y"},t),n=e.isNested,i=e.speed,o=e.parent,a=e.items,s=e.updateTransforms,c=e.boundScroll,l=e.dir,u=[],h=0,p={line:0,current:0,target:0,shift:0},f=1;if(!n){u.push(Object(r.a)(o,"wheel",function(t){var e=ro()(t);p.target+=e.pixelY*i*uo()}.bind(this)));var d=new eo.a({outer:o,friction:.9,momentum:!0,thresholdPropagation:{dir:l,value:1}});d.on("start",function(){}.bind(this)),d.on("move",function(t){o.classList.add("is-dragging");var e="x"===l?t.step.x:t.step.y;p.target-=e*i*uo()}.bind(this)),d.on("end",function(){o.classList.remove("is-dragging")}.bind(this))}function v(t){return t*f}function y(){var t;if(n||(p.current=Object(io.a)(p.current,p.target,co.ease)),t=p.current,h=t/f,!n){var e=v(co.isSticky?Math.round(h):h),r=A.a.viewport.mobiledevice?3:2;p.target=Object(io.a)(p.target,e,co.ease/r)}!n&&c&&c.setScrollValue(p.current*c.getSpeed()),function(){for(var t=-p.current-p.shift,e=1*f,n=0,r=a.length;n<r;n++){var i=a[n],o=$i.utils.wrap(-f-e,p.line-f-e,t);"x"===l?i.x=o:i.y=o,t+=f,s&&(i.outer.style.transform="\n                    translate3d(".concat(i.x,"px, ").concat(i.y,"px, 0)\n                "))}}()}return{render:y.bind(this),updateSizes:function(){p.line=0;for(var t=0;t<a.length;t++){var e=a[t],n=e.outer.clientWidth,r=e.outer.clientHeight;p.line+="x"===l?n:r,e.x=(ao.size[0]-n)/2,e.y=(ao.size[1]-r)/2,e.width=n,e.height=r}"x"===l?(f=a[0].width,p.shift=-1*(ao.size[0]/2-f/2)):(f=a[0].height,p.shift=-1*(ao.size[1]/2-f/2))}.bind(this),getTarget:function(){return p.target},getCurrent:function(){return p.current},getItemSize:function(){return f},getScrollValue:function(){return p.current},setScrollValue:function(t){p.current=t,p.target=t,y()}.bind(this),setScrollTarget:function(t){p.target=t}.bind(this),destroy:function(){u.forEach((function(t){t.remove()}))}.bind(this),getSpeed:function(){return t.speed},getProgress:function(){return h}}}function uo(){return A.a.viewport.mobiledevice&&"macos"===A.a.os?Object(oo.a)(A.a.viewport.dpr,[1,2]):1}function ho(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function po(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fo(t,e,n){return(fo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=go(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function vo(t,e){return(vo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function yo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=go(t);if(e){var i=go(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return mo(this,n)}}function mo(t,e){return!e||"object"!==_o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function go(t){return(go=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _o(t){return(_o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var bo=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":_o(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},wo=n(27),xo=A.a.viewport.mobiledevice?.5:y.i.rotationEase,So=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vo(t,e)}(s,t);var e,n,i,o=yo(s);function s(){var t;return ho(this,s),(t=o.apply(this,arguments))._length=0,t._imagesLoaded=0,t._height=0,t._width=0,t._threeEvents=[],t._sceneDiameter=0,t._disableRender=!1,t._rotation={z:{current:0,target:0}},t._stickyScroll=!1,t}return e=s,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"firstUpdated",value:function(){this._create()}},{key:"disconnectedCallback",value:function(){this._stickyScroll&&this._stickyScroll.destroy(),this._deviceOrientationEvent&&(u()({el:this._deviceOrientationEvent.el,id:this._deviceOrientationEvent.id}),this._deviceOrientationEvent=void 0),fo(go(s.prototype),"disconnectedCallback",this).call(this);for(var t=0;t<this._threeEvents.length;t++)V.a.remove(this._threeEvents[t]);if(this._mirror&&this._mirror.destroy(),this._group){for(var e=0;e<this._images.length;e++){var n=this._images[e].plane;this._group.remove(n.mesh),n.destroy()}this._imagesRenderTarget.scene.remove(this._group)}this._imagesPlane&&this._imagesPlane.destroy(),this._imagesRenderTarget&&this._light&&this._imagesRenderTarget.scene.remove(this._light),this._imagesRenderTarget&&this._imagesRenderTarget.destroy()}},{key:"_create",value:function(){var t=new d.a({useComposer:Object(y.m)(),dpr:A.a.viewport.dpr});this._imagesRenderTarget=t,this._light=new f.jb(16777215,1),t.scene.add(this._light);var e=new f.w;this._group=e,t.scene.add(e);var n=new rt({scene:V.a.scene3d,texture:t.renderer.texture,materialProp:{transparent:!1,opacity:0},zIndex:0});this._imagesPlane=n,this._images=Object(r.f)("portfolio-gallery-image",this),this._length=this._images.length,p()(this._proceedImages.bind(this),50)}},{key:"_proceedImages",value:function(){var t=this;this._mirror=function(t){var e,n,r;function i(){n.rotation.x=-90*Math.PI/180,n.position.z=0;var t=n.material.uniforms.u_vCenter;t&&(t.value=V.a.height/2)}return e=new f.ib(5*V.a.width,V.a.camera3d.far),(n=new it.a(e,{clipBias:.003,textureWidth:V.a.width,textureHeight:V.a.height})).getRenderTarget().texture.format=f.pb,(r=n.material).onBeforeCompile=function(t){t.uniforms.u_vCenter={value:V.a.height/2},t.uniforms.u_distortionStrength={value:5},t.uniforms.u_time={value:0},t.fragmentShader="".concat(at+ct+st,"\n            \n                uniform vec3 color;\n                uniform sampler2D tDiffuse;\n                uniform float u_vCenter;\n                uniform float u_distortionStrength;\n                uniform float u_time;\n\n                varying vec4 vUv;\n\n                void main() {\n\n                    vec4 uv = vUv;\n    \n                    float noise = snoise(vec3((uv.xy + vec2(u_time)) / 10., 0.));\n                    uv.x += noise * u_distortionStrength;\n\n                    vec4 base = texture2DProj(tDiffuse, uv);;\n                    base = blur_texture2DProj(tDiffuse, uv);\n                    \n                    vec4 outColor = blend( base, vec4(1., 0., 0., 0.) );\n                    float alpha = outColor.a * 1.;\n                    alpha *= uv.y / u_vCenter * 0.5;\n\n                    gl_FragColor = vec4(outColor.rgb, alpha);\n                }\n\n            ")},t.add(n),i(),{mirror:n,positionate:i.bind(this),setY:function(t){n.position.y=t}.bind(this),destroy:function(){e.dispose(),r.dispose(),t.remove(n)}.bind(this)}}(this._imagesRenderTarget.scene);for(var e=0;e<this._images.length;e++){var n=this._images[e];n.plane&&function(){var e=n.plane;e.loaded?(t._group.add(e.mesh),t._onImageLoaded()):e.on("loaded",(function(){t._group.add(e.mesh),t._onImageLoaded()}),{timeout:50})}()}}},{key:"_onImageLoaded",value:function(){this._imagesLoaded++,this._imagesLoaded===this._length&&this._onAllImagesLoaded()}},{key:"_onAllImagesLoaded",value:function(){this._setEvents();var t=Object(r.d)(this,jo);t&&t.classList.add("show")}},{key:"_setEvents",value:function(){var t=this,e=[];this._images.forEach((function(t){e.push(t)})),this._stickyScroll=lo({parent:this,items:e,dir:"x"}),this._threeEvents.push(V.a.on("resize",this.updateSizes.bind(this))),this.updateSizes(),this._threeEvents.push(V.a.on("afterrender",this._render.bind(this))),A.a.viewport.mobiledevice?this._deviceOrientationEvent=c()({el:window,target:"deviceorientation",do:this._onDeviceOrientation.bind(this)}):this.addEventListener("mousemove",this._onMouseMove.bind(this));var n=A.a.vevetPage;n&&n.onPageShown((function(){t._imagesPlane.show(500)}))}},{key:"_onMouseMove",value:function(t){var e=a()(t.clientX,[0,this._width]),n=a()(e,[.5,1]);this._rotation.z.target=n*y.i.maxRotation}},{key:"_onDeviceOrientation",value:function(t){var e=Object(_t.b)(t);this._rotation.z.target=e*y.i.maxRotation*-1}},{key:"updateSizes",value:function(){if(this._disableRender=!0,this._width=this.clientWidth,this._height=this.clientHeight,this._length>0&&this._mirror){var t=this._images[0].clientHeight;this._mirror.setY(t/2*-1.1),this._mirror.positionate()}if(this._light){if(this._length>0){var e=this._images[0].plane;if(e&&e.mesh){var n=(new f.e).setFromObject(e.mesh),r=new f.yb,i=n.getBoundingSphere(r).radius;this._sceneDiameter=2*i}}else this._sceneDiameter=100;this._light.position.z=y.i.lightZ*this._sceneDiameter}this._stickyScroll&&this._stickyScroll.updateSizes(),this._disableRender=!1}},{key:"_render",value:function(){this._disableRender||(this._renderRotation(),this._renderLight(),this._renderColor(),this._stickyScroll&&this._stickyScroll.render(),this._renderCallback(),this._light&&(this._light.position.z=y.i.lightZ*this._sceneDiameter))}},{key:"_renderRotation",value:function(){var t=this._rotation.z;t.current=wo(t.current,t.target,xo),this.style.transform="rotate(".concat(t.current,"rad)"),this._imagesRenderTarget.camera.rotation.z=t.current}},{key:"_renderLight",value:function(){if(y.i.moveLight&&W.a&&this._light){var t=W.a.getPosition();this._light.position.x=t.x,this._light.position.y=t.y}}},{key:"_renderColor",value:function(){var t=this._length,e=t,n=this.progress,r=gsap.utils.wrap(0,e,n),i=Math.floor(r),o=Math.ceil(r);o===t&&(o=0);var a=this._images[i].color,s=this._images[o].color,c=r-i,l=this.lerpColor(a,s,c);this._imagesPlane.material.userData.u_color.value=new f.l(l)}},{key:"lerpColor",value:function(t,e,n){var r=parseInt(t.replace(/#/g,""),16),i=r>>16,o=r>>8&255,a=255&r,s=parseInt(e.replace(/#/g,""),16);return(1<<24)+(i+n*((s>>16)-i)<<16)+(o+n*((s>>8&255)-o)<<8)+(a+n*((255&s)-a))|0}},{key:"imagesRenderTarget",get:function(){return this._imagesRenderTarget}},{key:"imagesPlane",get:function(){return this._imagesPlane}},{key:"group",get:function(){return this._group}},{key:"renderCallback",set:function(t){this._renderCallback=t}},{key:"progress",get:function(){return this._stickyScroll?this._stickyScroll.getProgress():1}}])&&po(e.prototype,n),i&&po(e,i),s}(i.a);function Ro(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Oo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Po(t,e,n){return(Po="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ao(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function To(t,e){return(To=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Eo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ao(t);if(e){var i=Ao(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Co(this,n)}}function Co(t,e){return!e||"object"!==ko(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ao(t){return(Ao=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ko(t){return(ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}So=bo([Object(i.b)("portfolio-gallery-images")],So);var Mo=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":ko(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},jo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&To(t,e)}(a,t);var e,n,i,o=Eo(a);function a(){return Ro(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"firstUpdated",value:function(){this._create()}},{key:"disconnectedCallback",value:function(){Po(Ao(a.prototype),"disconnectedCallback",this).call(this)}},{key:"_create",value:function(){var t=this;this._images=Object(r.g)("portfolio-gallery-images"),this._titles=Object(r.g)("portfolio-gallery-titles"),this._images&&(this._images.renderCallback=function(){t._titles.progress=t._images.progress})}}])&&Oo(e.prototype,n),i&&Oo(e,i),a}(i.a);jo=Mo([Object(i.b)("portfolio-gallery")],jo)},221:function(t,e,n){"use strict";n.r(e),n.d(e,"ErrorCode",(function(){return J}));var r,i=n(18),o=n(0),a=n(38),s=n(111),c=n(5),l=n.n(c),u=n(14),h=n.n(u),p=n(2),f=n(34),d=n(35),v=n(4),y=n(1),m=n(130),g=n(15),_={camera:{moveEase:.05,moveX:.25,moveY:.0474},wallsBoundingBoxVisible:!1,modelBoundingBoxVisible:!1,floor:{speed:.05,spread:20,strength:.7183},model:{color:1118481,roughness:.6846,metalness:1,reflectivity:.5836},ambientLightIntensity:5,ambientLightColor:16777215,lightSize:.08555,lightDistance:1.3468,lightColor:16777215,lightIntensity:3.829,recreate:function(){var t=Object(p.g)("error-code");if(t){var e=t.parentElement;t.remove(),setTimeout((function(){e.appendChild(t)}),500)}}};if(g.b){r=g.b.addFolder("Error Code");var b=_.camera,w=_.floor,x=_.model,S=r.addFolder("camera");S.add(b,"moveEase",g.a,.35,g.a),S.add(b,"moveX",-.25,.25,g.a),S.add(b,"moveY",-.25,.25,g.a);var R=r.addFolder("floor");R.add(w,"speed",0,.5,g.a),R.add(w,"spread",0,1e3,1),R.add(w,"strength",0,1,g.a);var O=r.addFolder("model");O.addColor(x,"color"),O.add(x,"roughness",0,1,g.a),O.add(x,"metalness",0,1,g.a),O.add(x,"reflectivity",0,1,g.a);var P=r.addFolder("light");P.add(_,"ambientLightIntensity",0,5,g.a),P.addColor(_,"ambientLightColor"),P.add(_,"recreate"),P.add(_,"lightSize",.025,.25,1e-5),P.add(_,"lightDistance",0,10,g.a),P.addColor(_,"lightColor"),P.add(_,"lightIntensity",0,5,g.a)}var T=n(42),E=y.a.viewport;function C(t,e,n){var r,i,a=_.model,c=1,l=!1,u=!1;function h(){var t=Object(m.a)(r);return{x:.89*t*2,y:.377*t*2,z:.27*t*2}}return t.traverse((function(t){var n;t instanceof o.R&&(r=n=t,e.add(n),i=new o.V({color:new o.l(a.color),roughness:a.roughness,metalness:a.metalness,reflectivity:a.reflectivity}),r.material=i)})),{resize:function(){r.geometry.center(),Object(T.b)(r);var t=Object(m.a)(r),i=Math.min(v.a.width,v.a.height)/2*function(){if(E.desktop)return E.size[0]>1900?.9:.95;if(E.tablet)return.85;return.9}()/t;Object(T.c)(r,i),function(){u&&e.remove(u),l&&n.remove(l);var t=h();if(_.modelBoundingBoxVisible){var r=new o.f(t.x,t.y,t.z),i=new o.S({color:65280,transparent:!0,opacity:.2,side:o.r});u=new o.R(r,i),e.add(u)}l=new s.Body({mass:0,shape:new s.Box(new s.Vec3(t.x,t.y,t.z))}),n.addBody(l),l.quaternion.setFromAxisAngle(new s.Vec3(0,0,0),Math.PI/2),u&&(u.position.copy(l.position),u.quaternion.copy(l.quaternion))}(),c=Object(m.a)(r)}.bind(this),render:function(){i.color=new o.l(a.color),i.roughness=a.roughness,i.metalness=a.metalness,i.reflectivity=a.reflectivity}.bind(this),destroy:function(){e.remove(r),u&&e.remove(u),l&&n.remove(l)}.bind(this),getModelRadius:function(){return Object(m.a)(r)}.bind(this),getCurrentModelRadius:function(){return c},getBoundingBoxDimensions:h.bind(this)}}var A=n(127),k=n(128),M=n(120).default,j=n(129).default,L=Object(k.a)();var B=[{x:0,z:1.1},{x:-.25,z:2},{x:.15,z:4},{x:.15,z:2},{x:-.6,z:.5},{x:-.8,z:4},{x:-.9,z:3.9},{x:2,z:0},{x:.8,z:-1.5},{x:-.25,z:-2},{x:.5,z:-5},{x:1,z:-1.1},{x:-1.5,z:-1.5}],z=B.length;function F(t,e,n,r,i){var a=_.lightSize,c=0,l={x:0,y:0,z:0},u=new o.S({color:16777215}),h=!1,p=!1,f=!1;m();var d=new o.jb(new o.l(_.lightColor),_.lightIntensity*c);function m(){var n=_.lightSize*r.getModelRadius();h&&(h.dispose(),h=!1),h=new o.zb(n,30,30),p&&(t.remove(p),p=!1),(p=new o.R(h,u)).position.set(l.x,l.y,l.z),t.add(p),f&&(e.remove(f),f=!1),f=new s.Body({mass:1,sleepTimeLimit:i,linearDamping:1e-5*Math.random(),angularDamping:1e-5*Math.random(),position:new s.Vec3(l.x,l.y,l.z),shape:new s.Sphere(n)}),e.addBody(f)}function g(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];r&&m();var i=b();p&&f&&(p.position.x=d.position.x=f.position.x=t||i.x,p.position.y=d.position.y=f.position.y=e||i.y,p.position.z=d.position.z=f.position.z=n||i.z)}function b(){var t=_.lightSize*r.getModelRadius(),e=r.getBoundingBoxDimensions(),n=0,o=.75*v.a.height,a=0;if(void 0!==B[i]){var s=B[i];n=e.x/2*s.x,a=e.z/2*s.z}else n=i*t*2-350,a=400*Math.random();return{x:n,y:o,z:a}}return d.decay=.02,d.distance=_.lightDistance*r.getCurrentModelRadius(),t.add(d),g(!1,!1,!1),{render:function(){a!==_.lightSize&&(m(),a=_.lightSize),p&&f&&(p.position.copy(f.position),p.quaternion.copy(f.quaternion),d.position.copy(f.position),d.quaternion.copy(f.quaternion),l.x=p.position.x,l.y=p.position.y,l.z=p.position.z);var t=y.a.viewport.mobile?1.2:1;d.distance=_.lightDistance*r.getCurrentModelRadius()*t,d.intensity=_.lightIntensity*c,d.color=new o.l(_.lightColor),u.color=new o.l(_.lightColor)}.bind(this),destroy:function(){h&&h.dispose(),u.dispose(),p&&t.remove(p),t.remove(d),f&&e.remove(f)}.bind(this),setPosition:g.bind(this),setLightIntensity:function(t){c=t}.bind(this)}}var I=n(17),D=n(13),q=n(57),N=n(3);function V(t,e,n){var r=!0,i=!1,c=[],u=[],m=[],g=!1,b=!1,w=!1,x=!1,S=!1,R=!1,O=!1,P=!1,T=[],E={x:0,y:0},k={x:0,y:0},B=new o.N;function V(){if(O){O.resize(),R&&R.setFloorY(-.38*O.getModelRadius());for(var t=0;t<T.length;t++){T[t].setPosition(!1,!1,!1,!0)}}}function W(t){y.a.viewport.mobiledevice||(k.x=l()(t.clientX,[y.a.viewport.size[0]/2,y.a.viewport.size[0]]),k.y=l()(t.clientY,[y.a.viewport.size[1]/2,y.a.viewport.size[1]]))}function U(t){if(y.a.viewport.mobiledevice){var e=Object(q.b)(t);k.x=1.25*e;var n=Object(q.a)(t);k.y=1.25*n}}function H(){var t=_.camera;g&&g.step(1/60),R&&R.render();for(var e=0;e<T.length;e++)T[e].render();if(O&&O.render(),!r&&P&&(P.intensity=_.ambientLightIntensity,P.color=new o.l(_.ambientLightColor)),E.x=Object(D.a)(E.x,k.x,t.moveEase),E.y=Object(D.a)(E.y,k.y,t.moveEase),w){var n=w.camera;n.position.x=E.x*v.a.width*t.moveX,n.position.y=E.y*v.a.height*-t.moveY,n.lookAt(new o.Lb(0,0,0))}}function G(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2500,e=new h.a;e.on("progress",(function(t){P&&(P.intensity=_.ambientLightIntensity*t.p);for(var e=Object(I.a)(l()(t.p,[0,1])),n=0;n<T.length;n++)T[n].setLightIntensity(e)})),e.on("end",(function(){r=!1})),e.play({duration:t}),setTimeout((function(){c.push(v.a.on("prerender",(function(){H()})))}),.25*t)}return new a.a(B).setPath(n).load(e,(function(e){!function(e){if(i)return;b=e,(g=new s.World).gravity.set(0,v.a.height/-9.8*10,0),g.broadphase=new s.NaiveBroadphase,g.quatNormalizeSkip=0,g.quatNormalizeFast=!1,w=new d.a({el:t,cameraSettings:{far:1200},dpr:y.a.viewport.dpr,useComposer:Object(N.m)()}),x=w.scene,S=new f.a({scene:v.a.scene3d,texture:w.renderer.texture,materialProp:{transparent:!1,opacity:1},zIndex:1,renderPosition:!1}),R=function(t,e){var n=_.floor,r=R(),i=r,a=0,c=new o.ib(20*r,20*r),l=Math.max(v.a.width,v.a.height),u=new A.a(c,{clipBias:.003,textureWidth:l,textureHeight:l});u.getRenderTarget().texture.format=o.pb;var h=u.material;h.onBeforeCompile=function(t){t.uniforms.u_vCenter={value:v.a.height/2},t.uniforms.u_noiseSpread={value:n.spread},t.uniforms.u_time={value:0},t.uniforms.u_size={value:l},t.uniforms.u_reflectionStrength={value:0},t.vertexShader="\n            uniform mat4 textureMatrix;\n            varying vec4 vUv;\n            varying vec3 pos;\n            void main() {\n                vUv = textureMatrix * vec4( position, 1.0 );\n                pos = position;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n            }\n        ",t.fragmentShader="".concat(M+L+j,"\n\n            uniform vec3 color;\n            uniform sampler2D tDiffuse;\n            uniform float u_vCenter;\n            uniform float u_noiseSpread;\n            uniform float u_reflectionStrength;\n            uniform float u_time;\n\n            varying vec4 vUv;\n            varying vec3 pos;\n\n            float blendOverlay( float base, float blend ) {\n                return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n            }\n            \n            vec3 blendOverlay( vec3 base, vec3 blend ) {\n                return vec3(\n                    blendOverlay( base.r, blend.r ),\n                    blendOverlay( base.g, blend.g ),\n                    blendOverlay( base.b, blend.b )\n                );\n            }            \n\n            void main() {\n\n                vec4 uv = vUv;\n                float noise = snoise(vec3((pos.xy + vec2(u_time)) / 10., 0.));\n                uv.x += noise * 5.;\n\n                vec4 base = texture2DProj( tDiffuse, uv );\n                base = blur_texture2DProj(tDiffuse, uv);\n                vec4 reflectionColor = vec4(\n                    blendOverlay( base.rgb, color ),\n                    1.0\n                );\n\n                // gradient\n                float colorInterpolation = 1. - (uv.y / u_vCenter);\n                vec4 gradient = mix(base, vec4(0., 0., 0., 1.), colorInterpolation);\n                \n                // float noise = snoise(vec3(pos.xy, vec2(u_time)) * u_noiseSpread) * u_reflectionStrength;\n                gl_FragColor = gradient; // * vec4(vec3(noise), 1.0);\n\n            }\n\n        ")},t.add(u);for(var p=[{body:!1,mesh:!1,w:1,h:1,x:0,y:.75,z:0,vec3:new s.Vec3(1,0,0),angle:-Math.PI/2},{body:!1,mesh:!1,w:1,h:1,x:0,y:!1,z:0,vec3:new s.Vec3(1,0,0),angle:-Math.PI/2},{body:!1,mesh:!1,w:1,h:1,x:0,y:.25,z:.5,vec3:new s.Vec3(0,1,0),angle:0*Math.PI},{body:!1,mesh:!1,w:1,h:1,x:0,y:.25,z:-.5,vec3:new s.Vec3(0,1,0),angle:0*Math.PI},{body:!1,mesh:!1,w:1,h:1,x:-.5,y:.25,z:0,vec3:new s.Vec3(0,1,0),angle:Math.PI/2},{body:!1,mesh:!1,w:1,h:1,x:.5,y:.25,z:0,vec3:new s.Vec3(0,1,0),angle:Math.PI/2}],f=0;f<p.length;f++){var d=p[f];if(_.wallsBoundingBoxVisible){var y=new o.f(d.w*r,d.h*r,1),m=new o.S({color:16711680,transparent:!0,opacity:.2,side:o.r}),g=new o.R(y,m);t.add(g),d.mesh=g}var b=w(d);e.addBody(b),d.body=b,S(d)}function w(t){return new s.Body({mass:0,shape:new s.Box(new s.Vec3(t.w*r,t.h*r,1))})}function x(){u.position.y=a-1,u.rotation.x=-Math.PI/2;var t=h.uniforms.u_vCenter;t&&(t.value=v.a.height/2);for(var n=0;n<p.length;n++){var i=p[n];if(i.body){e.remove(i.body),i.body=!1;var o=w(i);e.addBody(o),i.body=o}}r=R();for(var s=0;s<p.length;s++)S(p[s])}function S(t){var e=t.body,n=t.mesh,o=t.x,s=t.y,c=t.z,l=t.vec3,u=t.angle;if(e){var h=r/i;e.position.x=o*r,e.position.y=s?s*r:a,e.position.z=c*r,e.quaternion.setFromAxisAngle(l,u),n&&(n.quaternion.copy(e.quaternion),n.position.x=e.position.x,n.position.y=e.position.y,n.position.z=e.position.z,n.scale.x=h,n.scale.y=h)}}function R(){return Math.sqrt(Math.pow(v.a.width,2)+Math.pow(v.a.height,2))}return{mirror:u,positionate:x.bind(this),setFloorY:function(t){a=t,x()}.bind(this),getFloorY:function(){return a},getBoundinBoxSize:function(){return r},render:function(){var t=h.uniforms,e=t.u_time,r=t.u_noiseSpread,i=t.u_reflectionStrength;e&&(e.value+=n.speed),r&&(r.value=n.spread),i&&(i.value=n.strength)}.bind(this),destroy:function(){c.dispose(),t.remove(u);for(var n=0;n<p.length;n++){var r=p[n],i=r.mesh,o=r.body;i&&t.remove(i),o&&e.remove(o)}}.bind(this)}}(x,g),O=C(b,x,g),P=new o.a(16777215,0),x.add(P),V(),u.push(y.a.viewport.on("",(function(){V()}),{timeout:500,name:"error code"}));for(var n=0;n<z;n++){var r=F(x,g,0,O,n);T.push(r)}V(),m.push(Object(p.a)(window,"mousemove",W.bind(this))),m.push(Object(p.a)(window,"deviceorientation",U.bind(this)));var a=y.a.vevetPage;a&&a.onPageShown((function(){G()}))}(e)})),{destroy:function(){i=!0,c.forEach((function(t){v.a.remove(t)})),u.forEach((function(t){y.a.viewport.remove(t)})),m.forEach((function(t){t.remove()})),R&&R.destroy(),O&&O.destroy(),P&&x&&x.remove(P),S&&S.destroy(),w&&w.destroy()}.bind(this),show:G.bind(this)}}function W(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function H(t,e,n){return(H="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=K(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function G(t,e){return(G=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=K(t);if(e){var i=K(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Y(this,n)}}function Y(t,e){return!e||"object"!==Q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function K(t){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Z=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":Q(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},J=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&G(t,e)}(o,t);var e,n,r,i=X(o);function o(){var t;return W(this,o),(t=i.apply(this,arguments)).codeSrc="error.obj",t.codePath="/assets/img/",t}return e=o,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"connectedCallback",value:function(){H(K(o.prototype),"connectedCallback",this).call(this),this._scene=V(this,this.codeSrc,this.codePath)}},{key:"disconnectedCallback",value:function(){H(K(o.prototype),"disconnectedCallback",this).call(this),this._scene&&(this._scene.destroy(),this._scene=void 0)}}])&&U(e.prototype,n),r&&U(e,r),o}(i.a);Z([Object(i.d)({attribute:"code-src"})],J.prototype,"codeSrc",void 0),Z([Object(i.d)({attribute:"code-path"})],J.prototype,"codePath",void 0),J=Z([Object(i.b)("error-code")],J)},222:function(t,e,n){"use strict";n.r(e),n.d(e,"ProductGltfModel",(function(){return Y}));var r=n(18),i=n(0),o=function(){function t(t){i.L.call(this,t),this.dracoLoader=null,this.ddsLoader=null}function e(){var t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}t.prototype=Object.assign(Object.create(i.L.prototype),{constructor:t,load:function(t,e,n,r){var o,a=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:i.M.extractUrlBase(t),a.manager.itemStart(t);var s=function(e){r?r(e):console.error(e),a.manager.itemError(t),a.manager.itemEnd(t)},c=new i.s(a.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),"use-credentials"===a.crossOrigin&&c.setWithCredentials(!0),c.load(t,(function(n){try{a.parse(n,o,(function(n){e(n),a.manager.itemEnd(t)}),s)}catch(r){s(r)}}),n,s)},setDRACOLoader:function(t){return this.dracoLoader=t,this},setDDSLoader:function(t){return this.ddsLoader=t,this},parse:function(t,e,l,u){var d,m={};if("string"==typeof t)d=t;else if(i.M.decodeText(new Uint8Array(t,0,4))===c){try{m[n.KHR_BINARY_GLTF]=new h(t)}catch(x){return void(u&&u(x))}d=m[n.KHR_BINARY_GLTF].content}else d=i.M.decodeText(new Uint8Array(t));var g=JSON.parse(d);if(void 0===g.asset||g.asset.version[0]<2)u&&u(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(g.extensionsUsed)for(var _=0;_<g.extensionsUsed.length;++_){var b=g.extensionsUsed[_],w=g.extensionsRequired||[];switch(b){case n.KHR_LIGHTS_PUNCTUAL:m[b]=new o(g);break;case n.KHR_MATERIALS_CLEARCOAT:m[b]=new s;break;case n.KHR_MATERIALS_UNLIT:m[b]=new a;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:m[b]=new v;break;case n.KHR_DRACO_MESH_COMPRESSION:m[b]=new p(g,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:m[b]=new r(this.ddsLoader);break;case n.KHR_TEXTURE_TRANSFORM:m[b]=new f;break;case n.KHR_MESH_QUANTIZATION:m[b]=new y;break;default:w.indexOf(b)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+b+'".')}}new N(g,m,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(l,u)}}});var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function r(t){if(!t)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=t}function o(t){this.name=n.KHR_LIGHTS_PUNCTUAL;var e=t.extensions&&t.extensions[n.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=e.lights||[]}function a(){this.name=n.KHR_MATERIALS_UNLIT}function s(){this.name=n.KHR_MATERIALS_CLEARCOAT}o.prototype.loadLight=function(t){var e,n=this.lightDefs[t],r=new i.l(16777215);void 0!==n.color&&r.fromArray(n.color);var o=void 0!==n.range?n.range:0;switch(n.type){case"directional":(e=new i.q(r)).target.position.set(0,0,-1),e.add(e.target);break;case"point":(e=new i.jb(r)).distance=o;break;case"spot":(e=new i.Bb(r)).distance=o,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,e.angle=n.spot.outerConeAngle,e.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,e.target.position.set(0,0,-1),e.add(e.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+n.type+'".')}return e.position.set(0,0,0),e.decay=2,void 0!==n.intensity&&(e.intensity=n.intensity),e.name=n.name||"light_"+t,Promise.resolve(e)},a.prototype.getMaterialType=function(){return i.S},a.prototype.extendParams=function(t,e,n){var r=[];t.color=new i.l(1,1,1),t.opacity=1;var o=e.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var a=o.baseColorFactor;t.color.fromArray(a),t.opacity=a[3]}void 0!==o.baseColorTexture&&r.push(n.assignTexture(t,"map",o.baseColorTexture))}return Promise.all(r)},s.prototype.getMaterialType=function(){return i.V},s.prototype.extendParams=function(t,e,n){var r=[],o=e.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&r.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&r.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(r.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){var a=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new i.Kb(a,a)}return Promise.all(r)};var c="glTF",l=1313821514,u=5130562;function h(t){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(t,0,12);if(this.header={magic:i.M.decodeText(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==c)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var r=new DataView(t,12),o=0;o<r.byteLength;){var a=r.getUint32(o,!0);o+=4;var s=r.getUint32(o,!0);if(o+=4,s===l){var h=new Uint8Array(t,12+o,a);this.content=i.M.decodeText(h)}else if(s===u){var p=12+o;this.body=t.slice(p,p+a)}o+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function p(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}function f(){this.name=n.KHR_TEXTURE_TRANSFORM}function d(t){i.W.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var e=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),o=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),a=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),s={specular:{value:(new i.l).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=s,this.onBeforeCompile=function(t){for(var i in s)t.uniforms[i]=s[i];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),t.fragmentShader=t.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),t.fragmentShader=t.fragmentShader.replace("#include <roughnessmap_pars_fragment>",e),t.fragmentShader=t.fragmentShader.replace("#include <metalnessmap_pars_fragment>",n),t.fragmentShader=t.fragmentShader.replace("#include <roughnessmap_fragment>",r),t.fragmentShader=t.fragmentShader.replace("#include <metalnessmap_fragment>",o),t.fragmentShader=t.fragmentShader.replace("#include <lights_physical_fragment>",a)},Object.defineProperties(this,{specular:{get:function(){return s.specular.value},set:function(t){s.specular.value=t}},specularMap:{get:function(){return s.specularMap.value},set:function(t){s.specularMap.value=t}},glossiness:{get:function(){return s.glossiness.value},set:function(t){s.glossiness.value=t}},glossinessMap:{get:function(){return s.glossinessMap.value},set:function(t){s.glossinessMap.value=t,t?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}function v(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return d},extendParams:function(t,e,n){var r=e.extensions[this.name];t.color=new i.l(1,1,1),t.opacity=1;var o=[];if(Array.isArray(r.diffuseFactor)){var a=r.diffuseFactor;t.color.fromArray(a),t.opacity=a[3]}if(void 0!==r.diffuseTexture&&o.push(n.assignTexture(t,"map",r.diffuseTexture)),t.emissive=new i.l(0,0,0),t.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,t.specular=new i.l(1,1,1),Array.isArray(r.specularFactor)&&t.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var s=r.specularGlossinessTexture;o.push(n.assignTexture(t,"glossinessMap",s)),o.push(n.assignTexture(t,"specularMap",s))}return Promise.all(o)},createMaterial:function(t){var e=new d(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=i.Db,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e}}}function y(){this.name=n.KHR_MESH_QUANTIZATION}function m(t,e,n,r){i.A.call(this,t,e,n,r)}p.prototype.decodePrimitive=function(t,e){var n=this.json,r=this.dracoLoader,i=t.extensions[this.name].bufferView,o=t.extensions[this.name].attributes,a={},s={},c={};for(var l in o){var u=C[l]||l.toLowerCase();a[u]=o[l]}for(l in t.attributes){u=C[l]||l.toLowerCase();if(void 0!==o[l]){var h=n.accessors[t.attributes[l]],p=O[h.componentType];c[u]=p,s[u]=!0===h.normalized}}return e.getDependency("bufferView",i).then((function(t){return new Promise((function(e){r.decodeDracoFile(t,(function(t){for(var n in t.attributes){var r=t.attributes[n],i=s[n];void 0!==i&&(r.normalized=i)}e(t)}),a,c)}))}))},f.prototype.extendTexture=function(t,e){return t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.needsUpdate=!0,t},d.prototype=Object.create(i.W.prototype),d.prototype.constructor=d,d.prototype.copy=function(t){return i.W.prototype.copy.call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},m.prototype=Object.create(i.A.prototype),m.prototype.constructor=m,m.prototype.copySampleValue_=function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r*3+r,o=0;o!==r;o++)e[o]=n[i+o];return e},m.prototype.beforeStart_=m.prototype.copySampleValue_,m.prototype.afterEnd_=m.prototype.copySampleValue_,m.prototype.interpolate_=function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,c=3*a,l=r-e,u=(n-e)/l,h=u*u,p=h*u,f=t*c,d=f-c,v=-2*p+3*h,y=p-h,m=1-v,g=y-h+u,_=0;_!==a;_++){var b=o[d+_+a],w=o[d+_+s]*l,x=o[f+_+a],S=o[f+_]*l;i[_]=m*b+g*w+v*x+y*S}return i};var g=0,_=1,b=2,w=3,x=4,S=5,R=6,O={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},P={9728:i.Y,9729:i.I,9984:i.bb,9985:i.K,9986:i.ab,9987:i.J},T={33071:i.j,33648:i.X,10497:i.tb},E={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},C={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},A={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},k={CUBICSPLINE:void 0,LINEAR:i.C,STEP:i.B},M="OPAQUE",j="MASK",L="BLEND",B={"image/png":i.pb,"image/jpeg":i.sb};function z(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}function F(t,e,n){for(var r in n.extensions)void 0===t[r]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=n.extensions[r])}function I(t,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function D(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(var n=0,r=e.weights.length;n<r;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){var i=e.extras.targetNames;if(t.morphTargetInfluences.length===i.length){t.morphTargetDictionary={};for(n=0,r=i.length;n<r;n++)t.morphTargetDictionary[i[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function q(t){for(var e="",n=Object.keys(t).sort(),r=0,i=n.length;r<i;r++)e+=n[r]+":"+t[n[r]]+";";return e}function N(t,n,r){this.json=t||{},this.extensions=n||{},this.options=r||{},this.cache=new e,this.primitiveCache={},this.textureLoader=new i.Fb(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new i.s(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function V(t,e,n){var r=e.attributes,o=[];function a(e,r){return n.getDependency("accessor",e).then((function(e){t.setAttribute(r,e)}))}for(var s in r){var c=C[s]||s.toLowerCase();c in t.attributes||o.push(a(r[s],c))}if(void 0!==e.indices&&!t.index){var l=n.getDependency("accessor",e.indices).then((function(e){t.setIndex(e)}));o.push(l)}return I(t,e),function(t,e,n){var r=e.attributes,o=new i.e;if(void 0!==r.POSITION){var a=(f=n.json.accessors[r.POSITION]).min,s=f.max;if(void 0!==a&&void 0!==s){o.set(new i.Lb(a[0],a[1],a[2]),new i.Lb(s[0],s[1],s[2]));var c=e.targets;if(void 0!==c){for(var l=new i.Lb,u=new i.Lb,h=0,p=c.length;h<p;h++){var f,d=c[h];if(void 0!==d.POSITION)a=(f=n.json.accessors[d.POSITION]).min,s=f.max,void 0!==a&&void 0!==s?(u.setX(Math.max(Math.abs(a[0]),Math.abs(s[0]))),u.setY(Math.max(Math.abs(a[1]),Math.abs(s[1]))),u.setZ(Math.max(Math.abs(a[2]),Math.abs(s[2]))),l.max(u)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}o.expandByVector(l)}t.boundingBox=o;var v=new i.yb;o.getCenter(v.center),v.radius=o.min.distanceTo(o.max)/2,t.boundingSphere=v}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(t,e,n),Promise.all(o).then((function(){return void 0!==e.targets?function(t,e,n){for(var r=!1,i=!1,o=0,a=e.length;o<a&&(void 0!==(l=e[o]).POSITION&&(r=!0),void 0!==l.NORMAL&&(i=!0),!r||!i);o++);if(!r&&!i)return Promise.resolve(t);var s=[],c=[];for(o=0,a=e.length;o<a;o++){var l=e[o];if(r){var u=void 0!==l.POSITION?n.getDependency("accessor",l.POSITION):t.attributes.position;s.push(u)}i&&(u=void 0!==l.NORMAL?n.getDependency("accessor",l.NORMAL):t.attributes.normal,c.push(u))}return Promise.all([Promise.all(s),Promise.all(c)]).then((function(e){var n=e[0],o=e[1];return r&&(t.morphAttributes.position=n),i&&(t.morphAttributes.normal=o),t.morphTargetsRelative=!0,t}))}(t,e.targets,n):t}))}function W(t,e){var n=t.getIndex();if(null===n){var r=[],o=t.getAttribute("position");if(void 0===o)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var a=0;a<o.count;a++)r.push(a);t.setIndex(r),n=t.getIndex()}var s=n.count-2,c=[];if(e===i.Gb)for(a=1;a<=s;a++)c.push(n.getX(0)),c.push(n.getX(a)),c.push(n.getX(a+1));else for(a=0;a<s;a++)a%2==0?(c.push(n.getX(a)),c.push(n.getX(a+1)),c.push(n.getX(a+2))):(c.push(n.getX(a+2)),c.push(n.getX(a+1)),c.push(n.getX(a)));c.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=t.clone();return l.setIndex(c),l}return N.prototype.parse=function(t,e){var n=this,r=this.json,i=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(e){var o={scene:e[0][r.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:r.asset,parser:n,userData:{}};F(i,o,r),I(o,r),t(o)})).catch(e)},N.prototype.markDefs=function(){for(var t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[],r={},i={},o=0,a=e.length;o<a;o++)for(var s=e[o].joints,c=0,l=s.length;c<l;c++)t[s[c]].isBone=!0;for(var u=0,h=t.length;u<h;u++){var p=t[u];void 0!==p.mesh&&(void 0===r[p.mesh]&&(r[p.mesh]=i[p.mesh]=0),r[p.mesh]++,void 0!==p.skin&&(n[p.mesh].isSkinnedMesh=!0))}this.json.meshReferences=r,this.json.meshUses=i},N.prototype.getDependency=function(t,e){var r=t+":"+e,i=this.cache.get(r);if(!i){switch(t){case"scene":i=this.loadScene(e);break;case"node":i=this.loadNode(e);break;case"mesh":i=this.loadMesh(e);break;case"accessor":i=this.loadAccessor(e);break;case"bufferView":i=this.loadBufferView(e);break;case"buffer":i=this.loadBuffer(e);break;case"material":i=this.loadMaterial(e);break;case"texture":i=this.loadTexture(e);break;case"skin":i=this.loadSkin(e);break;case"animation":i=this.loadAnimation(e);break;case"camera":i=this.loadCamera(e);break;case"light":i=this.extensions[n.KHR_LIGHTS_PUNCTUAL].loadLight(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(r,i)}return i},N.prototype.getDependencies=function(t){var e=this.cache.get(t);if(!e){var n=this,r=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(r.map((function(e,r){return n.getDependency(t,r)}))),this.cache.add(t,e)}return e},N.prototype.loadBuffer=function(t){var e=this.json.buffers[t],r=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var i=this.options;return new Promise((function(t,n){r.load(z(e.uri,i.path),t,void 0,(function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))}))}))},N.prototype.loadBufferView=function(t){var e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then((function(t){var n=e.byteLength||0,r=e.byteOffset||0;return t.slice(r,r+n)}))},N.prototype.loadAccessor=function(t){var e=this,n=this.json,r=this.json.accessors[t];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var o=[];return void 0!==r.bufferView?o.push(this.getDependency("bufferView",r.bufferView)):o.push(null),void 0!==r.sparse&&(o.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(o).then((function(t){var o,a,s=t[0],c=E[r.type],l=O[r.componentType],u=l.BYTES_PER_ELEMENT,h=u*c,p=r.byteOffset||0,f=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,d=!0===r.normalized;if(f&&f!==h){var v=Math.floor(p/f),y="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+v+":"+r.count,m=e.cache.get(y);m||(o=new l(s,v*f,r.count*f/u),m=new i.y(o,f/u),e.cache.add(y,m)),a=new i.z(m,c,p%f/u,d)}else o=null===s?new l(r.count*c):new l(s,p,r.count*c),a=new i.g(o,c,d);if(void 0!==r.sparse){var g=E.SCALAR,_=O[r.sparse.indices.componentType],b=r.sparse.indices.byteOffset||0,w=r.sparse.values.byteOffset||0,x=new _(t[1],b,r.sparse.count*g),S=new l(t[2],w,r.sparse.count*c);null!==s&&(a=new i.g(a.array.slice(),a.itemSize,a.normalized));for(var R=0,P=x.length;R<P;R++){var T=x[R];if(a.setX(T,S[R*c]),c>=2&&a.setY(T,S[R*c+1]),c>=3&&a.setZ(T,S[R*c+2]),c>=4&&a.setW(T,S[R*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a}))},N.prototype.loadTexture=function(t){var e,r=this,o=this.json,a=this.options,s=this.textureLoader,c=self.URL||self.webkitURL,l=o.textures[t],u=l.extensions||{},h=(e=u[n.MSFT_TEXTURE_DDS]?o.images[u[n.MSFT_TEXTURE_DDS].source]:o.images[l.source]).uri,p=!1;return void 0!==e.bufferView&&(h=r.getDependency("bufferView",e.bufferView).then((function(t){p=!0;var n=new Blob([t],{type:e.mimeType});return h=c.createObjectURL(n)}))),Promise.resolve(h).then((function(t){var e=a.manager.getHandler(t);return e||(e=u[n.MSFT_TEXTURE_DDS]?r.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:s),new Promise((function(n,r){e.load(z(t,a.path),n,void 0,r)}))})).then((function(t){!0===p&&c.revokeObjectURL(h),t.flipY=!1,l.name&&(t.name=l.name),e.mimeType in B&&(t.format=B[e.mimeType]);var n=(o.samplers||{})[l.sampler]||{};return t.magFilter=P[n.magFilter]||i.I,t.minFilter=P[n.minFilter]||i.J,t.wrapS=T[n.wrapS]||i.tb,t.wrapT=T[n.wrapT]||i.tb,t}))},N.prototype.assignTexture=function(t,e,r){var o=this;return this.getDependency("texture",r.index).then((function(a){if(!a.isCompressedTexture)switch(e){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":a.format=i.sb}if(void 0===r.texCoord||0==r.texCoord||"aoMap"===e&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+e+" not yet supported."),o.extensions[n.KHR_TEXTURE_TRANSFORM]){var s=void 0!==r.extensions?r.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;s&&(a=o.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(a,s))}t[e]=a}))},N.prototype.assignFinalMaterial=function(t){var e=t.geometry,n=t.material,r=void 0!==e.attributes.tangent,o=void 0!==e.attributes.color,a=void 0===e.attributes.normal,s=!0===t.isSkinnedMesh,c=Object.keys(e.morphAttributes).length>0,l=c&&void 0!==e.morphAttributes.normal;if(t.isPoints){var u="PointsMaterial:"+n.uuid,h=this.cache.get(u);h||(h=new i.mb,i.O.prototype.copy.call(h,n),h.color.copy(n.color),h.map=n.map,h.sizeAttenuation=!1,this.cache.add(u,h)),n=h}else if(t.isLine){u="LineBasicMaterial:"+n.uuid;var p=this.cache.get(u);p||(p=new i.E,i.O.prototype.copy.call(p,n),p.color.copy(n.color),this.cache.add(u,p)),n=p}if(r||o||a||s||c){u="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(u+="specular-glossiness:"),s&&(u+="skinning:"),r&&(u+="vertex-tangents:"),o&&(u+="vertex-colors:"),a&&(u+="flat-shading:"),c&&(u+="morph-targets:"),l&&(u+="morph-normals:");var f=this.cache.get(u);f||(f=n.clone(),s&&(f.skinning=!0),r&&(f.vertexTangents=!0),o&&(f.vertexColors=!0),a&&(f.flatShading=!0),c&&(f.morphTargets=!0),l&&(f.morphNormals=!0),this.cache.add(u,f)),n=f}n.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",new i.g(e.attributes.uv.array,2)),n.normalScale&&!r&&(n.normalScale.y=-n.normalScale.y),n.clearcoatNormalScale&&!r&&(n.clearcoatNormalScale.y=-n.clearcoatNormalScale.y),t.material=n},N.prototype.loadMaterial=function(t){var e,r=this,o=this.json,a=this.extensions,s=o.materials[t],c={},l=s.extensions||{},u=[];if(l[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var h=a[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];e=h.getMaterialType(),u.push(h.extendParams(c,s,r))}else if(l[n.KHR_MATERIALS_UNLIT]){var p=a[n.KHR_MATERIALS_UNLIT];e=p.getMaterialType(),u.push(p.extendParams(c,s,r))}else{e=i.W;var f=s.pbrMetallicRoughness||{};if(c.color=new i.l(1,1,1),c.opacity=1,Array.isArray(f.baseColorFactor)){var v=f.baseColorFactor;c.color.fromArray(v),c.opacity=v[3]}void 0!==f.baseColorTexture&&u.push(r.assignTexture(c,"map",f.baseColorTexture)),c.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,c.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(u.push(r.assignTexture(c,"metalnessMap",f.metallicRoughnessTexture)),u.push(r.assignTexture(c,"roughnessMap",f.metallicRoughnessTexture)))}!0===s.doubleSided&&(c.side=i.r);var y=s.alphaMode||M;if(y===L?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,y===j&&(c.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&e!==i.S&&(u.push(r.assignTexture(c,"normalMap",s.normalTexture)),c.normalScale=new i.Kb(1,1),void 0!==s.normalTexture.scale&&c.normalScale.set(s.normalTexture.scale,s.normalTexture.scale)),void 0!==s.occlusionTexture&&e!==i.S&&(u.push(r.assignTexture(c,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(c.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&e!==i.S&&(c.emissive=(new i.l).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&e!==i.S&&u.push(r.assignTexture(c,"emissiveMap",s.emissiveTexture)),l[n.KHR_MATERIALS_CLEARCOAT]){var m=a[n.KHR_MATERIALS_CLEARCOAT];e=m.getMaterialType(),u.push(m.extendParams(c,{extensions:l},r))}return Promise.all(u).then((function(){var t;return t=e===d?a[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(c):new e(c),s.name&&(t.name=s.name),t.map&&(t.map.encoding=i.Qb),t.emissiveMap&&(t.emissiveMap.encoding=i.Qb),I(t,s),s.extensions&&F(a,t,s),t}))},N.prototype.loadGeometries=function(t){var e=this,r=this.extensions,o=this.primitiveCache;function a(t){return r[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then((function(n){return V(n,t,e)}))}for(var s,c,l=[],u=0,h=t.length;u<h;u++){var p,f=t[u],d=(c=void 0,(c=(s=f).extensions&&s.extensions[n.KHR_DRACO_MESH_COMPRESSION])?"draco:"+c.bufferView+":"+c.indices+":"+q(c.attributes):s.indices+":"+q(s.attributes)+":"+s.mode),v=o[d];if(v)l.push(v.promise);else p=f.extensions&&f.extensions[n.KHR_DRACO_MESH_COMPRESSION]?a(f):V(new i.h,f,e),o[d]={primitive:f,promise:p},l.push(p)}return Promise.all(l)},N.prototype.loadMesh=function(t){for(var e,n=this,r=this.json.meshes[t],o=r.primitives,a=[],s=0,c=o.length;s<c;s++){var l=void 0===o[s].material?(void 0===(e=this.cache).DefaultMaterial&&(e.DefaultMaterial=new i.W({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:i.v})),e.DefaultMaterial):this.getDependency("material",o[s].material);a.push(l)}return a.push(n.loadGeometries(o)),Promise.all(a).then((function(e){for(var a=e.slice(0,e.length-1),s=e[e.length-1],c=[],l=0,u=s.length;l<u;l++){var h,p=s[l],f=o[l],d=a[l];if(f.mode===x||f.mode===S||f.mode===R||void 0===f.mode)!0!==(h=!0===r.isSkinnedMesh?new i.xb(p,d):new i.R(p,d)).isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),f.mode===S?h.geometry=W(h.geometry,i.Hb):f.mode===R&&(h.geometry=W(h.geometry,i.Gb));else if(f.mode===_)h=new i.G(p,d);else if(f.mode===w)h=new i.D(p,d);else if(f.mode===b)h=new i.F(p,d);else{if(f.mode!==g)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);h=new i.lb(p,d)}Object.keys(h.geometry.morphAttributes).length>0&&D(h,r),h.name=r.name||"mesh_"+t,s.length>1&&(h.name+="_"+l),I(h,r),n.assignFinalMaterial(h),c.push(h)}if(1===c.length)return c[0];var v=new i.w;for(l=0,u=c.length;l<u;l++)v.add(c[l]);return v}))},N.prototype.loadCamera=function(t){var e,n=this.json.cameras[t],r=n[n.type];if(r)return"perspective"===n.type?e=new i.gb(i.P.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(e=new i.eb(r.xmag/-2,r.xmag/2,r.ymag/2,r.ymag/-2,r.znear,r.zfar)),n.name&&(e.name=n.name),I(e,n),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")},N.prototype.loadSkin=function(t){var e=this.json.skins[t],n={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",e.inverseBindMatrices).then((function(t){return n.inverseBindMatrices=t,n}))},N.prototype.loadAnimation=function(t){for(var e=this.json.animations[t],n=[],r=[],o=[],a=[],s=[],c=0,l=e.channels.length;c<l;c++){var u=e.channels[c],h=e.samplers[u.sampler],p=u.target,f=void 0!==p.node?p.node:p.id,d=void 0!==e.parameters?e.parameters[h.input]:h.input,v=void 0!==e.parameters?e.parameters[h.output]:h.output;n.push(this.getDependency("node",f)),r.push(this.getDependency("accessor",d)),o.push(this.getDependency("accessor",v)),a.push(h),s.push(p)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(o),Promise.all(a),Promise.all(s)]).then((function(n){for(var r=n[0],o=n[1],a=n[2],s=n[3],c=n[4],l=[],u=0,h=r.length;u<h;u++){var p=r[u],f=o[u],d=a[u],v=s[u],y=c[u];if(void 0!==p){var g;switch(p.updateMatrix(),p.matrixAutoUpdate=!0,A[y.path]){case A.weights:g=i.cb;break;case A.rotation:g=i.ob;break;case A.position:case A.scale:default:g=i.Nb}var _=p.name?p.name:p.uuid,b=void 0!==v.interpolation?k[v.interpolation]:i.C,w=[];A[y.path]===A.weights?p.traverse((function(t){!0===t.isMesh&&t.morphTargetInfluences&&w.push(t.name?t.name:t.uuid)})):w.push(_);var x=d.array;if(d.normalized){var S;if(x.constructor===Int8Array)S=1/127;else if(x.constructor===Uint8Array)S=1/255;else if(x.constructor==Int16Array)S=1/32767;else{if(x.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");S=1/65535}for(var R=new Float32Array(x.length),O=0,P=x.length;O<P;O++)R[O]=x[O]*S;x=R}for(O=0,P=w.length;O<P;O++){var T=new g(w[O]+"."+A[y.path],f.array,x,b);"CUBICSPLINE"===v.interpolation&&(T.createInterpolant=function(t){return new m(this.times,this.values,this.getValueSize()/3,t)},T.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(T)}}}var E=e.name?e.name:"animation_"+t;return new i.b(E,void 0,l)}))},N.prototype.loadNode=function(t){var e,r=this.json,o=this.extensions,a=this,s=r.meshReferences,c=r.meshUses,l=r.nodes[t];return(e=[],void 0!==l.mesh&&e.push(a.getDependency("mesh",l.mesh).then((function(t){var e;if(s[l.mesh]>1){var n=c[l.mesh]++;(e=t.clone()).name+="_instance_"+n}else e=t;return void 0!==l.weights&&e.traverse((function(t){if(t.isMesh)for(var e=0,n=l.weights.length;e<n;e++)t.morphTargetInfluences[e]=l.weights[e]})),e}))),void 0!==l.camera&&e.push(a.getDependency("camera",l.camera)),l.extensions&&l.extensions[n.KHR_LIGHTS_PUNCTUAL]&&void 0!==l.extensions[n.KHR_LIGHTS_PUNCTUAL].light&&e.push(a.getDependency("light",l.extensions[n.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(e)).then((function(t){var e;if((e=!0===l.isBone?new i.d:t.length>1?new i.w:1===t.length?t[0]:new i.db)!==t[0])for(var n=0,r=t.length;n<r;n++)e.add(t[n]);if(l.name&&(e.userData.name=l.name,e.name=i.nb.sanitizeNodeName(l.name)),I(e,l),l.extensions&&F(o,e,l),void 0!==l.matrix){var a=new i.Q;a.fromArray(l.matrix),e.applyMatrix4(a)}else void 0!==l.translation&&e.position.fromArray(l.translation),void 0!==l.rotation&&e.quaternion.fromArray(l.rotation),void 0!==l.scale&&e.scale.fromArray(l.scale);return e}))},N.prototype.loadScene=function(){function t(e,n,r,o){var a=r.nodes[e];return o.getDependency("node",e).then((function(t){return void 0===a.skin?t:o.getDependency("skin",a.skin).then((function(t){for(var n=[],r=0,i=(e=t).joints.length;r<i;r++)n.push(o.getDependency("node",e.joints[r]));return Promise.all(n)})).then((function(n){return t.traverse((function(t){if(t.isMesh){for(var r=[],o=[],a=0,s=n.length;a<s;a++){var c=n[a];if(c){r.push(c);var l=new i.Q;void 0!==e.inverseBindMatrices&&l.fromArray(e.inverseBindMatrices.array,16*a),o.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[a])}t.bind(new i.wb(r,o),t.matrixWorld)}})),t}));var e})).then((function(e){n.add(e);var i=[];if(a.children)for(var s=a.children,c=0,l=s.length;c<l;c++){var u=s[c];i.push(t(u,e,r,o))}return Promise.all(i)}))}return function(e){var n=this.json,r=this.extensions,o=this.json.scenes[e],a=new i.w;o.name&&(a.name=o.name),I(a,o),o.extensions&&F(r,a,o);for(var s=o.nodes||[],c=[],l=0,u=s.length;l<u;l++)c.push(t(s[l],a,n,this));return Promise.all(c).then((function(){return a}))}}(),t}(),a=function(t){i.L.call(this,t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}};a.prototype=Object.assign(Object.create(i.L.prototype),{constructor:a,setDecoderPath:function(t){return this.decoderPath=t,this},setDecoderConfig:function(t){return this.decoderConfig=t,this},setWorkerLimit:function(t){return this.workerLimit=t,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(t,e,n,r){var o=new i.s(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),"use-credentials"===this.crossOrigin&&o.setWithCredentials(!0),o.load(t,(t=>{var n={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(t,n).then(e).catch(r)}),n,r)},decodeDracoFile:function(t,e,n,r){var i={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(t,i).then(e)},decodeGeometry:function(t,e){for(var n in e.attributeTypes){var r=e.attributeTypes[n];void 0!==r.BYTES_PER_ELEMENT&&(e.attributeTypes[n]=r.name)}var i,o=JSON.stringify(e);if(a.taskCache.has(t)){var s=a.taskCache.get(t);if(s.key===o)return s.promise;if(0===t.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var c=this.workerNextTaskID++,l=t.byteLength,u=this._getWorker(c,l).then((n=>(i=n,new Promise(((n,r)=>{i._callbacks[c]={resolve:n,reject:r},i.postMessage({type:"decode",id:c,taskConfig:e,buffer:t},[t])}))))).then((t=>this._createGeometry(t.geometry)));return u.finally((()=>{i&&c&&this._releaseTask(i,c)})),a.taskCache.set(t,{key:o,promise:u}),u},_createGeometry:function(t){var e=new i.h;t.index&&e.setIndex(new i.g(t.index.array,1));for(var n=0;n<t.attributes.length;n++){var r=t.attributes[n],o=r.name,a=r.array,s=r.itemSize;e.setAttribute(o,new i.g(a,s))}return e},_loadLibrary:function(t,e){var n=new i.s(this.manager);return n.setPath(this.decoderPath),n.setResponseType(e),new Promise(((e,r)=>{n.load(t,e,void 0,r)}))},preload:function(){return this._initDecoder(),this},_initDecoder:function(){if(this.decoderPending)return this.decoderPending;var t="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,e=[];return t?e.push(this._loadLibrary("draco_decoder.js","text")):(e.push(this._loadLibrary("draco_wasm_wrapper.js","text")),e.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then((e=>{var n=e[0];t||(this.decoderConfig.wasmBinary=e[1]);var r=a.DRACOWorker.toString(),i=["/* draco decoder */",n,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([i]))})),this.decoderPending},_getWorker:function(t,e){return this._initDecoder().then((()=>{var n;this.workerPool.length<this.workerLimit?((n=new Worker(this.workerSourceURL))._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:this.decoderConfig}),n.onmessage=function(t){var e=t.data;switch(e.type){case"decode":n._callbacks[e.id].resolve(e);break;case"error":n._callbacks[e.id].reject(e);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+e.type+'"')}},this.workerPool.push(n)):this.workerPool.sort((function(t,e){return t._taskLoad>e._taskLoad?-1:1}));return(n=this.workerPool[this.workerPool.length-1])._taskCosts[t]=e,n._taskLoad+=e,n}))},_releaseTask:function(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]},debug:function(){console.log("Task load: ",this.workerPool.map((t=>t._taskLoad)))},dispose:function(){for(var t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this}}),a.DRACOWorker=function(){var t,e;function n(t,e,n,r,i,o){var a,s,c=o.num_components(),l=n.num_points()*c;switch(i){case Float32Array:a=new t.DracoFloat32Array,e.GetAttributeFloatForAllPoints(n,o,a),s=new Float32Array(l);break;case Int8Array:a=new t.DracoInt8Array,e.GetAttributeInt8ForAllPoints(n,o,a),s=new Int8Array(l);break;case Int16Array:a=new t.DracoInt16Array,e.GetAttributeInt16ForAllPoints(n,o,a),s=new Int16Array(l);break;case Int32Array:a=new t.DracoInt32Array,e.GetAttributeInt32ForAllPoints(n,o,a),s=new Int32Array(l);break;case Uint8Array:a=new t.DracoUInt8Array,e.GetAttributeUInt8ForAllPoints(n,o,a),s=new Uint8Array(l);break;case Uint16Array:a=new t.DracoUInt16Array,e.GetAttributeUInt16ForAllPoints(n,o,a),s=new Uint16Array(l);break;case Uint32Array:a=new t.DracoUInt32Array,e.GetAttributeUInt32ForAllPoints(n,o,a),s=new Uint32Array(l);break;default:throw new Error("THREE.DRACOLoader: Unexpected attribute type.")}for(var u=0;u<l;u++)s[u]=a.GetValue(u);return t.destroy(a),{name:r,array:s,itemSize:c}}onmessage=function(r){var i=r.data;switch(i.type){case"init":t=i.decoderConfig,e=new Promise((function(e){t.onModuleLoaded=function(t){e({draco:t})},DracoDecoderModule(t)}));break;case"decode":var o=i.buffer,a=i.taskConfig;e.then((t=>{var e=t.draco,r=new e.Decoder,s=new e.DecoderBuffer;s.Init(new Int8Array(o),o.byteLength);try{var c=function(t,e,r,i){var o,a,s=i.attributeIDs,c=i.attributeTypes,l=e.GetEncodedGeometryType(r);if(l===t.TRIANGULAR_MESH)o=new t.Mesh,a=e.DecodeBufferToMesh(r,o);else{if(l!==t.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");o=new t.PointCloud,a=e.DecodeBufferToPointCloud(r,o)}if(!a.ok()||0===o.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+a.error_msg());var u={index:null,attributes:[]};for(var h in s){var p,f,d=self[c[h]];if(i.useUniqueIDs)f=s[h],p=e.GetAttributeByUniqueId(o,f);else{if(-1===(f=e.GetAttributeId(o,t[s[h]])))continue;p=e.GetAttribute(o,f)}u.attributes.push(n(t,e,o,h,d,p))}if(l===t.TRIANGULAR_MESH){for(var v=o.num_faces(),y=new Uint32Array(3*v),m=new t.DracoInt32Array,g=0;g<v;++g){e.GetFaceFromMesh(o,g,m);for(var _=0;_<3;++_)y[3*g+_]=m.GetValue(_)}u.index={array:y,itemSize:1},t.destroy(m)}return t.destroy(o),u}(e,r,s,a),l=c.attributes.map((t=>t.array.buffer));c.index&&l.push(c.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:c},l)}catch(u){console.error(u),self.postMessage({type:"error",id:i.id,error:u.message})}finally{e.destroy(s),e.destroy(r)}}))}}},a.taskCache=new WeakMap,a.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},a.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},a.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},a.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")};var s=n(44),c=n.n(s),l=n(79),u=n.n(l),h=n(35),p=n(34),f=function(t){i.p.call(this,t),this.type=i.Jb};f.prototype=Object.assign(Object.create(i.p.prototype),{constructor:f,parse:function(t){var e=function(t,e){switch(t){case 1:console.error("RGBELoader Read Error: "+(e||""));break;case 2:console.error("RGBELoader Write Error: "+(e||""));break;case 3:console.error("RGBELoader Bad File Format: "+(e||""));break;default:case 4:console.error("RGBELoader: Error: "+(e||""))}return-1},n=function(t,e,n){e=e||1024;for(var r=t.pos,i=-1,o=0,a="",s=String.fromCharCode.apply(null,new Uint16Array(t.subarray(r,r+128)));0>(i=s.indexOf("\n"))&&o<e&&r<t.byteLength;)a+=s,o+=s.length,r+=128,s+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(r,r+128)));return-1<i&&(!1!==n&&(t.pos+=o+i+1),a+s.slice(0,i))},r=function(){var t=new Float32Array(1),e=new Int32Array(t.buffer);function n(n){t[0]=n;var r=e[0],i=r>>16&32768,o=r>>12&2047,a=r>>23&255;return a<103?i:a>142?(i|=31744,i|=(255==a?0:1)&&8388607&r):a<113?i|=((o|=2048)>>114-a)+(o>>113-a&1):(i|=a-112<<10|o>>1,i+=1&o)}return function(t,e,r,i){var o=t[e+3],a=Math.pow(2,o-128)/255;r[i+0]=n(t[e+0]*a),r[i+1]=n(t[e+1]*a),r[i+2]=n(t[e+2]*a)}}(),o=new Uint8Array(t);o.pos=0;var a,s,c,l,u,h,p=function(t){var r,i,o=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,c=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,l={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(t.pos>=t.byteLength||!(r=n(t)))return e(1,"no header found");if(!(i=r.match(/^#\?(\S+)$/)))return e(3,"bad initial token");for(l.valid|=1,l.programtype=i[1],l.string+=r+"\n";!1!==(r=n(t));)if(l.string+=r+"\n","#"!==r.charAt(0)){if((i=r.match(o))&&(l.gamma=parseFloat(i[1],10)),(i=r.match(a))&&(l.exposure=parseFloat(i[1],10)),(i=r.match(s))&&(l.valid|=2,l.format=i[1]),(i=r.match(c))&&(l.valid|=4,l.height=parseInt(i[1],10),l.width=parseInt(i[2],10)),2&l.valid&&4&l.valid)break}else l.comments+=r+"\n";return 2&l.valid?4&l.valid?l:e(3,"missing image size specifier"):e(3,"missing format specifier")}(o);if(-1!==p){var f=p.width,d=p.height,v=function(t,n,r){var i,o,a,s,c,l,u,h,p,f,d,v,y,m=n,g=r;if(m<8||m>32767||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);if(m!==(t[2]<<8|t[3]))return e(3,"wrong scanline width");if(!(i=new Uint8Array(4*n*r))||!i.length)return e(4,"unable to allocate buffer space");for(o=0,a=0,h=4*m,y=new Uint8Array(4),l=new Uint8Array(h);g>0&&a<t.byteLength;){if(a+4>t.byteLength)return e(1);if(y[0]=t[a++],y[1]=t[a++],y[2]=t[a++],y[3]=t[a++],2!=y[0]||2!=y[1]||(y[2]<<8|y[3])!=m)return e(3,"bad rgbe scanline format");for(u=0;u<h&&a<t.byteLength;){if((v=(s=t[a++])>128)&&(s-=128),0===s||u+s>h)return e(3,"bad scanline data");if(v)for(c=t[a++],p=0;p<s;p++)l[u++]=c;else l.set(t.subarray(a,a+s),u),u+=s,a+=s}for(f=m,p=0;p<f;p++)d=0,i[o]=l[p+d],d+=m,i[o+1]=l[p+d],d+=m,i[o+2]=l[p+d],d+=m,i[o+3]=l[p+d],o+=4;g--}return i}(o.subarray(o.pos),f,d);if(-1!==v){switch(this.type){case i.Jb:var y=v,m=i.rb,g=i.Jb;break;case i.u:for(var _=v.length/4*3,b=new Float32Array(_),w=0;w<_;w++)c=b,l=3*w,u=void 0,h=void 0,u=(a=v)[(s=4*w)+3],h=Math.pow(2,u-128)/255,c[l+0]=a[s+0]*h,c[l+1]=a[s+1]*h,c[l+2]=a[s+2]*h;y=b,m=i.sb,g=i.u;break;case i.x:_=v.length/4*3;var x=new Uint16Array(_);for(w=0;w<_;w++)r(v,4*w,x,3*w);y=x,m=i.sb,g=i.x;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:f,height:d,data:y,header:p.string,gamma:p.gamma,exposure:p.exposure,format:m,type:g}}}return null},setDataType:function(t){return this.type=t,this},load:function(t,e,n,r){return i.p.prototype.load.call(this,t,(function(t,n){switch(t.type){case i.Jb:t.encoding=i.qb,t.minFilter=i.Y,t.magFilter=i.Y,t.generateMipmaps=!1,t.flipY=!0;break;case i.u:case i.x:t.encoding=i.H,t.minFilter=i.I,t.magFilter=i.I,t.generateMipmaps=!1,t.flipY=!0}e&&e(t,n)}),n,r)}});var d=n(4),v=n(67),y=new i.fb(d.a.renderer);y.compileEquirectangularShader();var m=n(130),g=n(113),_=n(58),b=n(53),w=n(24);function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function S(t,e,n){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=T(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=T(t);if(e){var i=T(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return P(this,n)}}function P(t,e){return!e||"object"!==E(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var C=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":E(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},A=.5*Math.PI,k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)}(o,t);var e,n,r,i=O(o);function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(e=i.call(this))._created=!1,e._startAngle=0,e._threeEvents=[],e._scene=t,e}return e=o,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"firstUpdated",value:function(){var t=this,e="/assets/img/product-model/";this._loadImg("".concat(e,"circle_white.svg")).then((function(n){t._imgWhite=n,t._loadImg("".concat(e,"circle_grey.svg")).then((function(e){t._imgGrey=e,t._create()}))}))}},{key:"disconnectedCallback",value:function(){S(T(o.prototype),"disconnectedCallback",this).call(this),this._plane&&this._plane.destroy()}},{key:"_loadImg",value:function(t){return new Promise((function(e,n){Object(w.a)(t,(function(t){e(t)}),(function(){n()}))}))}},{key:"_create",value:function(){var t=1;this.classList.contains("v-view")&&(t=0),this._ctx=new b.a(this),this._plane=new g.a({scene:this._scene,el:this,resource:this._ctx.canvas,zIndex:2,materialProp:{transparent:!0,opacity:t}}),this._setSize(),this._setEvents(),this._created=!0,this.classList.contains("v-view")&&this._setOnView()}},{key:"_setOnView",value:function(){var t=this;this.classList.contains("v-viewed")?this._show():this["v-view-callback"]=function(){t._show()}}},{key:"_show",value:function(){this._plane&&this._plane.show(500)}},{key:"_setEvents",value:function(){this._threeEvents.push(d.a.on("resize",this._setSize.bind(this)))}},{key:"_setSize",value:function(){var t=Object(_.a)(),e=this.clientWidth*t,n=this.clientHeight*t;this._ctx.updateSize(e,n),this._center={x:this._ctx.width/2,y:this._ctx.height/2},this._radius=this._ctx.width,this._draw()}},{key:"_draw",value:function(){var t=this._ctx,e=t.ctx,n=t.width,r=t.height,i=A,o=[this._center,this._getAnglePoint(this._startAngle-i/2),this._getAnglePoint(this._startAngle+i/2)];e.clearRect(0,0,n,r),e.save(),e.beginPath(),e.drawImage(this._imgWhite,0,0,n,r),this._drawClipProints(e,o),e.clip(),e.clearRect(0,0,n,r),e.closePath(),e.beginPath(),this._drawClipProints(e,o),e.clip(),e.drawImage(this._imgGrey,0,0,n,r),e.closePath(),e.restore(),this._plane.texture&&(this._plane.texture.needsUpdate=!0)}},{key:"_getAnglePoint",value:function(t){return{x:Math.cos(t)*this._radius+this._center.x,y:Math.sin(t)*this._radius+this._center.y}}},{key:"_drawClipProints",value:function(t,e){t.moveTo(e[0].x,e[0].y);for(var n=1;n<e.length;n++)t.lineTo(e[n].x,e[n].y);t.lineTo(e[0].x,e[0].y)}},{key:"startAngle",set:function(t){this._created&&(t>2*Math.PI&&(t=t%Math.PI*2),this._startAngle=t,this._draw())},get:function(){return this._startAngle}}])&&x(e.prototype,n),r&&x(e,r),o}(r.a);k=C([Object(r.b)("product-model-circle")],k);var M=n(15),j=n(3),L=n(1),B=n(50);function z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function I(t,e,n){return(I="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=V(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function D(t,e){return(D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=V(t);if(e){var i=V(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return N(this,n)}}function N(t,e){return!e||"object"!==W(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function V(t){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var U=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":W(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},H=n(27),G=L.a.viewport,X=L.a.viewport.mobiledevice?.5:.1,Y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&D(t,e)}(l,t);var e,n,r,s=q(l);function l(){var t;return z(this,l),(t=s.apply(this,arguments))._useEnvMap=j.j.useEnvMap,t._modelRadius=0,t._events=[],t._threeEvents=[],t._canRender=!0,t._coords={draggerRotateY:{current:0,target:0},draggerRotateX:{current:0,target:0},scale:{current:1,target:1}},t._gltfLoaded=!1,t._allLoaded=!1,t._guiFolders=[],t}return e=l,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"disconnectedCallback",value:function(){if(this._events.forEach((function(t){u()(t)})),this._events=[],M.b&&this._guiFolders)for(var t=0;t<this._guiFolders.length;t++)try{M.b.removeFolder(this._guiFolders[t])}catch(n){}I(V(l.prototype),"disconnectedCallback",this).call(this);for(var e=0;e<this._threeEvents.length;e++)d.a.remove(this._threeEvents[e]);this._renderPlane&&this._renderPlane.destroy(),this._renderTarget&&this._renderTarget.destroy(),this._envMap&&this._envMap.dispose(),this._gltfScene&&this._gltfScene.traverse((function(t){t instanceof i.R&&(Array.isArray(t.material)?t.material.forEach((function(t){t.dispose()})):t.material.dispose(),t.geometry.dispose())}))}},{key:"create",value:function(){var t,e=this,n=this.getAttribute("data-height-scale");n?(this._heightScale=Number(n),console.log(this._heightScale)):this._heightScale=100,(t=!Object(v.a)()&&"assets/img/environments/default.hdr",t?new Promise((function(e,n){(new f).setDataType(i.Jb).load(t,(function(t){var n=y.fromEquirectangular(t).texture;y.dispose(),e(n)}),void 0,n)})):Promise.resolve(null)).then((function(t){if(e._envMap=t,M.b){var n=M.b.addFolder("EnvMap");e._guiFolders.push(n),n.add(e,"_useEnvMap").onChange((function(){if(e._scene&&e._renderTarget){var t=e._useEnvMap?e._envMap:null;e._scene.environment=t,e._renderTarget.render()}}))}e._startup(),e._load()}))}},{key:"_getAttribute",value:function(t){var e=this.getAttribute(t);if(null==e||0===e.length)throw new Error('The ProductModel attribute "'.concat(t,'" is wrong'));return e}},{key:"_startup",value:function(){this._createRenderTarget(),this._createCircle(),this._createPlane()}},{key:"_createRenderTarget",value:function(){var t=new h.a({autoRender:!j.j.stopAutorender.bool,dpr:Object(_.a)(),el:this,useGammaCorrection:!1});t.renderer.texture.encoding=i.Qb,this._renderTarget=t,this._scene=t.scene,this._scene.environment=this._useEnvMap?this._envMap:null}},{key:"_toggleRenderTarget",value:function(t){this._renderTarget.changeProp({autoRender:t})}},{key:"_createCircle",value:function(){this._circle=new k(d.a.scene3d),this._circle.classList.add("v-view"),this.appendChild(this._circle)}},{key:"_createPlane",value:function(){var t=1;this.classList.contains("v-view")&&(t=0);var e=new p.a({el:this,scene:d.a.scene3d,texture:this._renderTarget.renderer.texture,materialProp:{transparent:!0,opacity:t},autoRemove:!0,zIndex:3});this._renderPlane=e,this.classList.contains("v-view")&&this._setOnView()}},{key:"_setOnView",value:function(){var t=this;this.classList.contains("v-viewed")?this._show():this["v-view-callback"]=function(){t._show()}}},{key:"_show",value:function(){this._renderPlane&&this._renderPlane.show(500)}},{key:"_load",value:function(){var t=this,e=this._getAttribute("path"),n=this._getAttribute("gltf"),r=new i.N;r.onProgress=function(e,n,r){n>1&&Object(B.b)(n/r),n===r&&(t._allLoaded=!0,t._onloaded()),console.log("Loading file: ".concat(e,".\nLoaded ").concat(n," of ").concat(r," files."))};var s=new o(r),c=new a(r);c.setDecoderPath(e),s.setDRACOLoader(c),s.load(n,(function(e){var n=e.scene||e.scenes[0];t._gltfScene=n,t._gltfLoaded=!0,t._onloaded()}),(function(){}),(function(t){console.log("An error happened. The model was not loaded."),console.error(t)}))}},{key:"_onloaded",value:function(){var t=this;this._gltfLoaded&&this._allLoaded&&(this._appendThree(),setTimeout((function(){Object(B.a)(),j.j.stopAutorender.bool&&t._renderTarget.render()}),500))}},{key:"_appendThree",value:function(){this._scene.add(this._gltfScene),this._createLights(),this._updateSize(),this._setEvents()}},{key:"_createLights",value:function(){var t=j.j.light.left;this._lightLeft=this._createLightSource("left",t.intensity,{x:t.x,y:t.y,z:t.z}),this._setLightGUI(this._lightLeft);var e=j.j.light.center;this._lightCenter=this._createLightSource("center",e.intensity,{x:e.x,y:e.y,z:e.z}),this._setLightGUI(this._lightCenter);var n=j.j.light.right;this._lightRight=this._createLightSource("right",n.intensity,{x:n.x,y:n.y,z:n.z}),this._setLightGUI(this._lightRight)}},{key:"_createLightSource",value:function(t,e,n){var r=new i.jb(16777215,e);r.decay=0,this._scene.add(r);var o=new i.kb(r,10,16711680);return o.visible=!1,this._scene.add(o),{name:t,light:r,helper:o,pos:n}}},{key:"_setLightGUI",value:function(t){var e=this;if(M.b){var n=M.b.addFolder("Model Light from ".concat(t.name));this._guiFolders.push(n),n.add(t.helper,"visible").onChange((function(){e._renderTarget.render()})),n.add(t.light,"intensity",0,5,.01).onChange((function(){e._renderTarget.render()})),n.add(t.pos,"x",-2.5,2.5,.01).onChange((function(){e._updateSize()})),n.add(t.pos,"y",-2.5,2.5,.01).onChange((function(){e._updateSize()})),n.add(t.pos,"z",-2.5,2.5,.01).onChange((function(){e._updateSize()}))}}},{key:"_positionateLight",value:function(t){var e=t.pos.x*this._modelRadius,n=t.pos.y*this._modelRadius,r=t.pos.z*this._modelRadius;t.light.position.set(e,n,r)}},{key:"_updateSize",value:function(){var t=this;this._canRender=!1;var e=this._gltfScene;this._resetObjectRotation(e),e.children.forEach((function(n){t._resetObjectPosition(n),t._setScale(n,1);var r=Object(m.a)(n),o=t.clientHeight/(2*r)*(t._heightScale/100);t._setScale(n,o),t._modelRadius=2*r*o;var a=(new i.e).setFromObject(e).getCenter(new i.Lb);n.position.x+=n.position.x-a.x,n.position.y+=n.position.y-a.y,n.position.z+=n.position.z-a.z})),this._lightLeft&&this._positionateLight(this._lightLeft),this._lightCenter&&this._positionateLight(this._lightCenter),this._lightRight&&this._positionateLight(this._lightRight),j.j.stopAutorender.bool&&this._renderTarget&&this._renderTarget.render(),this._canRender=!0}},{key:"_setScale",value:function(t,e){t.scale.set(e,e,e)}},{key:"_resetObjectRotation",value:function(t){t.rotation.x=0,t.rotation.y=0,t.rotation.z=0}},{key:"_resetObjectPosition",value:function(t){t.position.x=0,t.position.y=0,t.position.z=0}},{key:"_setEvents",value:function(){var t=this;this._threeEvents.push(d.a.on("resize",(function(){t._updateSize()}),{timeout:50})),this._threeEvents.push(d.a.on("prerender",this._render.bind(this))),this._setDragger()}},{key:"_setDragger",value:function(){var t=this,e=this._coords,n=new c.a({outer:this,momentum:!1});n.on("start",(function(){j.j.stopAutorender.bool&&t._toggleRenderTarget(!0),e.scale.target=j.j.draggerScale,L.a.html.classList.add("no-user-select")})),n.on("end",(function(){e.scale.target=1,L.a.html.classList.remove("no-user-select")})),n.on("move",(function(e){j.j.stopAutorender.bool&&t._toggleRenderTarget(!0);var n=e.step.x/G.size[0]*j.j.mouseRotation;t._coords.draggerRotateY.target+=n;var r=1*Math.PI,i=e.step.y/G.size[1]*j.j.mouseRotation;t._coords.draggerRotateX.target+=i,t._coords.draggerRotateX.target<-r?t._coords.draggerRotateX.target=-r:t._coords.draggerRotateX.target>r/2&&(t._coords.draggerRotateX.target=r/2)}))}},{key:"_render",value:function(){var t=this._gltfScene;if(this._canRender){var e=this._coords.draggerRotateY,n=this._coords.draggerRotateX,r=this._coords.scale;if(e.current=H(e.current,e.target,X),r.current=H(r.current,r.target,X),n.current=H(n.current,n.target,X),t.rotation.y=e.current,t.rotation.x=n.current,t.scale.set(r.current,r.current,r.current),j.j.stopAutorender.bool){var i=Math.abs(n.current-n.target),o=Math.abs(r.current-r.target);i<=j.j.stopAutorender.approximation&&o<=j.j.stopAutorender.approximation&&this._toggleRenderTarget(!1)}this._circle.startAngle+=j.j.circleEase}else this._resetObjectRotation(t)}}])&&F(e.prototype,n),r&&F(e,r),l}(r.a);Y=U([Object(r.b)("product-gltf-model")],Y)},223:function(t,e,n){"use strict";n.r(e),n.d(e,"PageCatalog",(function(){return st}));var r=n(18),i=n(2),o=n(141),a=n(65),s=n(52),c=n(106);function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=v(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v(t);if(e){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==y(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var m=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":y(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},g=s.a.pageCatalogItemsTagName,_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(c,t);var e,n,r,s=f(c);function c(){var t;return l(this,c),(t=s.apply(this,arguments))._pagination=!1,t._paginationLoader=!1,t}return e=c,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"_connectedCallback",value:function(){h(v(c.prototype),"_connectedCallback",this).call(this),this.classList.add(g),this._paginationOuter=Object(i.g)(".v-pagination",this),Object(i.c)(this._paginationOuter)?(this._paginationLoader=Object(i.g)("page-catalog-loader",this),this._paginationHiddenElements=Object(i.f)("*[data-page-catalog-show-on-end]"),this._createPagination()):console.error("No element 'v-pagination' inside ",this)}},{key:"_disconnectedCallback",value:function(){h(v(c.prototype),"_disconnectedCallback",this).call(this),this._destroyPagination()}},{key:"_createPagination",value:function(){var t=this,e=void 0!==this.usePaginator,n=void 0!==this.useLazyLoad;try{var r=Object(o.a)({usePaginator:e,useLazyLoad:n,settings:{selector:this.uniqueSelector||".v-pagination",update:{url:e}}});r&&(this._pagination=r,this._paginationLoader&&r.active===r.max&&this._paginationLoader.classList.add("display-none_important"),r.active!==r.max&&this._paginationHiddenElements.forEach((function(t){t.classList.add("display-none_important")})),r.on("last",(function(){t._paginationLoader&&t._paginationLoader.classList.add("display-none_important"),t._paginationHiddenElements.forEach((function(t){t.classList.remove("display-none_important")}))})),r.on("load",(function(){Object(a.a)(),r.max>r.active&&t._paginationLoader&&t._paginationLoader.classList.remove("display-none_important")}),{timeout:100}))}catch(i){console.error(i)}}},{key:"_destroyPagination",value:function(){this.pagination&&(this.pagination.destroy(),this._pagination=!1)}},{key:"pagination",get:function(){return this._pagination}},{key:"paginationOuter",get:function(){return this._paginationOuter}},{key:"paginationLoader",get:function(){return this._paginationLoader}},{key:"paginationHiddenElements",get:function(){return this._paginationHiddenElements}}])&&u(e.prototype,n),r&&u(e,r),c}(c.a);m([Object(r.d)({attribute:"use-paginator"})],_.prototype,"usePaginator",void 0),m([Object(r.d)({attribute:"use-lazy-load"})],_.prototype,"useLazyLoad",void 0),m([Object(r.d)({attribute:"unique-selector"})],_.prototype,"uniqueSelector",void 0),_=m([Object(r.b)(g)],_);var b=n(156),w=n.n(b),x=n(56),S=n.n(x),R=n(1);function O(){var t=function(t,e){e||(e=t.slice(0));return Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(['\n            <slot name="button" @click="','"></slot>\n            <slot name="content"></slot>\n        ']);return O=function(){return t},t}function P(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function E(t,e,n){return(E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=M(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function A(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=M(t);if(e){var i=M(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return k(this,n)}}function k(t,e){return!e||"object"!==j(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function j(t){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var L=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":j(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},B=R.a.viewport,z=s.a.pageCatalogFilterTagName,F=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(s,t);var e,n,o,a=A(s);function s(){var t;return P(this,s),(t=a.apply(this,arguments))._opened=!1,t._viewportEvents=[],t}return e=s,(n=[{key:"render",value:function(){return Object(r.c)(O(),this._toggle.bind(this))}},{key:"firstUpdated",value:function(){this.classList.add(z),this._getElements(),this._setEvents(),this._createTips()}},{key:"disconnectedCallback",value:function(){this._viewportEvents.forEach((function(t){B.remove(t)})),E(M(s.prototype),"disconnectedCallback",this).call(this)}},{key:"_getElements",value:function(){this._button=Object(i.g)('*[slot="button"]',this),this._content=Object(i.g)('*[slot="content"]',this)}},{key:"_setEvents",value:function(){var t=this,e=R.a.vevetPage;e&&e.listener(window,"click",this._anyClick.bind(this)),Object(i.f)("a",this._content).forEach((function(e){e.addEventListener("click",(function(){e.classList.contains("disabled")||t.close()}))})),this._setFilterAppearenceType(),this._viewportEvents.push(B.on("",(function(){t._setFilterAppearenceType()}),{name:"Define Filter Appearence Type"}))}},{key:"_anyClick",value:function(t){var e=t.target;S()(e,this._button)||S()(e,this._content)||this.close()}},{key:"_toggle",value:function(t){t.preventDefault(),this._opened?this.close():this.open()}},{key:"close",value:function(){this._opened=!1,this._button&&this._button.classList.remove("active")}},{key:"open",value:function(){this._opened=!0,this._button&&this._button.classList.add("active")}},{key:"_setFilterAppearenceType",value:function(){this.classList.contains("expand-desktop")&&B.desktop?this.classList.add("expanded"):this.classList.remove("expanded")}},{key:"_createTips",value:function(){var t=this;Object(i.f)("li",this).forEach((function(e){t._createTip(e)}))}},{key:"_createTip",value:function(t){var e=Object(i.g)("a",t);if(Object(i.c)(e)){var n=Object(i.g)(".page-catalog-filter-tip",t);Object(i.c)(n)&&this._setTipEvents(e,n)}}},{key:"_setTipEvents",value:function(t,e){t.addEventListener("mouseenter",this._tipMouseEnter.bind(this,t,e)),e.addEventListener("mouseenter",this._tipMouseEnter.bind(this,t,e)),t.addEventListener("mouseleave",this._tipMouseLeave.bind(this,t,e)),e.addEventListener("mouseleave",this._tipMouseLeave.bind(this,t,e))}},{key:"_tipMouseEnter",value:function(t,e){t.classList.add("hovered"),e.classList.add("visible")}},{key:"_tipMouseLeave",value:function(t,e){t.classList.remove("hovered"),e.classList.remove("visible")}}])&&T(e.prototype,n),o&&T(e,o),s}(r.a);function I(t){var e=Object(i.g)("#page-catalog-filter-labels");function n(){e.innerHTML="",t.filters.forEach((function(n){var r=function(e){for(var n=t.groups,r=0;r<n.length;r++){var i=n[r];if(i.id===e)return i.el}return!1}(n.group.id);if(r&&(r.getAttribute("data-v-filter-haslabels")&&n.active)){var i=function(e){var n=document.createElement("div");return n.classList.add("page-catalog-filter-label"),n.innerHTML=e.el.innerHTML,n.onclick=function(){t.filterClick(e.el)},n}(n);e.appendChild(i)}}))}Object(i.c)(e)&&(n(),t.on("save",(function(){n()})))}function D(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function N(t,e,n){return(N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=H(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function V(t,e){return(V=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function W(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=H(t);if(e){var i=H(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return U(this,n)}}function U(t,e){return!e||"object"!==G(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function H(t){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function G(t){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}F=L([Object(r.b)(z)],F);var X=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":G(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},Y=s.a.pageCatalogFiltersTagName,K=s.a.pageCatalogTagName,Q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&V(t,e)}(a,t);var e,n,r,o=W(a);function a(){var t;return D(this,a),(t=o.apply(this,arguments))._destroyed=!1,t._filters=!1,t._pagination=!1,t}return e=a,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"connectedCallback",value:function(){N(H(a.prototype),"connectedCallback",this).call(this),this.classList.add(Y),this._destroyed=!1,this._create()}},{key:"disconnectedCallback",value:function(){N(H(a.prototype),"disconnectedCallback",this).call(this),this._destroyed=!0,this._destroy()}},{key:"_create",value:function(){var t=this,e=Object(i.e)(this,K,9);if(e){var n=e.pagination;if(void 0===n||"boolean"==typeof n)return void(this._searchTimeout=setTimeout((function(){t._destroyed||t._pagination||t._create()}),100));this._pagination=n}this._pagination&&(this._filters=new w.a({pagination:this._pagination,selectors:{group:".page-catalog-filter",filter:".page-catalog-filter__filter"},multipleSeparator:"__"}),I(this._filters),this._filters.filters.forEach((function(t){var e=t.group.id;"null"===t.id&&null==R.a.url.getParam({key:e})&&t.el.classList.add("v-filter__filter_active")})))}},{key:"_destroy",value:function(){this._searchTimeout&&(clearTimeout(this._searchTimeout),this._searchTimeout=!1),this._filters&&(this._filters.destroy(),this._filters=!1)}},{key:"filters",get:function(){return this._filters}},{key:"pagination",get:function(){return this._pagination}}])&&q(e.prototype,n),r&&q(e,r),a}(r.a);function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function J(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function $(t,e){return($=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=nt(t);if(e){var i=nt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return et(this,n)}}function et(t,e){return!e||"object"!==rt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nt(t){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rt(t){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Q=X([Object(r.b)(Y)],Q);var it=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":rt(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},ot=s.a.pageCatalogTagName,at=s.a.pageCatalogItemsTagName,st=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$(t,e)}(a,t);var e,n,r,o=tt(a);function a(){return Z(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"firstUpdated",value:function(){this.classList.add(ot)}},{key:"pagination",get:function(){var t=Object(i.g)(at);if(!Object(i.c)(t))return!1;var e=t.pagination;return e||!1}}])&&J(e.prototype,n),r&&J(e,r),a}(r.a);st=it([Object(r.b)(ot)],st)},224:function(t,e,n){"use strict";n.r(e),n.d(e,"MarqueeTitle",(function(){return P}));var r=n(18),i=n(2);function o(t={}){const e="node-marquee";let n=!1;t=Object.assign({selector:".node-marquee",speed:1,autoplay:!0,pauseOnHover:!1,applyOuterStyles:!0,optimizeCalculation:!1},t);const r=Object(i.g)(t.selector);if(!Object(i.c)(r))return!1;r.classList.add(e);let o=r.innerHTML,a=0,s=[],c=[],l=0,u=!1;let h=!1;y();let p=!1;t.autoplay&&x();const f=Object(i.a)(window,"resize",y.bind(this)),d=Object(i.a)(r,"mouseenter",function(){t.pauseOnHover&&S()}.bind(this)),v=Object(i.a)(r,"mouseleave",function(){t.pauseOnHover&&x()}.bind(this));function y(){g(),a=0,s=[],c=[],r.innerHTML="",t.applyOuterStyles&&(r.style.position="relative",r.style.width="100%",r.style.overflow="hidden",r.style.whiteSpace="nowrap");let e=m().clientWidth;e<=0&&(e=window.innerWidth),e<r.clientWidth&&(a=Math.ceil(1.5*r.clientWidth/e)),a<4&&(a=4);for(let t=0;t<a-1;t++)m(!0);w(),b(),function(){const t={childList:!0};h=new MutationObserver((t=>{for(const e of t)"childList"===e.type&&(o=r.innerHTML,y())})),h.observe(r,t)}(),t.optimizeCalculation&&setTimeout((()=>{w()}),500)}function m(t=!1){const e=document.createElement("div");return e.classList.add("node-marquee__el"),e.innerHTML=`&nbsp;${o}`,t&&(e.style.position="absolute",e.style.top="0",e.style.left="0"),e.style.display="inline-block",r.appendChild(e),s.push(e),e}function g(){h&&h.disconnect()}function _(){b(),u&&(p=window.requestAnimationFrame(_.bind(this)))}function b(e=t.speed){l+=e;let n=!1,r=0,i=0;for(let o=0;o<a;o++){const e=s[o];t.optimizeCalculation||(c[o]=e.clientWidth);const a=c[o],u=i-l;i+=a,e.style.transform=`matrix3d(1,0,0.00,0,0.00,1,0.00,0,0,0,1,0, ${u}, 0, 0,1)`,u<-1*a&&(n=e,r=o)}n&&(s.push(s.splice(s.indexOf(n),1)[0]),l-=t.optimizeCalculation?c[r]:n.clientWidth,t.optimizeCalculation&&w())}function w(){if(!n)for(let t=0;t<a;t++){let e=s[t].clientWidth;e=s[t].clientWidth,e<=0&&(e=window.innerWidth),c[t]=e}}function x(){p||(u=!0,p=window.requestAnimationFrame(_.bind(this)))}function S(){u=!1,p&&(window.cancelAnimationFrame(p),p=!1)}return{play:x.bind(this),pause:S.bind(this),isPlaying:()=>u,render:b.bind(this),recreate:y.bind(this),updateSizes:w.bind(this),destroy:function(){n=!0,S(),g(),f.remove(),d.remove(),v.remove(),r.innerHTML=o}.bind(this)}}var a=n(1),s=n(106),c=n(108),l=n(4),u=n(110),h=n(8),p=n(22);function f(){return Object(h.d)()instanceof HTMLHtmlElement?null:p.a.app}var d=n(66);function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=w(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w(t);if(e){var i=w(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b(this,n)}}function b(t,e){return!e||"object"!==x(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var S=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":x(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},R=a.a.viewport,O="marquee-title",P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(s,t);var e,n,r,i=_(s);function s(){var t;return v(this,s),(t=i.apply(this,arguments))._marquee=!1,t._threeEventID=!1,t._isHovered=!1,t._autoStop=!1,t}return e=s,(n=[{key:"_connectedCallback",value:function(){m(w(s.prototype),"_connectedCallback",this).call(this),this.classList.add(O),Object(c.a)(this),this._createMarquee()}},{key:"_disconnectedCallback",value:function(){m(w(s.prototype),"_disconnectedCallback",this).call(this),this._marquee&&this._marquee.destroy(),this._pause()}},{key:"_createMarquee",value:function(){var t=this;if(0!==this.children.length){this._autoStop=!1,this.getAttribute("data-autostop")&&(this._autoStop=!0);var e=this.children[0];this._marquee=o({selector:e,autoplay:!1,optimizeCalculation:!0}),R.mobiledevice&&"linux"===a.a.os?this.classList.add("no-animation"):function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001,i=!1,o=!1;if(Object(d.a)()){var s={root:f(),rootMargin:"0px",threshold:r};(o=new IntersectionObserver(c.bind(this),s)).observe(t)}else i=Object(u.a)(l.bind(this));function c(t){t.forEach((function(t){t.isIntersecting?e():n()}))}function l(){var r=t.getBoundingClientRect(),i=a.a.viewport.size;r.bottom<=0||r.right<=0||r.top>=i[1]||r.left>=i[0]?n():e()}function h(){i&&i.destroy(),o&&o.disconnect()}h.bind(this)}(this,(function(){t._play()}),(function(){t._pause()})),this._autoStop&&(this.addEventListener("mouseenter",(function(){t._isHovered=!0})),this.addEventListener("mouseleave",(function(){t._isHovered=!1})))}}},{key:"_play",value:function(){var t=this;this._threeEventID||(this._threeEventID=l.a.on("afterrender",(function(){t._isHovered||t._marquee&&t._marquee.render(1)})))}},{key:"_pause",value:function(){this._threeEventID&&(l.a.remove(this._threeEventID),this._threeEventID=!1)}}])&&y(e.prototype,n),r&&y(e,r),s}(s.a);P=S([Object(r.b)(O)],P)},225:function(t,e,n){"use strict";n.r(e),n.d(e,"MotionText",(function(){return U}));var r=n(18),i=n(114),o=n.n(i),a=n(5),s=n.n(a),c=n(0),l=n(1);function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._el=e,this._alpha=r,this._dpr=l.a.viewport.dprMobile;var i=this._dpr,o=e.getBoundingClientRect(),a=n.getBoundingClientRect();this._left=(o.left-a.left)*i,this._top=(o.top-a.top)*i,this._height=o.height*i}var e,n,r;return e=t,(n=[{key:"renderChar",value:function(t){var e=this._dpr,n=this._left,r=this._top,i=getComputedStyle(this._el),o=parseInt(i.fontSize,10)*e,a=this._height,s="".concat(i.fontWeight," ").concat(o,"px/").concat(a,"px ").concat(i.fontFamily),c=(a-parseFloat(i.lineHeight)*e)/1.5;t.beginPath(),t.globalAlpha=this._alpha,t.textBaseline="hanging",t.font=s,t.fillStyle=i.color,t.fillText(this._el.innerText,n,r+c),t.closePath()}},{key:"alpha",set:function(t){this._alpha=t}}])&&u(e.prototype,n),r&&u(e,r),t}(),p=n(34),f=n(4);function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function m(t,e,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=w(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w(t);if(e){var i=w(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b(this,n)}}function b(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var x=n(147).default,S=n(148).default,R=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(o,t);var e,n,r,i=_(o);function o(){return v(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"_extra",value:function(){m(w(o.prototype),"_extra",this).call(this),this._data=[{key:"u_filterArea",value:new c.Mb(f.a.width,f.a.height,0,0),type:"vec4"},{key:"u_center",value:new c.Kb(f.a.width/2,f.a.height/2),type:"vec2"},{key:"u_strength",value:0,type:"float"},{key:"u_innerRadius",value:0,type:"float"},{key:"u_radius",value:-1,type:"float"}],this._prop.extendFragmentShader=S}},{key:"_onMaterialBeforeCompile",value:function(t){var e=this.prop.extendFragmentShader;e&&(this._setShaderUniforms(t),t.fragmentShader=x+t.fragmentShader,t.fragmentShader=t.fragmentShader.replace("#include <map_fragment>",e))}}])&&y(e.prototype,n),r&&y(e,r),o}(p.a),O=n(110);function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var T=l.a.viewport,E=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._charsSource=e,this._parent=n,this._hasBlur=r,this._motionChars=[],this._glTexture=!1,this._glPlane=!1,this._onScrollEvents=!1,this._motionChars=[];var i=T.dprMobile;this._width=n.clientWidth*i,this._height=n.clientHeight*i,this._init()}var e,n,r;return e=t,(n=[{key:"_init",value:function(){this._createCanvas(),this._hasBlur&&(this._createTexture(),this._createPlane()),this._createChars(),this._glPlane&&this._glPlane.render(),this.renderChars()}},{key:"destroy",value:function(){this._canvas&&this._canvas.remove(),this._glPlane&&(this._glPlane.destroy(),this._glPlane=!1),this._onScrollEvents&&(this._onScrollEvents.destroy(),this._onScrollEvents=!1)}},{key:"_createCanvas",value:function(){this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d"),this._canvas.width=this._width,this._canvas.height=this._height,this._hasBlur||(this._canvas.style.position="absolute",this._canvas.style.left="0",this._canvas.style.top="0",this._canvas.style.width="100%",this._canvas.style.height="100%",this._canvas.style.zIndex="3",this._canvas.style.pointerEvents="none",this._parent.appendChild(this._canvas))}},{key:"_createTexture",value:function(){this._glTexture=new c.i(this._canvas),this._glTexture.needsUpdate=!0,this._glTexture.minFilter=c.I,this._glTexture.magFilter=c.I}},{key:"_createPlane",value:function(){var t=this,e={el:this._parent,scene:f.a.scene2d,autoRemove:!0,texture:this._glTexture,materialProp:{transparent:!0},renderPosition:!1};this._glPlane=new R(e),this._onScrollEvents=Object(O.a)((function(){t._glPlane&&t._glPlane.renderPosition(!0)}),!0)}},{key:"_createChars",value:function(){for(var t=this._hasBlur?0:1,e=0;e<this._charsSource.length;e++){var n=new h(this._charsSource[e],this._parent,t);this._motionChars.push(n)}}},{key:"renderChars",value:function(){var t=this;this._ctx.clearRect(0,0,this._width,this._height),this.motionChars.forEach((function(e){e.renderChar(t._ctx)})),this._glTexture&&(this._glTexture.needsUpdate=!0)}},{key:"motionChars",get:function(){return this._motionChars}},{key:"centerX",set:function(t){this._hasBlur&&this._glTexture&&this._glPlane&&(this._glPlane.material.userData.u_center.value.x=t)}},{key:"strength",set:function(t){this._hasBlur&&this._glTexture&&this._glPlane&&(this._glPlane.material.userData.u_strength.value=t)}}])&&P(e.prototype,n),r&&P(e,r),t}(),C=n(109),A=n(106),k=n(108),M=n(62);function j(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function B(t,e,n){return(B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=D(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function z(t,e){return(z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function F(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=D(t);if(e){var i=D(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return I(this,n)}}function I(t,e){return!e||"object"!==q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var N=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":q(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},V=M.a.tagName,W=M.a.duration,U=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&z(t,e)}(a,t);var e,n,r,i=F(a);function a(){var t;return j(this,a),(t=i.apply(this,arguments))._text=!1,t._lines=[],t._chars=[],t._animated=!1,t._threeEventID=!1,t}return e=a,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"_connectedCallback",value:function(){B(D(a.prototype),"_connectedCallback",this).call(this),this.classList.add(V),Object(k.a)(this),this._create()}},{key:"_disconnectedCallback",value:function(){B(D(a.prototype),"_disconnectedCallback",this).call(this),this._threeEventID&&f.a.remove(this._threeEventID),this._text&&(this._text.destroy(),this._text=void 0),this._destroyLines()}},{key:"_create",value:function(){var t=this;this._splitText(),this._threeEventID=f.a.on("afterrender",this._draw.bind(this)),this.classList.contains("v-view")?this.classList.contains("v-viewed")?this.play():this["v-view-callback"]=function(){t.play()}:this.play(10),Object(C.a)(this)}},{key:"_splitText",value:function(){var t=this;this._lines=[],this._text=new o.a({selector:this.children[0]}),this._createLines(),this._text.on("split",(function(){t._createLines()}))}},{key:"_createLines",value:function(){var t=this;if(this._text){this._destroyLines();var e=this.parentElement;if(this._animated){var n=[];this._text.letters.forEach((function(t){t.el&&n.push(t.el)}));var r=new E(n,e,!1);this._lines.push(r)}else this._text.lines.forEach((function(n){var r=[];n.children.forEach((function(t){for(var e=t.children,n=0;n<e.length;n++)r.push(e[n].el)}));var i=new E(r,e,!0);t._lines.push(i),t._chars=t._chars.concat(i.motionChars)}))}}},{key:"_destroyLines",value:function(){this._lines&&this._lines.forEach((function(t){t.destroy()})),this._lines=[],this._chars=[]}},{key:"play",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W;this._text&&this._text.play({types:["lineletter","line"],durationAuto:!1,duration:e,shift:.95,shiftLine:.95,letter:[{value:function(e){var n=t._chars[e.position];return n&&(n.alpha=e.e),""}}],line:[{value:function(e){var n=t._lines[e.position];return n&&(n.centerX=e.e*l.a.viewport.size[0]*.5),""}},{value:function(e){var n=t._lines[e.position];if(n){var r=.35;e.e<.5?r*=s()(e.e,[0,.5]):r*=1-s()(e.e,[.5,1]),n.strength=r}return""}}],callbacks:[{target:1,do:function(){setTimeout((function(){t._animated=!0,t._createLines()}),100)}}]})}},{key:"_draw",value:function(){if(!this._animated)for(var t=0;t<this._lines.length;t++)this._lines[t].renderChars()}}])&&L(e.prototype,n),r&&L(e,r),a}(A.a);U=N([Object(r.b)(V)],U)},226:function(t,e,n){"use strict";n.r(e),n.d(e,"ScrollList",(function(){return D}));var r=n(18),i=n(39),o=n.n(i),a=n(64),s=n.n(a),c=n(51),l=n.n(c),u=n(158),h=n.n(u),p=n(2),f=n(1),d=n(106),v=n(68);var y=n(28),m=n.n(y),g=n(6),_=n.n(g);function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function x(t,e,n){return(x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=P(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=P(t);if(e){var i=P(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return O(this,n)}}function O(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(o,t);var e,n,r,i=R(o);function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,t)}return e=o,(n=[{key:"changeProp",value:function(t){x(P(o.prototype),"changeProp",this).call(this,t)}},{key:"_changeProp",value:function(){x(P(o.prototype),"_changeProp",this).call(this),this._intensitySet()}},{key:"_extra",value:function(){var t=this;x(P(o.prototype),"_extra",this).call(this);var e=this._m,n=e._elProp.bind(e);e._elProp=function(){n(),t._prop.on&&(t._forceValues(),t._elProp())},e._elProp(),this._intensityId=!1,this._intensitySet(),this._overrideGetEase(),this._calcElValues()}},{key:"_intensitySet",value:function(){var t=this,e=this._m;this._intensityId&&(e.remove(this._intensityId),this._intensityId=!1),this._intensity=0,this._updateTargets(),this._prop.on&&(this._intensityId=e.on("update",(function(){var n;n=e.prop.horizontal?e.scrollLeft-t._prevValues[0]:e.scrollTop-t._prevValues[1],t._intensity=Math.abs(n/t._prop.max),t._intensity>1&&(t._intensity=1),t._updateTargets()})))}},{key:"_updateTargets",value:function(){var t=this._m;this._prevValues=[t.scrollLeft,t.scrollTop]}},{key:"_elProp",value:function(){for(var t=this._m,e=t._properties.current,n=0;n<t._length;n++){var r=t.elements[n],i=r[e],o=r.getBoundingClientRect(),a=o.left+i[0]+o.width/2,s=o.top+i[1]+o.height/2;r[this._centerProp]=[a,s]}}},{key:"_forceValues",value:function(){for(var t=this._m,e=0;e<t._length;e++){var n=t.elements[e][t._properties.current];n[0]=t.targetLeft,n[1]=t.targetTop}t._render()}},{key:"_overrideGetEase",value:function(){var t=this,e=this._m,n=e._getEase.bind(e);e._getEase=function(r,i){var o=n(r,i);if(!t._prop.on)return o;if(null==r)return o;var a=0,s=r[t._centerProp],c=e._properties.current;a=e.prop.horizontal?(s[0]-r[c][0])/e.width:(s[1]-r[c][1])/e.height,e._direction<0&&(a=1-a);var l=e.prop.ease;return a<-l&&(a=-l),a>l+1&&(a=l+1),o-=a*t._prop.reduce*t._intensity}}},{key:"_calcElValues",value:function(){var t=this,e=this._m,n=e._calcElValues.bind(e);e._calcElValues=function(r){n(r);for(var i=0;i<e._length;i++){var o=e.elements[i][e._properties.current];t._boundClamping(o)}}}},{key:"_boundClamping",value:function(t){var e=this._m,n=this._prop.maxClamp;t[1]>e.scrollTop+n&&(t[1]=e.scrollTop+n),t[1]<e.scrollTop-n&&(t[1]=e.scrollTop-n)}},{key:"defaultProp",get:function(){return _()(x(P(o.prototype),"defaultProp",this),{on:!0,reduce:.05,max:15,maxClamp:100})}},{key:"prefix",get:function(){return"".concat(this._v.prefix,"scroll-clamp")}}])&&w(e.prototype,n),r&&w(e,r),o}(m.a),E=n(3);function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t,e,n){return(k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=B(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function M(t,e){return(M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=B(t);if(e){var i=B(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return L(this,n)}}function L(t,e){return!e||"object"!==z(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function B(t){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function z(t){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var F=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":z(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},I="scroll-list",D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(a,t);var e,n,r,i=j(a);function a(){var t;return C(this,a),(t=i.apply(this,arguments))._scroll=!1,t._scrollSwipe=!1,t}return e=a,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"firstUpdated",value:function(){this.classList.add(I)}},{key:"_connectedCallback",value:function(){k(B(a.prototype),"_connectedCallback",this).call(this),this._create()}},{key:"_disconnectedCallback",value:function(){k(B(a.prototype),"_disconnectedCallback",this).call(this),this._destroy()}},{key:"_create",value:function(){var t=this;if(0!==this.children.length){var e=this.children[0];!function(t){for(var e=t.children,n=0;n<e.length;n++)e[0].setAttribute("tabindex","-1")}(e);var n=this.getAttribute("id"),r="";n?r=n:(r=l()(I),this.setAttribute("id",r));var i=!1,a=e,s="#".concat(r," *[data-scroll-list-item]");Object(p.f)(s,this).length>0&&(a=s,i=!0),this._scroll=new o.a({selectors:{outer:this,elements:a},ease:this._getEase()/2,resizeTimeout:E.k,horizontal:!0,scroll:!1,run:!0}),this._addSwipe(),this._scroll.addPlugin(new v.a),this._scroll.addPlugin(new h.a),i&&this._scroll.addPlugin(new T({on:!0,reduce:.02,maxClamp:50}));var c=f.a.vevetPage;c&&c.onPageShown((function(){setTimeout((function(){t._scroll&&t._scroll.setSize(!1)}),500)}))}}},{key:"_addSwipe",value:function(){this._scrollSwipe=new s.a({on:!0,multiplier:f.a.viewport.mobiledevice?1.25:1,ease:this._getEase(),friction:f.a.viewport.mobiledevice?.8:.6,momentum:!1,thresholdPropagation:{dir:"x",value:1}}),this._scroll&&this._scroll.addPlugin(this._scrollSwipe)}},{key:"_getEase",value:function(){var t=.1;return"macos"===f.a.os&&(f.a.viewport.mobiledevice||(t=.25)),"edge"===f.a.browser&&(t=.2),f.a.viewport.mobiledevice&&(t=.25),t}},{key:"_destroy",value:function(){this._scroll&&(this._scroll.destroy(),this._scroll=void 0)}}])&&A(e.prototype,n),r&&A(e,r),a}(d.a);D=F([Object(r.b)(I)],D)},227:function(t,e,n){"use strict";n.r(e),n.d(e,"ProjectImage",(function(){return F}));var r=n(18),i=n(14),o=n.n(i),a=n(113),s=n(3);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=v(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v(t);if(e){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var y=n(118).default,m=n(119).default,g=n(168).default,_=s.h.epxand,b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(a,t);var e,n,r,i=f(a);function a(){return l(this,a),i.apply(this,arguments)}return e=a,(n=[{key:"_extra",value:function(){this._prop.uniformsData=[{key:"u_strength",type:"float",value:_.use?_.strength:0},{key:"u_progress",type:"float",value:0}],this._shrinkProgress=_.use?1:0,this._withOpacity=!0,h(v(a.prototype),"_extra",this).call(this),this._prop.extendFragmentShader="empty",this._prop.materialProp.transparent=!0,this._prop.materialProp.opacity=0}},{key:"_setMaterialOnBeforeCompile",value:function(){var t=this;this._material.onBeforeCompile=function(e){window.r="".concat(Math.random(),"project image plane"),t._onMaterialBeforeCompileFragment(e)}}},{key:"_onMaterialBeforeCompileFragment",value:function(t){this.prop.extendFragmentShader&&(this._setShaderUniforms(t),t.vertexShader=y+m+t.vertexShader,t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",g))}},{key:"render",value:function(){h(v(a.prototype),"render",this).call(this);var t=this._mesh,e=t.position;e.y=(1-this._shrinkProgress)*e.y,this._setShrinkUniforms(this._shrinkProgress);var n=1;this._withOpacity&&(n=1-this._shrinkProgress),t.material.opacity=n}},{key:"expand",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};if(!_.use)return console.warn("Expand animation is disabled"),!1;this._withOpacity=e;var r=new o.a;return r.on("progress",(function(e){t._shrinkProgress=1-e.e})),r.on("end",(function(){n()})),r.play({duration:_.duration,easing:"easeOutSine"}),!0}},{key:"renderPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?0===this._shrinkProgress&&h(v(a.prototype),"renderPosition",this).call(this):this._shrinkProgress>0&&h(v(a.prototype),"renderPosition",this).call(this)}},{key:"_setShrinkUniforms",value:function(t){this._uniforms.u_progress&&(this._uniforms.u_progress.value=t)}}])&&u(e.prototype,n),r&&u(e,r),a}(a.a),w=n(35),x=n(34),S=n(4),R=n(110),O=n(106),P=n(24);function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function C(t,e,n){return(C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=j(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function A(t,e){return(A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=j(t);if(e){var i=j(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return M(this,n)}}function M(t,e){return!e||"object"!==L(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function L(t){return(L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var B=function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===("undefined"==typeof Reflect?"undefined":L(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},z="project-image",F=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(o,t);var e,n,r,i=k(o);function o(){var t;return T(this,o),(t=i.apply(this,arguments))._destroyed=!1,t._loaded=!1,t._renderTarget=!1,t._renderTargetPlane=!1,t._imagePlane=!1,t._expanded=!1,t}return e=o,(n=[{key:"createRenderRoot",value:function(){return this}},{key:"_connectedCallback",value:function(){var t=this;C(j(o.prototype),"_connectedCallback",this).call(this),this.classList.add(z),this._destroyed=!1,this._loaded=!1,this._renderTarget=new w.a,this._renderTargetPlane=new x.a({texture:this._renderTarget.renderer.texture,scene:S.a.scene3d,materialProp:{transparent:!0}}),Object(P.a)(this.imageSrc,(function(e){t._handleLoaded(e)}))}},{key:"_disconnectedCallback",value:function(){C(j(o.prototype),"_disconnectedCallback",this).call(this),this._destroyed=!0,this._loaded=!1,this._destroyScene()}},{key:"_handleLoaded",value:function(t){var e=this;this._destroyed||this._renderTarget&&(this._imagePlane=new b({scene:this._renderTarget.scene,resource:t,posRule:"cover",el:this}),Object(R.a)((function(){e._imagePlane&&e._imagePlane.renderPosition(!0)})),this._loaded=!0)}},{key:"_destroyScene",value:function(){this._renderTargetPlane&&(this._renderTargetPlane.destroy(),this._renderTargetPlane=!1),this._renderTarget&&(this._renderTarget.destroy(),this._renderTarget=!1),this._imagePlane&&(this._imagePlane.destroy(),this._imagePlane=!1)}},{key:"expand",value:function(t){var e=this;this._loaded&&this._imagePlane&&(this._imagePlane.loaded?(this._imagePlane.expand(t,this._onExpandEnd.bind(this)),this._imagePlane.renderPosition(!0)):this._imagePlane.on("loaded",(function(){e._imagePlane&&(e._imagePlane.expand(t,e._onExpandEnd.bind(e)),e._imagePlane.renderPosition(!0))})))}},{key:"_onExpandEnd",value:function(){var t=this,e=new Image;e.onload=function(){e.classList.add("loaded"),t._destroyScene()},e.src=this.imageSrc,e.alt="Project image",this.appendChild(e)}},{key:"loaded",get:function(){return this._loaded}}])&&E(e.prototype,n),r&&E(e,r),o}(O.a);B([Object(r.d)({attribute:"image-src"})],F.prototype,"imageSrc",void 0),F=B([Object(r.b)(z)],F)}}]);